---

title: Printing system, control method, storage client apparatus, and web application server
abstract: A printing system includes a web application server, a storage client apparatus, and a printing apparatus to save the storage capacity. The storage client provides stored bibliographic information data to a web application server and, when the storage client apparatus acquires print instruction from the web application server, the storage client apparatus provides data, to be stored in the storage client apparatus, to the web application server in response to a provision request from the web application server. The printing apparatus acquires and prints corresponding data after acquiring a print request from the web application server. The web application server manages information of the storage client apparatus and the printing apparatus, sends display data to a client apparatus operated by a user, and acts on storage, print, and query requests.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08665473&OS=08665473&RS=08665473
owner: Canon Kabushiki Kaisha
number: 08665473
owner_city: Tokyo
owner_country: JP
publication_date: 20110126
---
This application is a National Stage filing of PCT application No. PCT JP2011 052076 filed Jan. 26 2011 which claims priority from Japanese Patent Application No. 2010 036667 filed Feb. 22 2010 all of which are hereby incorporated by reference herein in their entirety.

The present invention relates to a printing system and control method which share data when a print request is issued in order to save the storage capacity of an apparatus which holds data to be shared.

A form in which a web application provided by a web application server is used via a web browser of a client apparatus without installing an application on the client apparatus is becoming prevalent. Such a web application includes a document management web application which systematically manages documents created by the client apparatus.

A form in which a server group managed in a centralized manner by others is used without directly managing a web application server by a web application provider is also becoming prevalent. Such a form is called cloud computing. In cloud computing the web application provider is charged in proportion to the amount of HDD usage and CPU usage of the web application server. In this form the web application provider is charged a large sum of money for usage charges when he or she stores and manages all documents on the client apparatus in the above mentioned document management web application. These usage charges are indirectly collected from the users so their financial burden becomes relatively heavy. Also when documents sent from a large number of client apparatus are stored in the document management web application the network load becomes considerably heavy. Hence only the bibliographic information of the documents is stored in the document management web application instead of storing the actual data of the documents in it in that case. On the other hand a prior art in which an apparatus such as a portable terminal instructs a printing apparatus to print a document stored in the document management web application by designating its URL has been proposed see for example Japanese Patent Laid Open No. 2002 169671 .

As described above in the web application service which uses cloud computing only the bibliographic information of the documents are stored in the document management web application instead of storing the actual data of the documents in it in consideration of the charges incurred in proportion to the amount of data used and the network load. On the other hand in the prior art disclosed in for example Japanese Patent Laid Open No. 2002 169671 an apparatus such as a portable terminal instructs a printing apparatus to print a document stored in the document management web application by designating its URL. However when only the bibliographic information is stored in the web application server no document data is present on the document management web application. Hence the client apparatus cannot instruct the printing apparatus to print a document by designating its URL. The present invention solves this problem.

According to one aspect of the present invention there is provided a printing system including a web application server which holds data in a storage area and which is charged in proportion to an amount of usage of the storage area a storage client apparatus and a printing apparatus characterized in that the storage client apparatus comprises providing means for providing bibliographic information of data stored in the storage client apparatus to the web application server and query means for inquiring the web application server of a print instruction to print data stored in the storage client apparatus the providing means further provides data to be stored in the storage client apparatus to the web application server in response to a provision request from the web application server when the print instruction is acquired by the query means the printing apparatus comprises print request query means for inquiring the web application server of a print request to the printing apparatus and printing means for acquiring and printing corresponding data based on information described in the print request when the print request is acquired by the print request query means and the web application server comprises storage client apparatus management means for managing information of the storage client apparatus printing apparatus management means for managing information of the printing apparatus bibliographic information management means for managing bibliographic information of the data sending means for sending display data used to display the bibliographic information of the data to a client apparatus operated by a user request management means for managing a data provision request to the storage client apparatus and a print request to the printing apparatus in response to a print request issued from the client apparatus to the printing apparatus to print the data stored in the storage client apparatus request notification means for notifying the storage client apparatus of the provision request and storage location information if the provision request to the storage client apparatus is held in the request management means in response to a query for the provision request issued by the query means of the storage client apparatus addition means for adding the storage location information of the data to be printed to the bibliographic information of the data when the data is provided from the storage client apparatus and print request notification means for notifying the printing apparatus of the print request and storage location information of the data if the print request to the printing apparatus is held in the request management means in response to a query for the print request issued by the print request query means of the printing apparatus.

According to another aspect of the present invention there is provided a storage client apparatus in a printing system including a web application server which holds data in a storage area and which is charged in proportion to an amount of usage of the storage area the storage client apparatus and a printing apparatus characterized by comprising providing means for providing bibliographic information of data stored in the storage client apparatus to the web application server and query means for inquiring the web application server of a print instruction to print data stored in the storage client apparatus wherein the providing means further provides data to be stored in the storage client apparatus to the web application server in response to a provision request from the web application server when the print instruction is acquired by the query means.

According to another aspect of the present invention there is provided a printing apparatus in a printing system including a web application server which holds data in a storage area and which is charged in proportion to an amount of usage of the storage area a storage client apparatus and the printing apparatus characterized by comprising print request query means for inquiring the web application server of a print request to the printing apparatus and printing means for acquiring and printing corresponding data based on information described in the print request when the print request is acquired by the print request query means.

According to another aspect of the present invention there is provided a web application server in a printing system including the web application server which holds data in a storage area and which is charged in proportion to an amount of usage of the storage area a storage client apparatus and a printing apparatus characterized by comprising storage client apparatus management means for managing information of the storage client apparatus printing apparatus management means for managing information of the printing apparatus bibliographic information management means for managing bibliographic information of the data sending means for sending display data used to display the bibliographic information of the data to a client apparatus operated by a user request management means for managing a data provision request to the storage client apparatus and a print request to the printing apparatus in response to a print request issued from the client apparatus to the printing apparatus to print the data stored in the storage client apparatus request notification means for notifying the storage client apparatus of the provision request and storage location information if the provision request to the storage client apparatus is held in the request management means in response to a query for the provision request issued by the query means of the storage client apparatus addition means for adding the storage location information of the data to be printed to the bibliographic information of the data when the data is provided from the storage client apparatus and print request notification means for notifying the printing apparatus of the print request and storage location information of the data if the print request to the printing apparatus is held in the request management means in response to a query for the print request issued by the print request query means of the printing apparatus.

According to another aspect of the present invention there is provided a control method in a printing system including a web application server which holds data in a storage area and which is charged in proportion to an amount of usage of the storage area a storage client apparatus and a printing apparatus characterized by comprising the step of in the storage client apparatus providing bibliographic information of data stored in the storage client apparatus to the web application server and inquiring the web application server of a print instruction to print data stored in the storage client apparatus the providing step in which data to be stored in the storage client apparatus is further provided to the web application server in response to a provision request from the web application server when the print instruction is acquired by the query means in the printing apparatus inquiring the web application server of a print request to the printing apparatus and acquiring and printing corresponding data based on information described in the print request when the print request is acquired and in the web application server managing information of the storage client apparatus managing information of the printing apparatus managing bibliographic information of the data sending display data used to display the bibliographic information of the data to a client apparatus operated by a user managing a data provision request to the storage client apparatus and a print request to the printing apparatus in response to a print request issued from the client apparatus to the printing apparatus to print the data stored in the storage client apparatus notifying the storage client apparatus of the provision request and storage location information if the provision request to the storage client apparatus is held in response to a query for the provision request issued by the storage client apparatus adding the storage location information of the data to be printed to the bibliographic information of the data when the data is provided from the storage client apparatus and notifying the printing apparatus of the print request and storage location information of the data if the print request to the printing apparatus is held in response to a query for the print request issued by the printing apparatus.

Even in an arrangement in which only the bibliographic information of document data is present on the web application server and each client apparatus holds the document data the user can instruct the printing apparatus to print the document data using a web application.

Further features of the present invention will become apparent from the following description of exemplary embodiments with reference to the attached drawings.

Best modes for carrying out the present invention will be described below with reference to the accompanying drawings.

The host computer includes the web browser shown in and is connected by HTTP to the web application server to be able to receive a service provided by it. Examples of the host computer are a PC Personal Computer a PDA Personal Digital Assistant and a mobile phone. Alternatively the host computer may be a printing apparatus. The host computer is connected to the Internet .

The storage client apparatus includes a storage to store document data and can be connected to the Internet . An example of the document data is data in PDF files. The web application server systematically manages document data stored in a plurality of storage client apparatuses . The storage client apparatus is often the host computer or printing apparatus . Firewalls limit access from the outside via the Internet in order to enhance the security of the printing apparatus .

Referring to a CPU executes programs such as an OS and application which are stored in a program ROM of a ROM or loaded into a RAM by an external memory . Note that the OS is an abbreviation for an operating system running on a computer and an operating system will be referred to as an OS hereinafter. The CPU executes processing in each flowchart to be described later. The RAM functions as for example the main memory and work area of the CPU . A keyboard controller controls key input from a keyboard and a pointing device not shown . A display controller controls display on various types of displays . An external memory controller controls data access in for example the external memory HDD and a Floppy disk FD which store various types of data. A network controller is connected to the Internet to execute processing for controlling communication with other apparatuses connected to the Internet .

Note that in this embodiment a service for which the user is charged in proportion to the amount of usage of the storage area is assumed with regard to the use of the web application server .

The configuration of the printing apparatus will be described next with reference to . is a block diagram showing the detailed configuration of the printing apparatus shown in . The printing apparatus includes the controller unit which controls the entire apparatus as shown in . The controller unit controls the printer serving as an image output device and is connected to the Internet via a wired wireless line to input output image information and device information via them.

The controller unit includes a CPU . The CPU is connected to a RAM ROM HDD Hard Disk Drive image bus I F operation unit I F and network I F via a system bus . The RAM is a memory for providing a working area to the CPU . The RAM is also used as an image memory for temporarily storing image data. The ROM is a boot ROM. The ROM stores a system boot program. The HDD stores for example system software and image data.

The operation unit I F is an interface for inputting outputting information to from the operation unit and plays a role in for example outputting image data displayed on the operation unit to the operation unit and transmitting information input via the operation unit by the user to the CPU . The network I F is connected to the Internet via the firewall and inputs outputs information to from the Internet . The image bus I F is a bus bridge which connects the system bus and an image bus that transfers image data at high speed to each other to convert the data structure.

The image bus is connected to a RIP Raster Image Processor device I F and printer image processing unit . The RIP rasterizes a PDL code received from a network into a bitmap image. The device I F connects the printer and the controller unit to each other to convert image data by a synchronous system asynchronous system. The printer image processing unit performs for example printer correction and resolution conversion for print output image data.

The software configuration of the web application server printing apparatus host computer and storage client apparatus will be described next with reference to .

The web application server includes a web server unit application server unit data management unit web service provider unit bibliographic information table management unit request table management unit and printing apparatus table management unit . These constituent elements are present as program files stored in the external memory of the web application server . The above mentioned program files are loaded into the RAM by the OS and modules which use its modules and executed by the CPU . The web server unit accepts an HTTP request from the web browser of the host computer via the Internet and sends back an HTTP response corresponding to the request to the host computer .

The application server unit is invoked from the web server unit in response to the HTTP request to execute processing. The application server unit sends back a dynamically generated HTML to the web server unit as the processing result. The data management unit manages data which requires persistence. The web service provider unit sends web service responses to web service requests from the storage client apparatus and printing apparatus . The bibliographic information table management unit manages the bibliographic information of document data on the storage client apparatus . Thus a bibliographic information management means is implemented. The request table management unit generates and manages requests to the storage client apparatus and printing apparatus in response to a print request sent from the host computer . Thus a request management means is implemented. The printing apparatus table management unit manages printing apparatus information sent by the printing apparatus upon issuing a printing apparatus register request. Thus a printing apparatus management means is implemented.

The storage client apparatus includes at least a web service requester unit . The web service requester unit sends the bibliographic information of a document to the web service provider unit of the web application server . Also the web service requester unit sends a print request query to the web service provider unit of the web application server . Examples of the storage client apparatus are the host computer and printing apparatus . The storage client apparatus corresponds to all apparatuses each of which includes the web service requester unit and can store a document in the external memory .

The printing apparatus includes for example a user interface to be abbreviated as a UI hereinafter web service requester unit control API job manager print manager and PDL manager . These constituent elements are present as program files stored in the HDD of the printing apparatus . The above mentioned program files are loaded into the RAM by the OS and modules which use its modules and executed by the CPU .

In the printing apparatus the UI serves as a module which mediates between the apparatuses and the user operations in performing various types of operations settings for the printing apparatus . The UI is used to perform for example processing requests or data settings by transferring the input information to various types of modules to be described later in accordance with the user operations. The web service requester unit sends a print request query to the web service provider unit of the web application server . The control API provides an interface for modules such as the job manager to modules such as the web service requester unit . The dependences among the various types of modules are reduced thereby making it possible to enhance the availabilities of these individual modules.

The job manager interprets various kinds of processing instructed by the above mentioned various types of modules via the control API and issues an instruction to each module. Also the job manager performs centralized management of hardware processing executed in the printing apparatus . The print manager manages controls printing processing instructed by the job manager . The PDL manager performs PDL conversion of document data designated by the job manager .

The printing apparatus table management unit in the web application server manages the printing apparatus ID of the printing apparatus its installation location information such as the country and area its capability information such as color monochrome printing and double single sided printing. The printing apparatus may include the web browser to be described later . The host computer includes for example the web browser . The web browser is present as a program file stored in the external memory of the host computer . The above mentioned program file is loaded into the RAM by the OS and modules which use its modules and executed by the CPU . The web browser is displayed on the display and receives key input from the keyboard or a pointing device not shown by the user. Also the web browser is connected by HTTP to the web application server via the Internet to receive a service provided by it.

The web application server in the present invention is sometimes provided by virtual machines provided by a server computer group shown in . In this configuration communication with the storage client apparatus and printing apparatus is HTTP communication a load balancer assigns communication to each virtual machine and a web role instance makes a response. Communication is mainly performed by REST and web services. illustrates an example of a REST message. A worker role instance is invoked from the web role instance as needed in executing processing which requires much time.

A printing apparatus table managed by the printing apparatus table management unit in the web application server will be described next with reference to . The printing apparatus table is a data table for holding data in association with the printing apparatus ID of the printing apparatus its installation location information and its capability information such as color monochrome printing and double single sided printing. The installation location information and capability information of the printing apparatus in the printing apparatus table are used as printing apparatus search information when the user selects a desired printing apparatus on a web application provided by the web application server . Note that the configuration of the printing apparatus table presented herein is merely an example and the present invention is not limited to this configuration. Accordingly necessary information may be added and deleted as needed.

A request table managed by the request table management unit in the web application server will be described next with reference to . A request means herein an instruction issued to each printing apparatus to process a job. Also in this embodiment the request table management unit implements a request management means. The request table is generated updated by invoking the request table management unit by the web service provider unit of the web application server in response to a print request from the host computer . The apparatus ID is the ID of the printing apparatus or storage client apparatus that is the destination to which various types of requests are sent. The request name indicates the request type corresponding to the apparatus ID. With this information a target printing apparatus or storage client apparatus is uniquely identified and managed. The request type includes an Upload Request a URL Print Request and a Direct Print Request . The web application server cannot directly send a request to the printing apparatus or storage client apparatus which is shielded by the firewall . Hence upon receiving a request query from the printing apparatus or storage client apparatus the web application server sends a request as a response to the request query. The upload request means issuing a request to provide data to be printed to the storage client apparatus . The URL print request means issuing a request to the printing apparatus to print data to be printed by looking up a URL serving as the storage location information of this data. The direct print request means issuing a request to the printing apparatus to print data to be printed by directly acquiring this data. By looking up these request names the type of request associated with the data to be printed is managed.

Upon receiving a request query from the storage client apparatus or printing apparatus the web application server searches the request table for a request associated with the corresponding apparatus ID. If the request type is an upload request a character string indicating to that effect and an upload destination URL Uniform Resource Locator that is the storage location information are sent as a response to the request query. If the request type is a URL print request a character string indicating to that effect and the download destination URL are sent. If the request type is a direct print request a character string indicating to that effect and the ID of document data to be printed are sent.

A first sequence according to this embodiment will be described with reference to and a flowchart shown in . The first sequence is the sequence of processing for registering information of the printing apparatus in the web application server . The first sequence is executed only once in order to start the use of the web application server in setting the printing apparatus . The registered printing apparatus information is used to allow the user to select a printing apparatus for which a print instruction is issued from the web application server .

Data in the printing apparatus table managed by the printing apparatus table management unit in this embodiment will be described. Data indicates that a printing apparatus defined by a printing apparatus ID xxx a country JAPAN an area TOKYO a color monochrome machine category Color a double single sided function category Double sided Printing and a previous access date time 2009 10 01 22 10 50 is registered in the printing apparatus table of the web application server . Similarly data indicates that a printing apparatus defined by a printing apparatus ID yyy a country USA an area New York a color monochrome machine category BW a double single sided function category Double sided Printing and a previous access date time 2009 10 01 22 10 55 is registered in the printing apparatus table of the web application server . Data indicates that a printing apparatus defined by a printing apparatus ID zzz a country JAPAN an area KYOTO a color monochrome machine category Color a double single sided function category Double sided Printing and a previous access date time 2009 10 01 22 10 52 is registered in the printing apparatus table of the web application server . By the first sequence shown in the above mentioned information is registered in the printing apparatus table . Also the above mentioned information is used as search information with which the user selects a printing apparatus in the application on the web application server . Each item of the printing apparatus table is not limited to the configuration in this embodiment and more detailed information of the printing apparatus can be stored as needed.

The sequence of printing apparatus registration will be described next with reference to . First in step S the UI of the printing apparatus displays a printing apparatus registration screen shown in . In step S the user presses an OK button . The form area layout and control of the user interface shown in are not limited to specific ones and this user interface may take any form as long as it can implement necessary functions. In step S the web service requester unit of the printing apparatus invokes the printing apparatus table management unit . The printing apparatus table management unit sends back information of the printing apparatus to the web service requester unit . The web service requester unit issues a printing apparatus register request to the web application server . The printing apparatus register request contains the printing apparatus ID printing apparatus position information and printing apparatus capability information. The printing apparatus register request is issued by communication which uses for example SOAP.

In step S the web service provider unit of the web application server receives the printing apparatus register request from the web service requester unit of the printing apparatus . In step S the web service provider unit of the web application server invokes the printing apparatus table management unit . The printing apparatus table management unit acquires the information of the printing apparatus based on the printing apparatus register request from the printing apparatus and registers it in the printing apparatus table . In step S the web service provider unit of the web application server sends a printing apparatus registration notification to the web service requester unit of the printing apparatus . In step S the web service requester unit of the printing apparatus receives the printing apparatus registration notification from the web service provider unit of the web application server . As has been described above by the first sequence information of the printing apparatus can be registered in the web application server .

A second sequence according to this embodiment will be described next with reference to a flowchart shown in and . The second sequence is the sequence of processing for registering in a bibliographic information table of the web application server the bibliographic information of document data held in the storage client apparatus . In step S the web browser on the storage client apparatus issues a request for HTML data that is display data of a document data registration screen shown in to the web server unit of the web application server . In step S the web server unit of the web application server receives the request for the HTML data of the document data registration screen .

In step S the web server unit of the web application server sends the HTML data of the document data registration screen . Also in step S the web browser on the storage client apparatus displays the document data registration screen . The document data presented on the document data registration screen is stored in the storage client apparatus . In an example shown in document data selected in a check box is registered. In step S when the user presses a register button on the document data registration screen shown in the web service requester unit of the storage client apparatus sends the bibliographic information of the document data to the web service provider unit of the web application server . In step S the web service provider unit of the web application server receives the bibliographic information of the document data.

In step S the web service provider unit of the web application server invokes the bibliographic information table management unit . The bibliographic information table management unit registers the received bibliographic information in the bibliographic information table . In step S the web service provider unit of the web application server sends a document data bibliographic information registration notification. In step S the web on the storage client apparatus receives the bibliographic information registration notification.

In the sequence shown in the user explicitly uploads the bibliographic information of document data into the web application server in storing the document data. If the storage client apparatus is not provided with the web browser the web service requester unit may automatically upload the bibliographic information of the stored document into the web application server .

As has been described above by the second sequence the bibliographic information of document data held in the storage client apparatus can be registered in the bibliographic information table of the web application server . In the foregoing way the web application server can systematically manage document data stored in each storage client apparatus .

A third sequence will be described next with reference to a flowchart shown in and . The third sequence is the sequence of processing for allowing the user to send a print request to the printing apparatus to the web application server using the web browser of the host computer and execute printing. The third sequence starts as the user accesses the URL of a web application provided by the web application server via the web browser .

In step S the web browser sends a document list screen request to the web application server . At this time HTTP communication is used. In step S the web application server sends the HTML data of a document list screen to the web browser . In step S the web browser displays a document data management screen shown in . The screen shown in is used to allow the user to systematically manage documents stored in a plurality of storage client apparatuses . The form area layout and control of the management screen are not limited to specific ones and this management screen may take any form as long as it can implement necessary functions.

In step S when the user presses a print button the web browser sends a print button pressing notification to the web application server . In step S the web application server sends the HTML data of a printing apparatus selection screen shown in . The screen shown in is used to allow the user to select a desired printing apparatus and its form area layout and control are not limited to specific ones. Also this screen may take any form as long as it can implement necessary functions.

In step S the web browser displays the printing apparatus selection screen . In step S when the user selects a printing apparatus in a check box and presses a print button the web browser sends a printing apparatus selection notification to the web application server . In step S the web application server registers the request table . An upload request and a print request are registered in the request table. The upload request contains a character string indicating that the request type is an upload request and the storage client apparatus ID. In this embodiment a storage client apparatus management means is implemented using this storage client apparatus ID. The storage client apparatus ID is acquired from the bibliographic information table shown in based on the document data ID selected by the user. The print request contains a character string indicating that the request type is a print request and the printing apparatus ID selected by the user.

In step S the web application server sends the HTML data of a printing in progress display screen to the web browser . In step S the web browser displays the printing in progress display screen. In step S the web application server stands by until a document print request is sent to the printing apparatus . The sending of a print request to the printing apparatus is executed when the web application server receives a request query from the printing apparatus . In step S the web application server sends the HTML data of a print instruction completion screen. The sending of the HTML data is asynchronously executed after the end of issuance of a print request to the printing apparatus . In step S the web browser displays the print instruction completion screen.

As has been described above in the third sequence the user can instruct a desired printing apparatus to print a desired document on a web application provided by the web application server . By the third sequence an upload request to the storage client apparatus and a print request to the printing apparatus are registered in the request table of the web application server . The web application server decides responses to request queries from the storage client apparatus and printing apparatus based on the request table .

A fourth sequence will be described next with reference to a flowchart shown in . The fourth sequence is the sequence of processing when the storage client apparatus inquires the web application server of an upload request at a predetermined cycle. By inquiring the web application server of an upload request at a predetermined cycle the storage client apparatus can receive an upload instruction upon clearing the firewall.

In step S the storage client apparatus repeats the processes in steps S to S. In step S the web service requester unit of the storage client apparatus sends an upload request query to the web application server . That is the storage client apparatus confirms whether an upload request to itself is held in the web application server . The upload request query contains the storage client apparatus ID as information. In step S the web application server receives the upload request query from the web service requester unit of the storage client apparatus .

In step S the web service provider unit of the web application server invokes the request table management unit . The request table management unit looks up the request table . In step S the request table management unit of the web application server determines whether an upload request associated with the ID of the storage client apparatus which has sent the upload request query is present in the request table . If NO is determined in step S the process advances to step S or if YES is determined in step S the process advances to step S.

In step S the web service provider unit of the web application server generates a None response. The None response means a response indicating that no request to the storage client apparatus is present. In step S the web service provider unit of the web application server generates an upload response. The upload response contains a character string indicating that the request type is an upload request and the upload destination URL.

In step S the web service provider unit of the web application server sends the response generated in step S or S to the web service requester unit of the storage client apparatus . Thus a request notification means is implemented. In step S the web service requester unit of the storage client apparatus receives the response. In step S the web service requester unit of the storage client apparatus determines whether the received response is an upload response. If YES is determined in step S the process advances to step S or if NO is determined in step S the process directly advances to step S.

In step S the web service requester unit of the storage client apparatus sends document data to the upload destination URL on the web application server which is contained in the upload response. In step S the web service provider unit of the web application server receives the document data. At this time the data management unit of the web application server stores the data in the external memory serving as a storage area.

In step S the web service provider unit of the web application server invokes the bibliographic information table management unit . The bibliographic information table management unit registers the upload destination URL of the document data in the bibliographic information table . With the process in step S the URL to which the printing apparatus downloads the document data from the web application server can be registered. In step S the web application server returns the process to step S.

As has been described above by the fourth sequence shown in the storage client apparatus can upload document data into the web application server and register its URL in the bibliographic information table as bibliographic information when a request to print data held in itself is present. Also the printing apparatus can receive a URL print request from the web application server and download document data thereby preparing for printing.

A fifth sequence will be described next with reference to a flowchart shown in . In the fifth sequence the web application server responds to the printing apparatus by generating a print response to a print request query from the printing apparatus . The printing apparatus executes URL printing. In the URL printing the printing apparatus downloads document data from the designated URL and prints it by for example PDF direct printing. The PDF direct printing means a function with which a printing apparatus can directly print document data without a printer driver as shown in . However the printing apparatus need not always be compatible with PDF direct printing and can also print document data via the RIP after the control API converts it into a format that can be printed by the PDL manager .

The fifth sequence is repeated at a predetermined cycle upon power on. The predetermined cycle is not particularly limited and a predetermined value may be held at the time of manufacture in advance or the owner of the printing apparatus may arbitrarily set this cycle. In step S the printing apparatus repeats the processes in steps S to S. In step S the web service requester unit of the printing apparatus sends a print request query to the web application server . The print request query contains the printing apparatus ID.

In step S the web service provider unit of the web application server receives the print request query from the web service requester unit of the printing apparatus . The web service provider unit of the web application server invokes the request table management unit . The request table management unit looks up the request table . In step S the request table management unit of the web application server determines whether a print request associated with the ID of the printing apparatus which has sent the print request query is present in the request table . If YES is determined in step S the process advances to step S or if NO in step S the process advances to step S.

In step S the web service provider unit of the web application server invokes the bibliographic information table management unit . The bibliographic information table management unit determines whether the URL has been registered in the bibliographic information of the document data ID registered in the request table . The URL is registered when the storage client apparatus uploads data into the data management unit of the web application server by the fourth sequence. Therefore by determining whether the URL has been registered it can be determined whether a document for which a print request is issued has been uploaded into the data management unit of the web application server . If YES is determined in step S the request table management unit of the web application server advances the process to step S or if NO is determined in step S it advances the process to step S.

In step S the web service provider unit of the web application server generates a print response. The print response contains a character string indicating that the request type is a print request and the URL to which document data is downloaded. In step S the web service provider unit of the web application server generates a None response. The None response means a response indicating that no request to the printing apparatus is present. In step S the web service provider unit of the web application server generates a None response like step S.

In step S the web service provider unit of the web application server sends the response generated in step S S or S to the web service requester unit of the printing apparatus . Thus a print request notification means is implemented. In step S the web service requester unit of the printing apparatus receives the response. In step S the web service requester unit of the printing apparatus determines whether the received response is a print response. If YES is determined in step S the process advances to step S or if NO is determined in step S the process advances to step S.

In step S the web service requester unit of the printing apparatus sends a document data request to the download destination URL on the web application server contained in the print response. The document data request is for example a request to get an HTTP protocol for a URI. In step S the web service provider unit of the web application server receives the document data request from the web service requester unit of the printing apparatus . In step S the web service provider unit of the web application server sends data to the web service requester unit of the printing apparatus .

In step S the web service provider unit of the web application server deletes the document data and deletes its URL from the bibliographic information table. This step is executed because the web application server need not hold the document data after its sending. However the sequence of processing in which the document data is not deleted assuming that it is printed a plurality of times may also be adopted. In step S the web service requester unit of the printing apparatus receives data from the web service provider unit of the web application server . In step S the print manager of the printing apparatus prints the downloaded document by for example PDF direct printing. In step S the printing apparatus returns the process to step S. The process in step S may be executed after printing processing S in the printing apparatus is completed.

As has been described above in the fifth sequence the web application server responds to the printing apparatus by generating a print response when a print request to the printing apparatus is present in the request table in response to a print request query from the printing apparatus .

Processing for sending a direct print response from a web application server to a printing apparatus in this embodiment will be described below with reference to a flowchart shown in . The direct print response means a response sent by the web application server when the printing apparatus and a storage client apparatus are the same apparatus. Only differences from the first embodiment will be described below in relation to a configuration in which a document can be printed without being uploaded into the web application server when it is stored in the printing apparatus in response to a direct print response.

The processes in steps S to S are the same as in steps S to S respectively in the fifth sequence shown in and a description thereof will not be given. In step S a web service provider unit of the web application server invokes a bibliographic information table management unit . The bibliographic information table management unit specifies the ID of a storage client apparatus which stores document data for which a print request is issued by looking up a bibliographic information table . The bibliographic information table management unit sends back the specified storage client apparatus ID to the web service provider unit .

In step S the web service provider unit of the web application server compares the storage client apparatus ID specified in step S with the printing apparatus ID that is the print request destination and determines that direct printing is possible if these IDs coincide with each other. If it is determined that direct printing is possible the process advances to step S or if it is determined that direct printing is impossible the process advances to step S. In step S the web service provider unit of the web application server generates a direct print response. The direct print response contains a character string indicating that the request type is a direct print request and the document data ID. The processes in steps S to S are the same as in steps S to S respectively in the fifth sequence shown in and a description thereof will not be given.

In step S a web service requester unit of the printing apparatus determines whether the response is a None response. If YES is determined in step S the process advances to step S or if NO is determined in step S the process advances to step S. In step S the web service requester unit of the printing apparatus determines whether the response is a direct print response. If YES is determined in step S the process advances to step S or if NO is determined in step S the process advances to step S. In step S the printing apparatus prints. The direct print response contains the document data ID. The printing apparatus invokes a data management unit to read out document data corresponding to the document data ID and prints it using a print manager . The processes in steps S to S are the same as in steps S to S respectively in the fifth sequence and a description thereof will not be given.

As has been described above in the processing shown in a document can be printed without being uploaded into the web application server when it is stored in the printing apparatus . In the foregoing way printing can be executed without wasting an external memory of the web application server .

Processing for generating a document list screen with printing limitations from a web application server to a host computer in this embodiment will be described below with reference to A and B. Because documents displayed on the document list screen are stored on a storage client apparatus in practice they cannot be printed if the storage client apparatus is unavailable due to a breakdown or a network failure. The document list screen with printing limitations is used to prohibit the user from selecting data that cannot be printed. Only differences from the first embodiment will be described below in relation to a configuration according to the third embodiment.

The web application server includes a storage client apparatus table management unit and a storage client apparatus table shown in in addition to the configuration in the first embodiment. In step S of a flowchart shown in a web service provider unit of the web application server receives an upload request query from the storage client apparatus . The web service provider unit invokes the storage client apparatus table management unit . The storage client apparatus table management unit stores the query time of day in the storage client apparatus table in association with the storage client apparatus ID.

In step S in the flowchart shown in a web server unit of the web application server invokes an application server unit . The application server unit generates HTML data of a document list screen with printing limitations and sends it back to the web server unit . The web server unit sends the above mentioned HTML data to a web browser. At this time the application server unit invokes the storage client apparatus table management unit to prohibit the user from instructing to print a document stored in a storage client apparatus which is previously accessed at a time of day earlier than a predetermined threshold. For example a print button is disabled so that the user cannot click it.

As has been described above a document list screen with printing limitations can be generated in the third embodiment. The document list screen with printing limitations can prevent the user from selecting a document that cannot be printed.

Processing for generating a printing apparatus selection screen with printing limitations from a web application server to a host computer in this embodiment will be described below with reference to and . A printing apparatus displayed on the printing apparatus selection screen is registered in the first sequence in advance. However a printing apparatus cannot print if it is unavailable due to a breakdown or a network failure. That is if no query is issued from a certain printing apparatus a predetermined time after another query is issued from this printing apparatus this printing apparatus is regarded as having a certain usage limitation. The printing apparatus selection screen with printing limitations is used to prohibit the user from selecting a printing apparatus that cannot print. Only differences from the first embodiment will be described below in relation to a configuration according to the fourth embodiment.

In step S of the flowchart shown in a web service provider unit of the web application server receives a print request query from the printing apparatus . The web service provider unit invokes a printing apparatus table management unit . The printing apparatus table management unit stores the query time of day in a printing apparatus table in association with the printing apparatus ID.

In step S of the flowchart shown in a web server unit of the web application server invokes an application server unit . The application server unit generates HTML data of a printing apparatus list screen with printing limitations and sends it back to the web server unit . The web server unit sends the above mentioned HTML data to a web browser. At this time the application server unit invokes the printing apparatus table management unit to prohibit the user from instructing to print a document stored in a printing apparatus which is previously accessed at a time of day earlier than a predetermined threshold. That is the use of a printing apparatus from which no query is issued within a predetermined time with reference to the previous query time of day is limited. For example a check box is disabled so that the user cannot click it.

As has been described above in the fourth embodiment a printing apparatus selection screen with printing limitations can be generated. The printing apparatus selection screen with printing limitations can prevent the user from selecting a printing apparatus that cannot print.

Aspects of the present invention can also be realized by a computer of a system or apparatus or devices such as a CPU or MPU that reads out and executes a program recorded on a memory device to perform the functions of the above described embodiment s and by a method the steps of which are performed by a computer of a system or apparatus by for example reading out and executing a program recorded on a memory device to perform the functions of the above described embodiment s . For this purpose the program is provided to the computer for example via a network or from a recording medium of various types serving as the memory device for example computer readable medium .

While the present invention has been described with reference to exemplary embodiments it is to be understood that the invention is not limited to the disclosed exemplary embodiments. The scope of the following claims is to be accorded the broadest interpretation so as to encompass all such modifications and equivalent structures and functions.

