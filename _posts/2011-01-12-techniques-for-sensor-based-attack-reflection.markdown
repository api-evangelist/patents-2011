---

title: Techniques for sensor based attack reflection
abstract: Techniques for sensor based attack reflection are disclosed. In one particular exemplary embodiment, the techniques may be realized as a method for sensor based attack reflection comprising detecting an attack at a sensor, identifying a portion of memory associated with the attack, redirecting at least the identified portion of memory to a secure network using an access point, extracting data associated with the attack on the secure network, redirecting a response to the attack from the secure network to the sensor, transmitting the response from the sensor to a network location associated with the attack, receiving a subsequent attack communication based on the response at the access point, redirecting the subsequent attack communication to the secure network, and analyzing the subsequent attack communication.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09185132&OS=09185132&RS=09185132
owner: Symantec Corporation
number: 09185132
owner_city: Mountain View
owner_country: US
publication_date: 20110112
---
The present disclosure relates generally to sensor based attack management and more particularly to techniques for sensor based attack reflection.

Sensors such as for example honeypots may traditionally be deployed external to a firewall e.g. on a Demilitarized Zone DMZ network . However more sophisticated attackers may have sufficient information to determine that network information e.g. addresses and ports associated with a DMZ network are not the intended targets. This may render honeypots or sensors ineffective for detecting attacks. Furthermore some attacks may initiate from inside an internal network and may be directed towards a separate portion of an internal network. For example a contractor or disgruntled employee with access to a corporate engineering LAN may attempt to access an accounting LAN of the corporation. Sensors located external to an internal network are ineffective to detect such attacks. Additionally a sensor located on an internal network may have a limited or no ability to perform diagnostic actions during an attack because of a risk of exposing an internal network to malware or other threats.

In view of the foregoing it may be understood that there may be significant problems and shortcomings associated with current sensor based attack management technologies.

Techniques for sensor based attack reflection are disclosed. In one particular exemplary embodiment the techniques may be realized as a method for sensor based attack reflection comprising detecting an attack at a sensor identifying a portion of memory associated with the attack redirecting at least the identified portion of memory to a secure network using an access point extracting data associated with the attack on the secure network redirecting a response to the attack from the secure network to the sensor transmitting the response from the sensor to a network location associated with the attack receiving a subsequent attack communication based on the response at the access point redirecting the subsequent attack communication to the secure network and analyzing the subsequent attack communication.

In accordance with other aspects of this particular exemplary embodiment the sensor may comprise a honeypot.

In accordance with further aspects of this particular exemplary embodiment the secure network may comprise a DMZ subnetwork.

In accordance with additional aspects of this particular exemplary embodiment the secure network may comprises a remote secure network of at least one of a service provider a security solution provider and a software vendor.

In accordance with additional aspects of this particular exemplary embodiment the attack may comprise an injection exploit.

In accordance with additional aspects of this particular exemplary embodiment the sensor may be located on an intranet.

In accordance with additional aspects of this particular exemplary embodiment extracting data associated with the attack on the secure network may comprise using a shell code extractor.

In accordance with additional aspects of this particular exemplary embodiment the techniques may include tagging and recording the identified portion of memory.

In accordance with additional aspects of this particular exemplary embodiment detecting the attack at the sensor may comprise detecting a presence of shell codes.

In accordance with additional aspects of this particular exemplary embodiment redirecting the identified portion of memory to the secure network using the access point may comprise providing an attribute associated with the identified portion of memory including at least one of a source IP address a destination IP address a source port a destination port a TCP transaction a TCP management packet a TCP packet with a payload and a TCP segment characteristic.

In accordance with additional aspects of this particular exemplary embodiment redirecting a response to the attack from the secure network to the sensor may comprise forwarding a request of the attack to download malware.

In accordance with additional aspects of this particular exemplary embodiment analyzing the subsequent attack communication may comprise analyzing downloaded malware.

In accordance with additional aspects of this particular exemplary embodiment redirecting the response to the attack from the secure network to the sensor may comprise using an access point to redirect the response to the sensor.

In accordance with additional aspects of this particular exemplary embodiment the access point may alter the response from the secure network to the sensor to appear to an attacker that the response came from the sensor.

In accordance with additional aspects of this particular exemplary embodiment altering the response may comprise ensuring an FTP request includes control channel address and port information associated with the sensor.

In accordance with additional aspects of this particular exemplary embodiment redirecting a response to the attack from the secure network to the sensor may comprise sending the response directly to the sensor from the secure network.

In accordance with additional aspects of this particular exemplary embodiment the access point may comprise a gateway.

In accordance with additional aspects of this particular exemplary embodiment the techniques may be realized as at least one non transitory processor readable storage medium for storing a computer program of instructions configured to be readable by at least one processor for instructing the at least one processor to execute a computer process for performing the method.

In another particular exemplary embodiment the techniques may be realized as an article of manufacture for sensor based attack reflection the article of manufacture comprising at least one non transitory processor readable medium and instructions stored on the at least one medium. The instructions may be configured to be readable from the at least one medium by at least one processor and thereby cause the at least one processor to operate so as to detect an attack at a sensor identify a portion of memory associated with the attack redirect at least the identified portion of memory to a secure network using an access point extract data associated with the attack on the secure network redirect a response to the attack from the secure network to the sensor transmit the response from the sensor to a network location associated with the attack receive a subsequent attack communication based on the response at the access point redirect the subsequent attack communication to the secure network and analyze the subsequent attack communication.

In yet another particular exemplary embodiment the techniques may be realized as a system for sensor based attack reflection comprising one or more processors communicatively coupled to a network wherein the one or more processors may be configured to detect an attack at a sensor identify a portion of memory associated with the attack redirect at least the identified portion of memory to a secure network using an access point extract data associated with the attack on the secure network redirect a response to the attack from the secure network to the sensor transmit the response from the sensor to a network location associated with the attack receive a subsequent attack communication based on the response at the access point redirect the subsequent attack communication to the secure network and analyze the subsequent attack communication.

The present disclosure will now be described in more detail with reference to exemplary embodiments thereof as shown in the accompanying drawings. While the present disclosure is described below with reference to exemplary embodiments it should be understood that the present disclosure is not limited thereto. Those of ordinary skill in the art having access to the teachings herein will recognize additional implementations modifications and embodiments as well as other fields of use which are within the scope of the present disclosure as described herein and with respect to which the present disclosure may be of significant utility.

The description below describes network elements computers and or components of a system and method for sensor based attack reflection that may include one or more modules. As used herein the term module may be understood to refer to computing software firmware hardware and or various combinations thereof. Modules however are not to be interpreted as software which is not implemented on hardware firmware or recorded on a processor readable recordable storage medium i.e. modules are not software per se . It is noted that the modules are exemplary. The modules may be combined integrated separated and or duplicated to support various applications. Also a function described herein as being performed at a particular module may be performed at one or more other modules and or by one or more other devices instead of or in addition to the function performed at the particular module. Further the modules may be implemented across multiple devices and or other components local or remote to one another. Additionally the modules may be moved from one device and added to another device and or may be included in both devices.

With reference to computer system of modem network interface or some other method may be used to provide connectivity from one or more of network element and network element to network . Network element may be able to access information on network elements A or B using for example a web browser or other client software. Such a client may allow network element to access data hosted by network element A or B or one of storage devices A N and or N .

Networks and may be local area networks LANs wide area networks WANs the Internet cellular networks satellite networks or other networks that permit communication between network elements and and other devices communicatively coupled to networks and . Networks and may further include one or any number of the exemplary types of networks mentioned above operating as a stand alone network or in cooperation with each other. Networks and may utilize one or more protocols of one or more clients or servers to which they are communicatively coupled. Networks and may translate to or from other protocols to one or more protocols of network devices. Although networks and are each depicted as one network it should be appreciated that according to one or more embodiments networks and may each comprise a plurality of interconnected networks.

Storage devices A N and or N may be network accessible storage and may be local remote or a combination thereof to network element B and SAN Fabric . Storage devices A N and or N may utilize a redundant array of inexpensive disks RAID magnetic tape disk a storage area network SAN an Internet small computer systems interface iSCSI SAN a Fibre Channel SAN a common Internet File System CIFS network attached storage NAS a network file system NFS optical based storage or other computer accessible storage. Storage devices A N and or N may be used for backup or archival purposes.

According to some embodiments network element may be a sensor a honeypot a honeyfarm or another device or virtual device coupled via a wireless or wired connection to network . Network element may receive data from user input a database a file a web service and or an application programming interface.

According to some embodiments network element may detect an attack. Detection may be performed by one or more methods including but not limited to detecting shell codes in a stream using regular expressions detecting tainted memory and detecting instruction pointers to non executable portions of memory. Network element may contain or be communicatively coupled to a sample factory which may be used to handle network interactions e.g. respond to attacks . Network element may also contain one or more Finite State Machines FSMs used to handle network interactions.

Network elements A and B may be gateways access points application servers archival platforms backup servers network storage devices media servers email servers document management platforms enterprise search servers or other devices communicatively coupled to network . Network elements A and B may utilize one of storage devices A N and or N for the storage of application data backup data or other data. Network elements A and B may be hosts such as an application server which may process data traveling between network elements N and a backup platform a backup process and or storage. According to some embodiments network elements A and B may be platforms used for backing up and or archiving data. Network element A may be a gateway or an access point on an intranet.

According to some embodiments network element may represent one or more devices servers or virtual devices connected to secure network . Secure network may be a DMZ network. Network element may include or more tools and or devices for extracting handling and or analyzing data associated with attacks such as malware. For example network element may contain or access a shell code extractor for extracting shell codes and payloads and emulating their behavior. According to one or more embodiments a secure network or DMZ may be a remote third party site which may offer malware analysis capabilities e.g. a service provider a security solution provider and or a software vendor .

Network element A may contain sensor attack reflector module . According to one or more embodiments network element A may be part of an implementation of SGNET. According to some embodiments sensor attack reflector module may track network element e.g. a registered honeypot and may store its active connections state e.g. via a TCP based protocol such as Peiros . When an attack e.g. an injection exploit is detected within network element e.g. by a sample factory contained in or associated with network element the associated portion of data associated with the attack such as for example the injection code is identified and handed off to network element via sensor attack reflector module . According to some embodiments identification may include the entire network traffic for a specific network transaction such as for example a TCP connection request one or more TCP management packets one or more TCP packets with payloads e.g. a TCP packet with a payload containing injected code and other network transaction data. Network element and or sensor attack reflector module may record and or tag portions of memory associated with an attack prior to notifying network element . Included in the notification bundle may be one or more other attack communication attributes including but not limited to the source and destination IP addresses and ports as well as the TCP segment characteristics. The reflection of network transaction data from a sensor or a honeypot e.g. network element to a secure network may allow a network element e.g. network element on a secure network to generate the correct responses. According to some embodiments only the data payload may be sent or reflected to a secure network. According to some embodiments a data payload may be sent wrapped as an executable which may be a format used by an analysis tool .

Network element may receive the notification bundle and may use one or more tools to analyze the communication classify the communication and prepare a response. For example network element may use a shell code extractor to extract a payload and emulate the behavior of the attack. Network element may prepare a response to the attack communication. For example the attack may be an injection exploit containing shell code to cause downloading of malware. Network element may prepare a response to initiate an FTP download of the malware. According to some embodiments the prepared response may be relayed by an access point or gateway e.g. sensor attack reflector module from a secure network to a sensor that is the target of the attack e.g. network element . According to some embodiments the prepared response may be sent from a secure network directly to a sensor that is the target of the attack e.g. network element . The response may be altered or configured e.g. by network element or by sensor attack reflector module to appear to an attacker that the response came from the sensor being attacked e.g. network element . Altering the response may include ensuring that an FTP request includes control channel address and port information associated with the sensor. The sensor network element may essentially act as a proxy to relay the altered response e.g. an unpacked malware request back to the attacker.

A gateway or access point e.g. sensor attack reflector module may receive a subsequent communication e.g. downloaded malware based on the altered response. Sensor attack reflector module may redirect the subsequent attack communication to secure network using filters. Network element may extract and collect data e.g. malware associated with the attack safely on secure network . The data associated with the attack may be analyzed to identify signatures behavior and other attributes.

By tracking connections to sensors and reflecting the virtual communication channel to a DMZ when an attack is detected Sensor attack reflector module may allow positioning of a sensor on an intranet and extraction and collection of malware contained within a secure network or DMZ.

Bus allows data communication between central processor and system memory which may include read only memory ROM or flash memory neither shown and random access memory RAM not shown as previously noted. The RAM may be the main memory into which the operating system and application programs may be loaded. The ROM or flash memory can contain among other code the Basic Input Output system BIOS which controls basic hardware operation such as the interaction with peripheral components. Applications resident with computer system may be stored on and accessed via a computer readable medium such as a hard disk drive e.g. fixed disk an optical drive e.g. optical drive a floppy disk unit or other storage medium. For example sensor attack reflector module may be resident in system memory .

Storage interface as with the other storage interfaces of computer system can connect to a standard computer readable medium for storage and or retrieval of information such as a fixed disk drive . Fixed disk drive may be a part of computer system or may be separate and accessed through other interface systems. Modem may provide a direct connection to a remote server via a telephone link or to the Internet via an internet service provider ISP . Network interface may provide a direct connection to a remote server via a direct network link to the Internet via a POP point of presence . Network interface may provide such connection using wireless techniques including digital cellular telephone connection Cellular Digital Packet Data CDPD connection digital satellite data connection or the like.

Many other devices or subsystems not shown may be connected in a similar manner e.g. document scanners digital cameras and so on . Conversely all of the devices shown in need not be present to practice the present disclosure. The devices and subsystems can be interconnected in different ways from that shown in . Code to implement the present disclosure may be stored in computer readable storage media such as one or more of system memory fixed disk optical disk or floppy disk . Code to implement the present disclosure may also be received via one or more interfaces and stored in memory. The operating system provided on computer system may be MS DOS MS WINDOWS OS 2 OS X UNIX Linux or another known operating system.

Power manager may monitor a power level of battery . Power manager may provide one or more APIs Application Programming Interfaces to allow determination of a power level of a time window remaining prior to shutdown of computer system a power consumption rate an indicator of whether computer system is on mains e.g. AC Power or battery power and other power related information. According to some embodiments APIs of power manager may be accessible remotely e.g. accessible to a remote backup management module via a network connection . According to some embodiments battery may be an Uninterruptable Power Supply UPS located either local to or remote from computer system . In such embodiments power manager may provide information about a power level of an UPS.

Referring to there is shown a sensor attack reflector module in accordance with an embodiment of the present disclosure. As illustrated the sensor attack reflector module may contain one or more components including attack detector module attack redirection module attack response module and error handling module .

Attack detector module may detect an attack. Detection may be performed by one or more methods including but not limited to detecting shell codes in a stream using regular expressions detecting tainted memory and detecting instruction pointers to non executable portions of memory. Attack detector module may contain or be communicatively coupled to a sample factory which may be used to handle network interactions e.g. respond to attacks . Attack detector module may also contain one or more Finite State Machines FSMs used to handle network interactions.

Attack redirection module may track one or more sensors e.g. a registered honeypot and may store its active connections state e.g. via a TCP based protocol such as Peiros . When an attack e.g. an injection exploit is detected within a sensor e.g. by a sample factory contained in or associated with a sensor the associated portion of data associated with the attack such as for example the injection code may be identified and handed off to attack response module via attack redirection module . Attack detector module and or attack redirection module may record and or tag portions of memory associated with an attack prior to notifying attack response module . According to some embodiments identification may include the entire network traffic for a specific network transaction such as for example a TCP connection request one or more TCP management packets or control packets one or more TCP packets with payloads e.g. a TCP packet with a payload containing injected code and other network transaction data. Included in the notification bundle may be one or more other attack communication attributes including but not limited to the source and destination IP addresses and ports as well as the TCP segment characteristics. The reflection of network transaction data from a sensor or a honeypot e.g. Attack detector module to a secure network may allow a network element e.g. attack response module on a secure network to generate the correct responses. According to some embodiments only the data payload may be sent Or reflected to a secure network. According to some embodiments a data payload may be sent wrapped as an executable which may be a format used by an analysis tool .

Attack response module e.g. a module on a network element of a secure network such as network element of may receive the notification bundle and may use one or more tools to analyze the communication classify the communication and prepare a response. For example attack response module may use a shell code extractor to extract a payload and emulate the behavior of the attack. Attack response module may perform protocol emulation to analyze the communication classify the communication and prepare a response. Attack response module may prepare a response to the attack communication. For example the attack may be an injection exploit containing shell code to cause downloading of malware. Attack response module may prepare a response to initiate an FTP download of the malware. According to some embodiments the prepared response may be relayed by an access point or gateway e.g. attack redirection module and or sensor attack reflector module of from a DMZ or a secure network to a sensor that is the target of the attack. According to some embodiments the prepared response may be sent from a secure network directly to a sensor that is the target of the attack. The response may be altered or configured e.g. by attack response module and or attack redirection module to appear to an attacker that the response came from the sensor being attacked e.g. sensor attack reflector module of may fix up the response to appear as if it were generated by network element of prior to relaying the response to network element . Altering the response may include ensuring that an FTP request includes control channel address and port information associated with the sensor. The sensor may essentially act as a proxy to relay the altered or configured response e.g. an unpacked malware request with identifying attributes changed to appear as if it originated from the sensor under attack back to the attacker.

Error handling module may handle one or more errors and or reporting and logging associated with sensor based attack reflection including but not limited to errors with attack detection attack redirection and attack responses.

Referring to there is depicted a method for sensor based attack reflection in accordance with an embodiment of the present disclosure. At block the method may begin.

At block an attack may be detected at a sensor. Attack detection may be performed using one or more FSMs and or sample factories. Attack detection may include but is not limited to detecting shell codes in a stream using regular expressions detecting tainted memory and detecting instruction pointers to non executable portions of memory.

At block portions of memory associated with an attack may be identified. This may include recording and or tagging portions of memory associated with an attack. Other attack communication attributes including but not limited to the source and destination IP addresses and ports as well as the TCP segment characteristics may be recorded. According to some embodiments identification may include the entire network traffic for a specific network transaction such as for example a TCP connection request one or more TCP management packets or control packets one or more TCP packets with payloads e.g. a TCP packet with a payload containing injected code and other network transaction data. Included in the notification bundle may be one or more other attack communication attributes including but not limited to the source and destination IP addresses and ports as well as the TCP segment characteristics. The reflection of network transaction data from a sensor or a honeypot to a secure network may allow a network element on a secure network to generate the correct responses.

At block at least the identified portions of memory may be identified and handed off by a gateway or access point to a network element e.g. a shell code extractor on a DMZ. According to some embodiments only the data payload may be sent or reflected to a secure network. According to some embodiments a data payload may be sent wrapped as an executable which may be a format used by an analysis tool .

At block one or more tools may be used on a secure network to analyze the attack communication classify the communication and prepare a response. For example a shell code extractor may be used to extract a payload and emulate the behavior of the attack. A response may be prepared to the attack communication. For example the attack may be an injection exploit containing shell code to cause downloading of malware. A response may be prepared to initiate an FTP download of the malware.

At block a prepared response may be relayed by an access point or gateway from a DMZ or a secure network to a sensor that is the target of the attack. According to some embodiments the prepared response may be sent from a secure network directly to a sensor that is the target of the attack.

At block the response may be altered e.g. by a host on the DMZ or by the access point or gateway to appear to an attacker that the response came from the sensor being attacked. Altering the response may include ensuring that an FTP request includes control channel address and port information associated with the sensor.

At block the sensor may essentially act as a proxy to relay the altered response e.g. an unpacked malware request back to the attacker.

At block a gateway or access point may receive a subsequent communication e.g. downloaded malware based on the altered response. The gateway or access point may redirect the subsequent attack communication to secure network using filters or other mechanisms.

At block a network element on a secure network may extract and collect data e.g. malware associated with the attack. The data associated with the attack may be analyzed to identify signatures behavior and other attributes.

By tracking connections to sensors and reflecting the virtual communication channel to a DMZ when an attack is detected it may allow positioning of a sensor on an intranet and extraction and collection of malware contained within a secure network or DMZ.

At this point it should be noted that sensor based attack reflection in accordance with the present disclosure as described above typically involves the processing of input data and the generation of output data to some extent. This input data processing and output data generation may be implemented in hardware or software. For example specific electronic components may be employed in a sensor based attack reflection module or similar or related circuitry for implementing the functions associated with sensor based attack reflection in accordance with the present disclosure as described above. Alternatively one or more processors operating in accordance with instructions may implement the functions associated with sensor based attack reflection in accordance with the present disclosure as described above. If such is the case it is within the scope of the present disclosure that such instructions may be stored on one or more processor readable storage media e.g. a magnetic disk or other storage medium or transmitted to one or more processors via one or more signals embodied in one or more carrier waves.

The present disclosure is not to be limited in scope by the specific embodiments described herein. Indeed other various embodiments of and modifications to the present disclosure in addition to those described herein will be apparent to those of ordinary skill in the art from the foregoing description and accompanying drawings. Thus such other embodiments and modifications are intended to fall within the scope of the present disclosure. Further although the present disclosure has been described herein in the context of a particular implementation in a particular environment for a particular purpose those of ordinary skill in the art will recognize that its usefulness is not limited thereto and that the present disclosure may be beneficially implemented in any number of environments for any number of purposes. Accordingly the claims set forth below should be construed in view of the full breadth and spirit of the present disclosure as described herein.

