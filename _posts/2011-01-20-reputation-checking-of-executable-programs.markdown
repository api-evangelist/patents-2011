---

title: Reputation checking of executable programs
abstract: The reputation of an executable computer program is checked when a user input to a computing device initiates a program launch, thus triggering a check of a local cache of reputation information. If the local cache confirms that the program is safe, it is permitted to launch, typically without notifying the user that a reputation check has been made. If the local cache cannot confirm the safety of the program, a reputation check is made by accessing a reputation service in the cloud. If the reputation service identifies the program as safe, it returns an indication to the computing device and the program is permitted to be launched, again without notifying the user that a reputation check has been made. If the reputation service identifies the program as unsafe or potentially unsafe, or does not recognize it at all, a warning is displayed to the user.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08863291&OS=08863291&RS=08863291
owner: Microsoft Corporation
number: 08863291
owner_city: Redmond
owner_country: US
publication_date: 20110120
---
Executable programs and files requiring executable programs to open are available in all forms to computer users from many sources. Not only can such programs be downloaded from remote locations such as the cloud or other computers in a local area network but they can be purchased at retail stores and provided by other computer users on computer readable media such as compact discs CDs and DVDs. One problem with such programs especially those obtained or purchased from other than well known vendors is that any such program can pose a threat to the user s computer. For example a user can launch such a program and unknowingly infect his or her computer with a virus or other malware. Often malware is even disguised as another program in an attempt to deceive users into believing that it is safe to install the program on their computers.

Various approaches have been proposed for checking the reputation of files downloaded from the Internet. While these approaches may be convenient and effective when applied to downloaded files it would be advantageous to be able to check executable programs at the time a user enters a command to a computer s operating system software to launch the program but before the program is actually run.

This Summary is provided to introduce a selection of concepts in a simplified form that are further described below in the Detailed Description. This Summary is not intended to identify key features or essential features of the claimed subject matter nor is it intended to be used to limit the scope of the claimed subject matter.

In accordance with one or more aspects of the claimed subject matter a computing device executes a method by which a user command to initiate a launch of an executable program or computer code causes information regarding the program or code to be sent to a reputation service in the cloud. If the reputation service identifies the program as known to be safe it returns an indication to the computing device and the program is permitted to be launched without any notification to the user that a reputation check has been made if the reputation service identifies the program as unsafe or potentially unsafe or does not recognize the program at all an appropriate message is displayed for the user.

In another aspect of the invention the user command causes the operating system first to check a local cache of reputation information on the computing device. If the local cache can confirm that the program or code is known to be safe it is permitted to launch typically without any notification to the user that a reputation check has even been made. If the local reputation cache identifies the program as unsafe or potentially unsafe an appropriate message is displayed for the user. If the local cache does not recognize the program or has no reputation information on it the method accesses the reputation service in the cloud.

One skilled in the art will readily understand that the drawings are schematic in many respects but nevertheless will find them sufficient when taken with the detailed description that follows to make and use the claimed subject matter.

Still referring to the system includes a computing device that incorporates an operating system module stored on a non transitory computer readable storage device as encoded computer executable instructions for controlling the computing device . These instructions when executed by a processor cause the computing device to perform according to the method embodiments described herein. The computing device also includes an input component which in a typical implementation will comprise a conventional pointing device such as a mouse and a keyboard although many other input components could be used such as a touch screen activated by a user s hand or a pen voice commands and the like. A user of the computing device typically uses the input component to provide commands in a known manner to the operating system module via a graphical user interface displayed on a display component such as a computer monitor.

As used in this description the terms component module system apparatus interface or the like are generally intended to refer to a computer related entity either hardware a combination of hardware and software software or software in execution. For example such a component may be but is not limited to being a process running on a processor a processor an object an executable a thread of execution a program and or a computer. By way of illustration both an application running on a controller and the controller can be a component. One or more components may reside within a process and or thread of execution and a component may be localized on one computer and or distributed between two or more computer any of the functions or techniques described herein can be implemented using software firmware hardware e.g. fixed logic circuitry manual processing or a combination of these implementations. In the case of software implementation the module or component represents program code that performs specified tasks when executed on a processor e.g. CPU or CPUs . The program code can be stored in one or more computer readable memory devices. The features of the reputation checking techniques discussed in detail below are platform independent meaning that they can be implemented on a variety of commercial computing platforms. It will be further understood that a module as used herein and particularly in is not necessarily and typically is not a physically separate component. The modules referred to in connection with are to be understood in a broad sense as information in the form of executable instructions storage locations etc. that may be and typically are distributed across various locations in the storage media on which they reside.

Furthermore the claimed subject matter may be implemented as a method apparatus or article of manufacture using standard programming and or engineering techniques to produce software firmware hardware or any combination thereof to control a computer to implement the disclosed subject matter. The term article of manufacture as used herein is intended to encompass a computer program accessible from any computer readable device carrier or media. For example computer readable media can include but are not limited to magnetic storage devices e.g. hard disc floppy disc magnetic strips . . . optical discs e.g. compact disc CD digital versatile disc DVD . . . smart cards and flash memory devices e.g. card stick key drive . . . . Of course those skilled in the art will recognize that many modifications may be made to configurations discussed herein without departing from the scope or spirit of the claimed subject matter. Moreover the term computer or computing device is not meant to be limiting in any manner. For example the computing device can be a desktop computer a mobile station a netbook or laptop computer a notepad or tablet computer an entertainment appliance a set top box communicatively coupled to a display device a cellular or other wireless phone a personal digital assistant a smart phone a television game console an automotive computer and so forth. Thus the computing device may range from a hill resource device with substantial memory and processor resources e.g. personal computers game consoles to a low resource device with limited memory and or processing resources e.g. traditional set top boxes hand held game consoles .

Returning to the computing device further includes a disc storage that includes an executable program module and a reputation module that cooperates with the executable program module in a fashion described further below. The disc storage is typically a non transitory computer readable storage component. A user of the computing device can launch executable programs stored in the executable program module by using the input component in a known fashion to issue commands to the operating system module via the graphical user interface discussed above. A web browser is a particular type of executable program also under the control of the operating system module that allows a user of the computing device to use the Web browser to browse or otherwise navigate to a Web site and download files from a content server . The Web browser includes its own reputation module .

The computing device can communicate with the cloud which can be a variety of different networks including one or more of the Internet a local area network LAN a public telephone network an intranet other public and or proprietary networks a reputation service provided by an in house server or by an enterprise combinations thereof and so forth. In other words the system accesses a reputation service that is remote that is separate from the computing device . The cloud includes a reputation service module with which the computing device can communicate via many types of connections using various protocols or technologies such as a conventional Internet connection universal serial bus USB connections wireless USB connections infrared connections Bluetooth connections and so forth. The Web browser enables the user to download files and programs from one or more content server modules in the cloud . Alternatively files and programs can be obtained by the Web browser from other sources such as another computing device coupled to the computing device via the cloud or via another type of connection. In addition the computing device can communicate with the reputation service module other than via the Web browser as discussed in more detail below. Although a single computing device is illustrated in it is to be appreciated that the reputation service module can and typically does communicate with multiple computing devices similar to the device .

The reputation service module can be one or more computing devices that maintain and provide reputation information regarding programs and flies as discussed in more detail below. Typically the reputation service module is implemented using one or more server computers although a variety of different types of computers e.g. similar to the discussion above with respect to computing device can be used to implement the reputation service . As noted above the reputation service is accessed via the cloud or other connection and is also sometimes referred to herein as being a remote reputation service. In that regard various reputation service modules all of which are meant to be included by the representation of the module can be in close physical proximity to the computing device e.g. in the same room or building or far removed from the computing device e.g. in another state or country .

Co pending U.S. patent application Ser. No. 12 880 363 deals with actions that are taken when a file is downloaded or otherwise obtained by a Web browser of a computer. In that event information identifying the file is provided to the reputation module . This information is sent to the remote reputation service which identifies a reputation indication for the identified file and returns the reputation indication to the reputation module . The reputation indication is an indication for example whether the identified file is a low risk of being malware or a high risk of being malware. Based on the reputation indication the reputation module determines an appropriate user interface for the Web browser to display with regard to the newly obtained file. For example if the reputation indication identifies the file as being a low risk of being malware then the Web browser can install and or run the program in the file without displaying a warning. However if the reputation indication identifies the file as being a high risk of being malware the Web browser can display a warning and or recommendations to the user regarding installing and or running the program in the file.

In contrast the reputation module responds to a user s command to the operating system module to launch any executable program or computer code from the executable programs module . Broadly speaking upon receiving a command from the input component the operating system module causes the reputation module to initiate a reputation check on the program in accordance with the principles and methods discussed further below in more detail. The reputation module may contain a local cache of reputation information on programs. If a program the user desires to launch is trusted that is if the local cache confirms that the program represents a low risk of causing the computing device to malfunction the operating system module causes the program to run without any notification to the user that a reputation check has even been made. If the local cache does not recognize the program or has no reputation information on it the reputation module initiates a reputation check by accessing the reputation service module in the cloud. If the reputation service module identifies the program as known to be safe that is trusted it returns an indication of such to the operating system module which causes the program to run again without any notification to the user that a reputation check has been made. If the reputation server or the local reputation cache identifies the program as unsafe or potentially unsafe or does not recognize the program at all it provides an appropriate message to the user on the display component . The message may prompt the user to enter a command indicating how the user wants to proceed. For example the prompt could allow the user to proceed with the launch of the program or have the program deleted or quarantined or initiate other action or actions.

Step S checks the local reputation cache in the reputation module to determine if it contains reputation information about the program. If the reputation module indicates that the program is trusted the operating system module causes the program to launch in step S. As mentioned above the user normally is not notified that the operating system has checked the reputation of the program if the reputation module finds it to be trusted. However if the reputation module s local cache of reputation information cannot verify that the program is trusted the flowchart proceeds to step S which begins a process of reputation checking with the reputation service in the cloud. On the other hand if the local cache knows that the program presents a risk of causing the computing device to malfunction it can instruct the operating system to take appropriate action. This might be displaying a notification on the display component that prompts the user to decide how to proceed. Types of notifications provided to the user are discussed below in connection with .

The reputation module applies predetermined criteria to decide whether or not to proceed to step S and initiate a reputation check beyond the local cache of reputation information. For example in one embodiment the operating system module applies an identifier that will cause the reputation module to proceed to step S. This identifier is typically applied to indicate that the program originated from a location other than the disc storage on the user s computer device. Examples are programs originating from e mails programs originating from other computer devices on the same local area network as the user s computer device programs originating with LAN messenger programs programs loaded onto the computing device via a USB connection programs originating from the cloud for example from a content server programs that are not signed or any other criteria that could indicate that the program could present a risk to the user s computer device.

Step S assembles the information necessary for the cloud reputation service to perform a reputation check on the program. It will be appreciated that the specific information provided depends on the manner in which the reputation service performs the reputation check. The reputation module will include software that assembles this information in any appropriate form. Examples of information sent to the reputation service are the program type which could include any file with the extension .EXE screen saver programs software components used for the installation maintenance and removal of software on the disc storage and the like. In addition to the program type information that uniquely identifies the file being sent such a file hash code digital signature name of the file or other identifying code that the reputation service will use in making its reputation check.

Next the process determiners in step S checks to see if the user has indicated that his or her policy is not to perform reputation checks. illustrates a sample user interface that can be displayed on the display component to allow the user to select whether or not the reputation module will automatically perform a reputation check. A control window displayed on the display component includes a description explaining to the user why the reputation module would send information to a remote reputation service if the reputation check is enabled. A link to a privacy statement is also displayed if the user selects link a privacy statement not shown of the reputation service is displayed explaining to the user how no user identifying information is sent and or how the information sent to the remote reputation service is kept confidential. For example information identifying a program and or a user action that is taken may be sent to reputation service but no indication of the user of computing device need be provided to reputation service or if provided need not be retained thereby . Additionally the user is able to select a radio button to opt in to the sending of information to the remote reputation service or a radio button to opt out of sending of information to the remote reputation service . The user then selects an OK button to have the selection saved. It is to be appreciated that radio buttons and an OK button are only examples of user interfaces that can be presented to a user to opt in or opt out of sending information to the remote reputation service and that a variety of other conventional user interface techniques can alternatively be used. It is also possible to further refine this step so that the user can opt in or opt out of checks of particular program or file types. For example the user may only want to check the reputation of programs that originated with e mail messages.

Typically the operating system module will set the reputation module to automatically send program information to the reputation service if the local cache cannot confirm that the program is safe. However if the user has opted out of this operating system default setting using the control window shown in the flow returns to step S and the operating system module launches the program without a reputation check by the reputation service . Otherwise the information is sent to the reputation service in step S. The reputation service uses the information sent by the reputation module to perform a reputation check in step S. A reputation check in accordance with step S can involve many criteria and return a wide variety of information to the user. Examples of information returned by the reputation service include notification that the originator of the program is unknown to the reputation service that the reputation service does not recognize the program that the program is known to be malware capable of causing the computing device to malfunction just to name a few. Although the reputation service can return a wide variety of reputation information for purposes of illustration the present embodiment simply checks to see if the reputation service can identify the original or of the program.

If the program originator is known by the reputation service to publish reliable programs presenting little or no risk of damage or compromise to the user s computer device the process proceeds to step S to launch the program. This step is essentially the same as step S and normally the user is not informed that a reputation check was even made. However if the reputation service cannot verify the program publisher step S returns information from the reputation check to the reputation module which displays in a window such as that shown in a warning based on the reputation information returned by the reputation service .

The control window user interface in is displayed on the display component to allow the user to select whether or not to run the program. It includes a description explaining to the user that it contains a security warning and text explaining the nature of the potential threat. This example includes the name of the program that was launched text indicating that the publisher of the program is unknown to the reputation service the type of the program and the origin of the program. The interface includes a check box by which the user can instruct the reputation module to always provide a warning. When a launch of this program is initiated. If the user elects not to be warned again when launching the same program an indication is made in the reputation module to launch the program without performing the reputation check in step S of . The control window can also include other information that might be useful to the user in deciding whether or not to continue with the program launch. Additionally the user is able to select a Run button that instructs the operating system to continue with the program launch or a Cancel button that cancels the program launch. As noted above the control window in can also provide the user with numerous other options such as deleting or quarantining the program so that it cannot be accessed in the future.

Step S reflects the user s choice of either the Run button or the Cancel button . If the user chose the Run button the process proceeds to step S to launch the program. If the user chose the Cancel button the process proceeds to step S to abort the program launch. The reputation module can further communicate the user s choice to the reputation service . This information is used by the reputation service to continue to build on the reputation information available to subscribers of the service. For example if multiple users launch an unknown program without causing their computing devices to malfunction the reputation service can change the nature of the information returned to future users to indicate that the program is not known to cause malfunctions.

In another aspect of the invention the information returned by the reputation service can include a quantitative rating of the risk that the program is malware that will cause the computing device to malfunction. One such embodiment would assign a numerical rating between say 1 and 10 to the risk involved in launching a program. For example if the reputation service had sufficient information to determine that a program was almost certainly not malware it might give the program a rating of 1. At the other end of the scale if the program was known to be malware that would definitely cause the computing device to malfunction the reputation service would give the program a rating of 10. Other examples might be that the reputation service has accumulated information that multiple users have launched the program without damage to their computing devices but a rating algorithm used by the reputation service determines that the number of such users of which it is aware is too low to give the program a 1 rating. In that case the reputation service might give the program a lesser rating that takes into account that the reputation service has what its rating algorithm considers to be incomplete information. If the reputation has no information on the program this could be reflected in the same rating system or it could be a separate category of information returned to the reputation module . It will be understood that the numerical rating scale of 1 to 10 described here is meant simply as an example and other rating systems can be used in this connection.

This numerical rating is used by the operating system module in the following fashion. The operating system module will typically require any program being launched in response to a user command to meet a certain level of privilege. This is a safeguard built into most operating system software and is well known to those skilled in the art. For example there are a number of areas of the operating system and other modules of the computing device that must be accessed to enable the operating system actually to launch a particular executable program and permit it to be used. As those skilled in the art know the number and nature of such areas can vary from program to program. Accessing certain areas or modules can create a greater risk of harm to the computing device than others if a program is malware. To enhance protection against malfunction of the computing device by completing the launch of a particular program and using it the reputation module provides to the operating system module the numerical rating returned by the reputation service . The operating system then matches that rating against the privilege requirements of the program. The operating system uses a policy setting to determine whether or not there is sufficient confidence that the program s rating meets or exceeds the privilege requirements reflected by its required level of privilege. It will be appreciated that the match between the program s reputation and its privilege requirements is somewhat arbitrary and those skilled in the art will be able to formulate an appropriate algorithm that will provide adequate protection for the computing device. However a guiding principle is that the rating system be designed so that the rating provided by the reputation service reflects a predetermined level of confidence that the program meets or exceeds the privilege requirements it needs to be used.

If the program rating is as high or higher than the minimum rating required by the level of privilege needed by the program the operating system module continues with the launch of the program without notifying the user. In other words the method shown in proceeds to step S as discussed above. However if the program requires a higher level of privilege than is warranted by the rating the operating system can display a notification similar to that shown in . If the system is set up so that unknown programs are not given a rating the screen in is still used. 

With a rating system like that described here this notification can provide the user with various categories of information and options. In one embodiment the notification would display the rating given to the program the maximum level of privilege the program should be permitted to access based on the rating and the level of privilege the program requires to run on the computing device. As noted above one skilled in this art will be able to program the operating system to display this information on the display component . The notification screen can include a radio button or check box that permits the user to choose to run the program without restriction. This would reflect the user s determination that the reputation rating of the program is sufficient to warrant launching it anyway. For example the rating might be a 4 Which in one embodiment might indicate that the reputation service has sufficient information based on other users experiences and has no information that the software publisher is known to provide malware but still does not have extensive information on the software publisher s reliability. In turn the program might require a level of privilege just above the maximum to which the program is entitled to access in that event the user could choose to launch the program anyway. Another choice that might be given to the user is to run the program in a virtual environment. That is the program even one with a very poor rating could be run without requiring access to any part of the actual operating system module and instead be granted access to a virtualized copy of the same module. Thus even if the program turned out to in fact be malware it would not damage the actual operating module .

It will be also be appreciated that the method just described is not limited to checking the reputation of executable programs per se. For example many files and documents require the launch of executable programs to view the file or document. The methods discussed herein and the subject matter claimed are also applicable when the operating system receives a user command to open such a file or document. That is a user command for initiating a launch of executable code is intended to include a user command to open a file or documents requiring the launch of such code in this specific application the identifier discussed above as applied to programs being launched to initiate a reputation check could also be applied to files with any of the following extensions .PDF .DOC .DOCX .ZIP .INI .MP3 and .WAV just to name a few. Then a reputation check could be performed on such files if they originated from a location other than the disc storage on the user s computer device as in the examples listed above such as files originating from e mails from other computer devices on the same local area network as the user s computer device files originating with LAN messenger programs programs originating from the cloud or example from a content server files that are not signed or any other criteria that could indicate that the file could present a risk to the user s computing device. The method described above in connection with for checking the reputation of programs could be applied to such documents when the user instructs the operating system module to open the document in a program adapted to that purpose.

Summarizing the reputation information maintained by the remote reputation service indicates a reputation for an executable program. Generally the reputation is an indication of how trustworthy and or reliable the program is perceived by the reputation service and can be based on actions taken with the program such as running the program by other users. The reputation for a program can indicate for example whether the program is known to be non malware whether the program is known to be malware how frequently the program is run by other users and so forth. The reputation for a program can be further based on for example how frequently the program is run whether the program has been reported as being malware and so forth. The remote reputation service can obtain information to determine the reputation for a program from various sources such as computing devices that run the program a trusted third party service an administrator or other trusted user of the reputation service and so forth. The reputation information maintained by the remote reputation service can also include other information such as that a newer version that is more reliable is available. The reputation information maintained by the remote reputation service can also include a link to a location where the newer version of the program can be downloaded and could provide such a link as part of the reputation indication that is returned to the reputation module .

In one or more variations the remote reputation service returns to the reputation module a reputation indication that is a particular value or rating that comprises different values or ratings associated with particular reputations. Table I includes examples of different values or ratings that can be returned by the remote reputation service to the computing device . It should be appreciated that the values or ratings in Table are examples and that other values or ratings can alternatively be used.

The values 1 2 and 3 would be comparable to the quantitative ratings given to a program as discussed above in connection with matching a program rating and its required level of privilege. For a reputation value of 4 the reputation module could cause the display component to display an appropriate message to the user concerning where in the cloud say on the Internet an up to date version of the program can be obtained. Value 5 is similar to the information returned when the reputation service has no information on the program. Value 6 does not indicate that the program will damage the computing device but that it could for example slow its operation.

Generally speaking the techniques discussed herein can be implemented in software with instructions being executed by one or more processing units. Typically software includes routines programs objects components data structures and so forth that perform particular tasks or implement particular abstract data types. An implementation of these modules and techniques may be stored on or transmitted across some form of computer readable media. Computer readable media can be any available medium or media that can be accessed by a computing device. By way of example and not limitation computer readable media may comprise computer storage media and communications media. 

 Computer storage media include volatile and non volatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions data structures program modules or other data. Computer storage media include but are not limited to RAM ROM EEPROM flash memory or other memory technology CD ROM digital versatile disks DVD or other optical storage magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other medium which can be used to store the desired information and which can be accessed by a computer.

 Communication media typically embody computer readable instructions data structures program modules or other data in a modulated data signal such as carrier wave or other transport mechanism. Communication media also include any information delivery media. The term modulated data signal means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example and not limitation communication media include wired media such as a wired network or direct wired connection and wireless media such as acoustic RF infrared and other wireless media. Combinations of any of the above are also included within the scope of computer readable media.

Although the subject matter has been described in language specific to structural features and or methodological acts it is to be understood that the subject matter defined in the appended claims is not necessarily limited to the specific features or acts described above. Rather the specific features and acts described above are disclosed as example forms of implementing the claims.

