---

title: Clipboard protection system in DRM environment and recording medium in which program for executing method in computer is recorded
abstract: Disclosed are a clipboard protection system in a DRM environment and a recording medium in which a program for executing the method in a computer is recorded. An identification information management unit changes first identification information of data, which is to be stored in a clipboard, into second identification information when data stored in the clipboard is requested by a reliable object, and outputs the second identification information corresponding to identification information of the reading target data if the reliable object requests extraction of the data stored in the clipboard. A data protection unit encodes the data, which is to be stored in the clipboard, and decodes the encoded data which is read from the clipboard. If the extraction request for the data stored in the clipboard is inputted from the reliable object, a control unit delivers to a clipboard management system the second identification information corresponding to the identification information of the reading target data, and requests the encoded security data to be read and provided from the clipboard. According to the present invention, the access to the security data by a non-reliable object can be blocked.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09098713&OS=09098713&RS=09098713
owner: FASOO.COM CO., LTD
number: 09098713
owner_city: Seoul
owner_country: KR
publication_date: 20110125
---
The present invention relates in general to a clipboard protection system in a Digital Rights Management DRM environment and a recording medium for storing a program for executing a clipboard protection method on a computer and more particularly to a clipboard protection system in a DRM environment and a recording medium for storing a program for executing a clipboard protection method on a computer which prevent the leakage of information exceeding allowable rights using a clipboard in a DRM system.

A clipboard refers to a memory space in which data is temporarily stored when any data is copied or pasted to a file executed by an identical application or different applications. The copy and extraction of data using such a clipboard are functions basically provided by an Operating System OS such as Microsoft Windows or Apple Macintosh. The function of copying and extracting data using a clipboard is one of numerous targets that must be managed so as to prevent the leakage of data in a system to which Digital Rights Management DRM is applied. For example when the movement of any data exceeding the allowable right of a user or the movement of data or the like within the DRM system is attempted on a document to which DRM is applied there is a need to block the movement of data related to the document to which DRM is applied.

Referring to the storage of information in a clipboard is performed using interaction among an application a system and global memory. First when the application requests the system to allocate global memory using a GlobalAlloc function S the system provides a handle for the global memory using a Handle function S . Next the application requests the system to lock the global memory using a GlobalLock function S and the system returns the pointer of the allocated global memory in response to the request S . Thereafter the application copies data to the allocated global memory using the returned pointer S . Then the application requests the system to record data in the clipboard by sequentially using functions such as OpenClipboard EmptyClipboard SetClipboardData and CloseClipboard functions S to S and finally requests the system to unlock the global memory using a GlobalUnlock function S . illustrates data stored in the clipboard.

Referring to an operation of extracting information from a clipboard starts at the determination of whether an available clipboard format that can be processed by an application is present in a current clipboard using an IsClipboardFormatAvailable function S . Then the application requests the system to open the clipboard using an OpenClipboard function S . Next the application requests the system to provide data stored in the clipboard using a GetClipboardData function S and the system provides a handle for the data to the application using a Handle function in response to the request S . Next the application requests the system to lock the global memory using a GlobalLock function S and the system returns the pointer of the allocated global memory in response to the request S . Then the application reads data from the allocated global memory using the returned pointer S . Thereafter the application requests the system to unlock the global memory using a GlobalUnlock function S and requests the system to close the clipboard using a CloseClipboard function S .

As described above with reference to the storage and extraction of data in and from the clipboard are performed using Application Programming Interface API functions related to the clipboard between the application and the system and there is a possibility that data stored in the clipboard will leak during such a process. The present applicant proposed a technique for encrypting data or an object to which DRM is applied among pieces of data or objects to be stored in the clipboard and storing the encrypted data in order to prevent the leakage of data in the clipboard and this technique was filed and registered as Korean Patent Registration No. 10 0928467. The patent filed by the present applicant includes a configuration for encrypting and decrypting data when the storage and reading of data in and from the clipboard are performed by a reliable object that is an object to which DRM is applied among various objects thus preventing access to the data by an unreliable object that is an object to which DRM is not applied. In this case the objects are independent targets on which operations for extracting data from the clipboard and pasting the data are performed and primarily denote processes corresponding to respective applications but may be documents sub windows or images text video within the documents which are managed by the respective processes. Even in the following description the term object is used as the same meaning. The patent filed by the present applicant does not block an unreliable object from accessing encrypted data stored in the clipboard and so when clipboard data is requested by an unreliable object encrypted data is provided to the unreliable object. In this case there is a problem in that when encrypted data is output by the unreliable object a program is shut down or an unexpected situation occurs.

An object of the present invention is to provide a system which is capable of preventing the leakage of data to which DRM is applied by using a clipboard in a DRM environment and guaranteeing the free use of the clipboard for data to which DRM is not applied.

Another object of the present invention is to provide a recording medium for storing a program for executing a method which is capable of preventing the leakage of data to which DRM is applied by using a clipboard in a DRM environment and guaranteeing the free use of the clipboard for data to which DRM is not applied on a computer.

In order to accomplish an object of the present invention a preferred embodiment of a clipboard protection system in a DRM environment according to the present invention is provided a clipboard protection system for protecting data stored in a clipboard in conjunction with a clipboard management system for storing extracting and transferring data independently from an application as a basic function of an operating system the clipboard protection system including an identification information management unit for when an object desiring to store data in the clipboard is a reliable object changing first identification information assigned to data to be stored in the clipboard into preset second identification information managing the second identification information and outputting second identification information corresponding to identification information of read target data requested to be extracted when the reliable object requests extraction of data stored in the clipboard a data protection unit for encrypting and outputting data to be stored in the clipboard and decrypting and outputting encrypted data read from the clipboard and a control unit for requesting the clipboard management system to record encrypted security data in the clipboard in conjunction with the second identification information and if a request to extract data stored in the clipboard is received from the reliable object transferring second identification information corresponding to the identification information of the read target data to the clipboard management system and requesting the clipboard management system to read encrypted security data from the clipboard and provide the encrypted security data.

In order to accomplish another object of the present invention a computer readable recording medium for storing a program for executing a clipboard protection method on a computer is provided the method protecting data stored in a clipboard in conjunction with a clipboard management system for storing extracting and transferring data independently from an application as a basic function of an operating system the clipboard protection method including a when an object desiring to store data in the clipboard is a reliable object changing first identification information assigned to data to be stored in the clipboard into preset second identification information b encrypting the data to be stored in the clipboard and c providing second identification information corresponding to the data and the encrypted data to the clipboard management system and then requesting the clipboard management system to record the data in the clipboard.

According to a clipboard protection system in a DRM environment and a recording medium for storing a program for executing a clipboard protection method on a computer in accordance with the present invention when the storage of data in a clipboard is requested by a reliable object the data is stored in the clipboard after the change of identification information of the data and the encryption of the data have been performed and when the reading of data from the clipboard is requested by an unreliable object a data read operation is performed by an existing clipboard management system thus blocking the unreliable object from accessing security data. Further when the reading of data is requested by a reliable object it is determined whether data requested to be read is present by searching a mapping table managed by the clipboard management system and a mapping table managed by the clipboard protection system for both identification information of the data requested to be read and changed identification information thus performing a data read operation without causing any errors.

Hereinafter preferred embodiments of a clipboard protection system in a DRM environment and a recording medium for storing a program for executing a clipboard protection method on a computer according to the present invention will be described in detail with reference to the attached drawings.

Referring to a clipboard protection system according to the present invention is interposed between a reliable object and a clipboard management system and is configured to perform an operation of storing and reading data in and from a clipboard the operation being requested by a reliable object to which DRM is applied. The clipboard management system is a component for performing a clipboard function basically provided by an Operating System OS and performs operations based on clipboard use requests made by an unreliable object to which DRM is not applied and by the clipboard protection system that is a request to store data in the clipboard and a request to read data from the clipboard . The clipboard protection system according to the present invention is basically implemented using an Application Programming Interface API hooking function. Furthermore the clipboard protection system according to the present invention can denote an information processing device such as a computer on which software having a clipboard protection function is loaded. In the system shown in discrimination between a reliable object and an unreliable object is performed by a DRM module not shown for processing DRM and the clipboard protection system discriminate a reliable object from an unreliable object based on the results of processing of the DRM module.

As shown in access to the clipboard by the unreliable object is made by the clipboard management system provided by the operating system and access to the clipboard by the reliable object is made by the clipboard protection system . If the clipboard protection system is implemented using an API hooking function the clipboard protection system is operated together when the DRM module is operated or the operating system runs. Further the determination of whether an object desiring to access the clipboard is a reliable object or an unreliable object is basically performed by the DRM module but such a determination function may also be performed by the clipboard protection system . Furthermore when a reliable object accesses the clipboard the clipboard protection system performs a required procedure by hooking functions related to the clipboard in particular a SetClipboardData function and a GetClipboardData function and thereafter transfers the results of the performance to the clipboard management system .

The clipboard management system stores data in the clipboard in conjunction with data identification information included in a function that commands data to be stored in the clipboard and that is input from the object e.g. a SetClipboardData function provided by the Windows OS or data identification information included in a function that commands data to be stored in the clipboard and that is input from the clipboard protection system . In this case the identification information input from the object is an identifier related to a data format assigned by the object to the data stored in the clipboard and is a standard clipboard format such as CF TEXT CF OEMTEXT or CF UNICODETEXT basically provided by the operating system or a registered clipboard format randomly created and registered by the user. Further the identification information input from the clipboard protection system is identification information obtained by the clipboard protection system changing data identification information included in the function that commands data to be stored in the clipboard and that is input from the object into a registered clipboard format. Meanwhile the clipboard management system reads read target data from the clipboard based on identification information included in a function that commands data to be read from the clipboard and that is input from the object or the clipboard protection system e.g. an IsClipboardDataAvailable function and a GetClipboardData function provided by the Windows OS and provides the read data to the object or the clipboard protection system .

Referring to a preferred embodiment of a clipboard protection system according to the present invention includes an identification information management unit a data protection unit and a control unit .

The identification information management unit changes first identification information uniquely assigned to security data to be stored in the clipboard into preset second identification information. In this case the first identification information may have a standard clipboard format such as CF TEXT CF OEMTEXT or CF UNICODETEXT basically provided by an operating system according to the format of clipboard data or a registered clipboard format randomly created and registered by the user. The identification information management unit changes the first identification information into second identification information which is separate identification information uniquely set by the clipboard protection system . In this case in order for the clipboard management system to recognize the second identification information the second identification information must have the registered clipboard format. Further when a request to read data stored in the clipboard is input the identification information management unit outputs second identification information corresponding to the identification information of the read target data. Meanwhile the identification information management unit may record and manage a corresponding relation between the first identification information and the second identification information in a separate mapping table. This is intended to discriminate between pieces of first identification information and pieces of second identification information corresponding to respective pieces of data when there are a plurality of pieces of data that is security data and key information security data and locale data etc. stored in the clipboard . When the mapping table is generated in this way the identification information management unit functions to search for second identification information corresponding to first identification information input from the control unit and provide the second identification information to the control unit .

For example Microsoft MS Word program to which DRM is applied corresponds to a reliable object. If the MS Word program is executed and a user requests the copying of specific text in a specific document with the specific document opened the Word program performs the operation of storing the corresponding data in the clipboard according to the process shown in in conjunction with the clipboard management system . In this procedure the clipboard protection system according to the present invention hooks a SetClipboardData function that is output from the Word program so as to store data in the clipboard performs the change of identification information and the encryption of the data and then outputs the results of the performance to the clipboard management system . In this case a value set as a variable of the SetClipboardData function by the clipboard protection system is the handle of global memory in which the changed second identification information and the encrypted data are stored. Further the hooking of the clipboard related function output from the Word program may be performed either by a hooking function that is set to be operated in synchronization with the execution of the Word program or the running of the operating system or by the control unit . Once the SetClipboardData function is hooked the identification information management unit changes data identification information e.g. CF TEXT that is a standard clipboard format which is the variable of the SetClipboardData function into separate identification information that has been uniquely set e.g. DRM CR TEXT which is a registered clipboard format .

Meanwhile when the MS Word program that is an application to which DRM is applied is executed and the user requests the reading of data stored in the clipboard with a specific document opened the Word program performs the operation of reading the corresponding data from the clipboard according to the process shown in in conjunction with the clipboard management system . During this procedure the clipboard protection system according to the present invention hooks an IsClipboardData function that is output from the Word program so as to determine whether required data is present in the clipboard and then outputs the same function to the clipboard management system . If a response indicating that the corresponding data is present is received from the clipboard management system the clipboard protection system does not hook a GetClipboardData function that is output from the Word program so as to read data from the clipboard or hooks the GetClipboardData function and outputs the hooked function to the clipboard management system without change. In contrast if a response indicating that the corresponding data is not present is received from the clipboard management system the clipboard protection system hooks the GetClipboardData function that is output from the Word program so as to read data from the clipboard . Then the identification information management unit changes identification information e.g. CF TEXT that is a standard clipboard format which is the variable of the GetClipboardData function into separate identification information that is uniquely set e.g. DRM CR TEXT that is a registered clipboard format .

The data protection unit encrypts and outputs security data to be stored in the clipboard and decrypts and outputs encrypted data read from the clipboard . The data protection unit is operated in conjunction with a DRM module not shown . That is an encryption key required by the data protection unit to encrypt or decrypt data is obtained from the DRM module. Meanwhile information about the encryption key may be added to data stored in the clipboard and may be stored in the clipboard .

The control unit controls the overall operation of the clipboard protection system according to the present invention. That is the control unit hooks an API function related to a request made by a reliable object to store data in the clipboard that is the SetClipboardData function and functions related to a request to read data from the clipboard that is the IsClipboardDataAbailable function and the GetClipboardData function and controls the operation of the identification information management unit and the data protection unit . In particular when the reading of data from the clipboard is requested by the reliable object the control unit hooks the IsClipboardData function output from the reliable object transfers the IsClipboardData function to the clipboard management system without change and performs different procedures depending on the conditions of responses that is the presence or non presence of the corresponding data from the clipboard management system . If a response indicating that the corresponding data is present is received from the clipboard management system the control unit transfers the GetClipboardData function that is output from the reliable object so as to read data from the clipboard to the clipboard management system without change. In contrast if a response indicating that the corresponding data is not present is received from the clipboard management system the control unit requests the identification information management unit to provide second identification information corresponding to identification information that is the variable of the hooked GetClipboardData function. Further the second identification information provided by the identification information management unit is transferred to the clipboard management system to request the clipboard management system to read data stored in the clipboard . illustrates data stored in the clipboard after the change of identification information and the encryption of data have been applied by the clipboard protection system according to the present invention.

Meanwhile the clipboard protection system according to the present invention may additionally store separate key information in the clipboard so as to decrypt encrypted data in addition to the operation of storing data in the clipboard by performing the change of identification information and the encryption of data so as to protect the data. Such key information may be either an encryption key itself or information enabling the encryption key to be obtained. For example the key information may be a distinguished name of a certificate or the identification ID of the certificate when Public Key Infrastructure PKI based encryption is applied may be the pool ID of an encryption key when a key pool is used and may be a key generation factor when Diffe Helman and key exchange encryption using Diffe Helman are applied. Therefore the clipboard protection system assigns preset second identification information to the key information obtained from the DRM module and stores the key information in the clipboard . The obtainment of the key information is performed by a separate key management unit not shown or by the data protection unit and the storage of the key information is performed by the data protection unit . illustrates security data and key information stored in the clipboard by the clipboard protection system according to the present invention.

Furthermore the clipboard protection system according to the present invention may perform the operation of storing format converted additional data in the clipboard in addition to the operation of storing data in the clipboard by changing identification information and encrypting the data so as to protect data. Generally when data having identification information in a format used in the system is input the operating system additionally generates data having identification information in other formats in addition to the input data and stores the generated data together with the input data in the clipboard . For example when data having a CF TEXT format is input the clipboard management system automatically generates data in formats such as CF LOCALE CF OEMTEXT and CF UNICODETEXT based on the CF TEXT information and stores the generated data in the clipboard . However when the security data is encrypted such an automatic change function is not supported. Therefore in order to implement a basic conversion function provided by the operating system while maintaining a data protection function the clipboard protection system converts security data before being encrypted into another type of data assigns preset second identification information to the corresponding data encrypts the corresponding data and stores the encrypted data in the clipboard . The conversion and storage of such data are performed either by a separately provided additional data generation unit not shown or by the data protection unit . illustrates security data key information and additional data stored in the clipboard by the clipboard protection system according to the present invention.

Referring to when a request to store data in a clipboard is received from an application S the DRM module determines whether the application that requested the storage of data is a reliable object or an unreliable object S . If it is determined that the corresponding application is a reliable object the clipboard protection system performs the change of identification information of data and the encryption of the data S . Further the clipboard management system receives the results of the change of the identification information and the encryption of the data and stores the results in the clipboard S . In contrast if it is determined that the corresponding application is an unreliable object the data is directly stored in the clipboard by the clipboard management system without going through the clipboard protection system S .

Referring to when data to be stored in a clipboard is input S the clipboard protection system changes first identification information e.g. CF TEXT which is uniquely assigned to security data to be stored in the clipboard to second identification information e.g. DRM CR TEXT which is preset and then generates a mapping table in which a corresponding relation between the first identification information and the second identification information is recorded S . Next the clipboard protection system obtains a security key from the DRM module based on DRM information set for the security data S . Then the clipboard protection system encrypts the security data to be stored in the clipboard using the security key S . Next the clipboard protection system transfers the second identification information and the encrypted security data to the clipboard management system and the clipboard management system records the encrypted security data in the clipboard in conjunction with the received second identification information S .

Referring to when data to be stored in the clipboard is input S the clipboard protection system determines whether the corresponding data is security data to be protected S . For example when DRM is applied to a Microsoft Word program documents to which DRM is applied and documents to which DRM is not applied may be present among documents loaded on the Word program. In this case documents to which DRM is applied are classified as security data and documents to which DRM is not applied are classified as non security data. If the input data is determined to be security data the clipboard protection system changes first identification information e.g. CF TEXT which is uniquely assigned to the security data to be stored in the clipboard into second identification information e.g. DRM CR TEXT which is preset and generates and manages a mapping table in which a corresponding relation between the first identification information and the second identification information is recorded S . Next the clipboard protection system obtains a security key from the DRM module based on DRM information set for the security data S . Then the clipboard protection system encrypts the security data to be stored in the clipboard using the security key S . Next the clipboard protection system transfers the second identification information and the encrypted security data to the clipboard management system and the clipboard management system records the encrypted security data in the clipboard in conjunction with the received second identification information S . In contrast if the input data is determined to be non security data the clipboard protection system transfers the non security data and the identification information thereof to the clipboard management system . Further the clipboard management system records the plain text non security data in the clipboard in conjunction with the received identification information S .

Referring to when a request to read data stored in the clipboard is received from an application S the DRM module determines whether the corresponding application is a reliable object . If the application is determined to be a reliable object the clipboard protection system determines via the clipboard management system whether the identification information of read target data requested to be read is present S . In response to such determination if a response indicating that the identification information of the read target data is present is received from the clipboard management system S the clipboard protection system transfers the identification information of the read target data to the clipboard management system and the clipboard management system provides plain text data stored in the clipboard to the application S . In contrast if a response indicating that the identification information of the read target data is not present is received from the clipboard management system S the clipboard protection system changes the identification information of the data requested to be read into second identification information and determines whether second identification information corresponding to the read target data is present S . If second identification information corresponding to the read target data is not present S the clipboard protection system outputs the message data absence to the application S . In contrast if second identification information corresponding to the read target data is present S the clipboard protection system transfers the second identification information to the clipboard management system requests the clipboard management system to read data corresponding to the second identification information from the clipboard decrypts the data received from the clipboard management system and provides the decrypted data to the application S .

Meanwhile if it is determined at step S that the application that requested the reading of data is an unreliable object the clipboard protection system transfers the identification information of read target data to the clipboard management system and the clipboard management system determines whether identification information corresponding to the read target data is present S . If identification information corresponding to the read target data is present S the clipboard management system reads the read target data from the clipboard and provides the read data to the application S . In contrast if identification information corresponding to the read target data is not present S the clipboard management system outputs the message data absence to the application S .

Referring to when a request to read data stored in the clipboard is received from an application S the clipboard protection system determines via the clipboard management system whether the identification information of read target data requested to be read is present S . In response to the determination the clipboard management system transfers the results of determining whether identification information corresponding to the read target data is present to the clipboard protection system . If identification information corresponding to the read target data is present S the clipboard protection system transfers the identification information of the read target data to the clipboard management system and requests the clipboard management system to read the data and the clipboard management system reads the read target data from the clipboard and provides the read data to the application S . In contrast if identification information corresponding to the read target data is not present S the clipboard protection system determines via the DRM module whether the corresponding application is a reliable object S . If the application is determined to be an unreliable object the clipboard protection system outputs the message data absence to the application S . In contrast if the application is determined to be a reliable object the clipboard protection system changes the identification information of the data requested to be read into second identification information and determines whether second identification information corresponding to the read target data is present S . If it is determined that the second identification information corresponding to the read target data is present S the clipboard protection system transfers the second identification information to the clipboard management system requests the clipboard management system to read data corresponding to the second identification information from the clipboard decrypts the data received from the clipboard management system and provides the decrypted data to the application S . In contrast if second identification information corresponding to the read target data is not present S the clipboard protection system outputs the message data absence to the application S .

The above described clipboard protection system and method according to the present invention are configured to when the storage of data in a clipboard is requested by a reliable object store the data in the clipboard after the change of the identification information of the data and the encryption of the data have been performed. Further when the reading of data is requested by an unreliable object the operation of reading the data is performed by an existing clipboard management system thus blocking the unreliable object from accessing the security data. In contrast when the reading of data is requested by a reliable object it is determined whether data requested to be read is present by searching a mapping table managed by searching the clipboard management system and a mapping table managed by the clipboard protection system for the identification information of the data requested to be read and changed identification information thus performing a data read operation without causing any errors. Meanwhile in the above described embodiments different operations are performed depending on the type of object that is a reliable object and an unreliable object . However the present invention can also be applied even to lower objects managed by the reliable object e.g. documents loaded by a Microsoft Word program . In this case procedures for determining whether the object is a reliable object and determining whether the lower objects are reliable objects that is whether DRM has been applied are performed either sequentially or simultaneously. Thereafter only in cases where the reliability of the lower objects of the reliable object is guaranteed the change of identification information and encryption of data are performed. Only in cases where a request to read data is received from the lower objects of the reliable object it is determined whether the data requested to be read is present by searching a mapping table managed by the clipboard management system and a mapping table managed by the clipboard protection system for the identification information of the data requested to be read and the changed identification information.

The present invention may be implemented as computer readable code stored in a computer readable recording medium. The computer readable recording medium includes all types of storage devices in which computer system readable data is stored. Examples of the computer readable recording medium are Read Only Memory ROM Random Access Memory RAM Compact Disk Read Only Memory CD ROM magnetic tape a floppy disk and an optical data storage device. Furthermore the computer readable recording medium may be implemented as carrier waves for example in the case of transmission over the Internet . Moreover the computer readable medium may be distributed across computer systems connected via a network so that computer readable code can be stored and executed in a distributed manner.

Although the preferred embodiments of the present invention have been illustrated and described the present invention is not limited to the above described specific preferred embodiments and those having ordinary knowledge in the technical field to which the present invention pertains can make various modifications and variations without departing from the gist of the present invention that is claimed in the attached claims. Such modifications and variations fall within the scope of the claims.

