---

title: Hosted searching of private local area network information with support for add-on application
abstract: Hosted searching of private LAN information is described. The apparatus includes a LAN crawler to automatically and repeatedly crawl a LAN having multiple devices, using a discovery module to discover the devices, a generic-probing module to attempt to collect the descriptive information according to a first set of probing requirements, and multiple specific-probing plug-ins each of which attempt to collect the descriptive information according to a second set of specific probing requirements. In another embodiment, the apparatus also includes a hosted on-demand search system including a centralized-search server to create and synchronize a private search database. The centralized-search server includes an application interface to receive a request to access the private search database from a third-party add-on application, to provide the accessed information to the third-party add-on application, and to receive from the third-party add-on application an application rendered component to be displayed on the user interface.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08285704&OS=08285704&RS=08285704
owner: Citrix Online LLC
number: 08285704
owner_city: Santa Barbara
owner_country: US
publication_date: 20110110
---
The present application is a continuation of U.S. application Ser. No. 11 982 495 filed Nov. 2 2007 the disclosure of which is incorporated by reference herein.

Embodiments of the invention relate to the field of hosted searching and more specifically to the hosted searching of private local area network LAN information.

One method of searching is performed over the World Wide Web WWW . This type of searching is commonly referred to as web searching and is normally performed by a search engine. The term search engine is used to refer to an information retrieval system designed to help find information stored on a computer system. Search engines help to minimize the time required to find information and the amount of information which is subsequently consulted. One type of conventional search engines are Web search engines that search for information on the public WWW. Other types of conventional search engines may include enterprise search engines that search on private intranets personal search engines and mobile search engines. Typically search engines provide an interface to enable users to specify criteria about an item of interest and have the engine find the matching items within the stored information. The items of interest of interest are typically documents and the criteria are the words or concepts that the document may contain. A document as used herein is a bounded physical representation of a body of information designed with the capacity to communicate information. Documents may be digital files in various formats including web pages word processing documents images or the like.

One prior art technique of Web search engine is to use a Web crawler. A web crawler also known as a web spider web robot or web bot is a program or automated script which browses the WWW in a methodical automated manner. This process is called web crawling or spidering. Many search engines uses spidering as a means of providing up to date data. Web crawlers are mainly used to create a copy of all the visited pages for later processing by the search engine that will index the downloaded pages to provide fast searches. A web crawler typically starts with a list of Uniform Resource Locator URL and upon visiting these URLs the web crawler identifies all hyperlinks in the page and adds them to the list of URLs to visit. These URLs can be recursively visited according to a set of policies. By indexing collected documents or metadata about the documents the search engine can provide a set of matching items quickly. For example a library search engine may determine the author of each book automatically and add the author name to a description of each book. Users can then search for books by the author s name. The metadata collected about each item e.g. document is typically stored in the form of an index. The index provides a way for the search engine to calculate the relevance or similarity between the search query and the set of items.

A limitation of this prior art method is that the collected information is a copy of the entire document and the index is organized according to the collected documents such as by the metadata that corresponds to the document. As a result this prior art method has the disadvantages of processing the entire collected documents such as to extract or generate metadata related to the collected documents and organizing the document information e.g. metadata according to documents not according to the items of interest.

Another prior art technique of a personal search engine is to use a desktop search tool. A desktop search tool is a tool that searches the contents of a user s own computer files rather than searching other computers or searching the Internet. These tools are designed to find information about documents on the user s computer including web browser histories e mail archives text documents audio files images video or the like. The search index for the desktop search tool resides on the user s computer. The search index is also organized according to the documents not according to the items of interest.

A limitation of this prior art method is that the desktop search tool only collects information from a user s computer not other computers. Another limitation of this prior art method is that the desktop search tool only collects information on the user s computer and does not discover other devices from which to collect information. As a result this prior art method has the disadvantage of being limited in the types of information sources from which to collect information and the types of information that can be collected.

A method and apparatus for hosted searching of different LAN information is described. In one embodiment an apparatus for hosted searching of different private LAN information includes a LAN crawler to automatically and repeatedly crawl a LAN having multiple devices. The LAN crawler includes a collection module to attempt to collect from across multiple disparate information sources stored in the multiple devices only the parts of the disparate information sources that include descriptive information of a first set of one or more items of interest. The collection module includes a discovery module to discover the devices of the private LAN a generic probing module to attempt to collect the descriptive information according to a first set of probing requirements and multiple specific probing plug ins each of which attempt to collect the descriptive information according to a second set of probing requirements that are specific to each of the specific probing plug ins. In one embodiment one of the specific probing plug ins is configured to attempt to collect the descriptive information according to one or more probing requirements that are specific to an add on application. The LAN crawler also includes a reporting module to automatically report the collected information organized according to the first set of items of interest out of a firewall of the private LAN being crawled and over the Internet.

In another embodiment the apparatus for hosted searching of different private LAN information includes a hosted on demand search system including a set of one or more centralized search servers. The set of one or more centralized search servers includes a crawler interface to receive the reports of different instances of the LAN crawler deployed on the multiple private LANs at least some of which are operated by different entities and a database interface to create and synchronize a separate private search database for each of the private LANs based on the received reports. Each of the private search databases includes the collected information that is not organized by documents located on the private LANs by the first set of items of interest. The set of one or more centralized search servers also includes a server user interface module to provide a user interface over the Internet to the private LAN to perform private searches of the private search database and to provide an application rendered component as part of the user interface. The set of one or more centralized search servers also includes an application interface to receive a request to access the collected information stored in the private search database from a third party add on application to provide the accessed information to the third party add on application and to receive from the third party add on application an application rendered component to be displayed on the user interface.

The following description describes methods and apparatus for hosted searching of different private LAN information. In the following description numerous specific details such as logic implementations opcodes operations hardware of software modules code and types and interrelationships of system components are set forth in order to provide a more thorough understanding of the present invention. It will be appreciated however by one skilled in the art that the invention may be practiced without such specific details. In other instances control structures gate level circuits and full software instruction sequences have not been shown in detail in order not to obscure the invention. Those of ordinary skill in the art with the included descriptions will be able to implement appropriate functionality without undue experimentation.

References in the specification to one embodiment an embodiment an example embodiment etc. indicate that the embodiment described may include a particular feature structure or characteristic but every embodiment may not necessarily include the particular feature structure or characteristic. Moreover such phrases are not necessarily referring to the same embodiment. Further when a particular feature structure or characteristic is described in connection with an embodiment it is submitted that it is within the knowledge of one skilled in the art to affect such feature structure or characteristic in connection with other embodiments whether or not explicitly described.

In the following description and claims the terms coupled and connected along with their derivatives may be used. It should be understood that these terms are not intended as synonyms for each other. Rather in particular embodiments connected may be used to indicate that two or more elements are in direct physical or electrical contact with each other. Coupled may mean that two or more elements are in direct physical or electrical contact. However coupled may also mean that two or more elements are not in direct contact with each other but yet still co operate or interact with each other.

A method and apparatus for hosted searching of private LAN information is described. In one embodiment an apparatus for hosted searching of private LAN information includes a LAN crawler to automatically and repeatedly crawl a LAN having multiple devices and a hosted on demand search system including a set of one or more centralized search servers. The LAN crawler includes a collection module to attempt to collect from across multiple disparate information sources stored in the multiple devices only the parts of the disparate information sources that include descriptive information of a first set of one or more items of interest. In one embodiment the collection module includes a discovery module to discover the devices of the private LAN a generic probing module to attempt to collect the descriptive information according to a first set of probing requirements and multiple specific probing plug ins each of which attempt to collect the descriptive information according to a second set of probing requirements that are specific to each of the specific probing plug ins. In one embodiment one of the specific probing plug ins is configured to attempt to collect the descriptive information according to one or more probing requirements that are specific to an add on application. In another embodiment the LAN crawler includes a reporting module to automatically report the collected information organized according to the first set of items of interest out of a firewall of the private LAN being crawled and over the Internet. In another embodiment the LAN crawler includes an organization module to automatically organize the collected information according to the first set of items of interest.

In another embodiment the set of one or more centralized search servers includes a crawler interface to receive the reports of the LAN crawler deployed on the private LAN and a database interface to create and synchronize a private search database for the private LAN based on the received reports. The private search database includes the collected information that is not organized by documents located on the private LAN but by the first set of items of interest. In another embodiment the set of one or more centralized search servers also includes a server user interface module to provide a user interface over the Internet to the private LAN to perform private searches of the private search database and to provide an application rendered component as part of the user interface. In another embodiment the set of one or more centralized search servers also includes an application interface to receive a request to access the collected information stored in the private search database from a third party add on application to provide the accessed information to the third party add on application and to receive from the third party add on application an application rendered component to be displayed on the user interface.

The multiple devices may include a server a directory server a workstation a network printer a switch a router or other electronic devices that can be part of a private LAN. Also deployed on the private LANs and are LAN crawlers respectively. A LAN crawler is an automated script which explores the devices of each of the private LANs in a methodical automated manner. The LAN crawler automatically and repeatedly crawls the devices of the private LAN to collect from across multiple disparate information sources stored on the devices descriptive information of items of interest. The LAN crawler collects from multiple disparate information sources only those parts of the disparate information sources that include descriptive information of the first set of items of interest instead of copying the entire information source. The LAN crawler of each of the private LAN may be deployed on a client device such as a client workstation. Alternatively the LAN crawler may be deployed on one of the devices of the private LAN. In one embodiment the LAN crawler and the UI for each of the private LANs resides on the same client device. Alternatively the LAN crawler and UI for each of the private LANs may reside on separate devices. It should be noted that the LAN crawler is different from a web crawler also referred to as a web spider web robot or web bot which is a program or automated script which browses the World Wide Web in a methodical automated manner in order to create a copy of all the visited pages for later processing by a search engine that indexes the downloaded pages.

Although only illustrated in the LAN crawler each of the LAN crawlers and includes a collection module and a reporting module . The collection module attempts to collect from across each of the disparate information sources the descriptive information of the items of interest. In one embodiment the descriptive information is collected from a single information source. In another embodiment the descriptive information is collected from multiple information sources. The reporting module automatically reports the collected information. In one embodiment the reporting module automatically reports the collected information organized according to the items of interest out of a firewall of the private LAN being called and over the Internet. In one embodiment the reporting module is configured to send the reports periodically over the Internet. In another embodiment the reporting module is configured to send the information once collected. Alternatively the reporting module may be configured to send the report on a scheduled basis. In one embodiment the reports include corresponding time stamped data with the collected information to indicate the time at which the information is collected. Alternatively the reports do not include time stamped data.

In another embodiment each of the LAN crawlers also includes an organization module . The organization module automatically organizes the collected information according to the items of interest. In one embodiment the collection module attempts to collect the descriptive information through a set of one or more organize questions to the devices of the private LAN being crawled. In response to the set of one or more organize questions the collection module receives values from the devices including the descriptive information of the items of interest. In one embodiment the organized questions are request inquiries with defined names that extract values that correspond to the defined names. The defined names and corresponding values are name value pairs that can be stored in the private search database . When the collection module asks the questions in an organized manner the collected information is implicitly organized for the reports that are sent by the reporting module . For example it may be important to know the different between a computer named Tetris and installed software name Tetris. Because the LAN crawler knows how it collected the information for each item e.g. using the organized questions including how to identify the computer which has the name the network to which that computer belongs and the identity of the computer which has the software installed the two items similarly named items can be distinguished by its organization in the collected information. Similarly the collected information may be stored in the private search database using this organization. In another embodiment the collection module collects information that is not implicitly organized and sends the unorganized information to the organization module to be organized for the reports that are sent by the reporting module . In either case the reporting module generates one or more reports to send to the collected information to the hosted on demand search system .

The hosted on demand search system which is coupled to the network e.g. Internet includes a set of one or more centralized search servers one centralized search server has been illustrated. The centralized search server includes a private search database that corresponds to each of the private LANs. For example the centralized search server includes private search databases and which correspond to private LANs and respectively. A search database is a collection of records or data that is stored in a data repository of a computer system so that a computer program or person using a search query language can consult it to answer search queries. The centralized search server includes a database interface which creates and synchronize the separate private search databases and for each of the private LANs and respectively.

In one embodiment the database interface is a database management system DBMS which is used to manage and query the search database. In one embodiment the database interface is implemented in code. The central concept of a database is that of a collection of records or pieces of information. Typically for a given database there is a structural description of the type of pieces of information held in that database this description is known as a schema. The schema describes the objects that are represented in the database and the relationships among them. There are a number of different ways of organizing a schema that is of modeling the database structure these are known as database models. There are various types of database models such as for example relational models flat models hierarchical models network models object relational models object models entity relationship models associative models concept oriented models entity attribute value models semi structured models extensible markup language XML database models or the like. The model in most common use is the relational model which represents all information in the form of multiple related tables each including rows and columns. This model represents relationships by the use of values common to more than one table. Other models such as the hierarchical model and the network model use a more explicit representation of relationships. The hierarchical model is organized into a tree like structure. The structure allows repeating information using parent child relationships each parent can have many children but each child only has one parent. In one embodiment the private search databases and is a hierarchical database as described in more detail below. Alternatively in other embodiments the private search databases and are other types of databases.

Each of the private search databases and includes the collected information which is collected from across the disparate information sources of a private LAN being crawled. The collected information in each of the private search databases and is organized according to the items of interest and not by documents located on the private LANs. It should be noted conventional search engines organize the collected information according to the collected documents not the items of interest.

The centralized search server also includes a crawler interface that receives the reports from the reporting module of the different instances of the LAN crawler e.g. and deployed on the different private LANs and . The crawler interface distinguishes the reports from the different instances of the LAN crawler deployed on the different private LANs to identify in which private search database a particular report is to be stored and sends the distinguish reports to the database interface to be stored in the identified search database e.g. search databases and . In one embodiment the crawler interface distinguishes the reports by sending an identifier of the received report to a configuration database and receives the identified search database that corresponds to the identifier from the configuration database . The identifier identifies the entity that operates the particular LAN from which the report was received. The identifiers for each of the private LANs may be inserted into the reports by the respective LAN crawler.

The centralized search server also includes a server user interface UI module that is coupled to the database interface crawler interface and configuration database . The server UI module is configured to provide a user interface over the Internet to each of the private LANs and to allow users to perform private searches of their corresponding private search database and respectively. In one embodiment the server UI module receives a search query from a user of the private LAN to perform a private search of the corresponding private search database . These servers UI module performs a search in the search database through the database interface using the search query. In one embodiment the server UI module is configured to store the search query in the configuration database for later retrieval by the user. The user may designate the search query as being shareable. When the search query is designated as shareable the server UI module stores the search query but not the search results of the private search and designates the saved search query as shareable allowing for display and selection of the shareable search query on the user interfaces and of the private LANs and respectively. However when the search query is not designated as shareable the server UI module stores a search query and only allows for display and selection of the stored search query on the user interface of the private LAN from which the search query originated.

The centralized search server also includes the configuration database that is coupled to the crawler interface and the server user interface module . In addition to storing the search queries as described above the configuration database may also store authentication information for access by the user interfaces and . The configuration database also stores the identifiers to identify the source of the received reports in order to distinguish each of the reports for each of the private LANs from which the reports originated. Table 1 includes exemplary types of information that are stored in the configuration database .

Also the configuration database may also store other types of information such as saved search queries and search histories. The saved search query may be saved by a user and optionally designated as shareable to be shared with other users of other private LANs. It should be noted that although a search query is designated as shareable only the saved search queries are shared not the search results from the saved search queries. The search history type information includes search histories for each of the users. It should be noted that Table 1 includes exemplary types of information that may be stored in the configuration database but in other embodiments the database may store other types of information.

In another embodiment the hosted on demand search system includes a classification server coupled to a classification database . The classification server may attempt to identify devices that are discovered on the private LANs and . The classification server is configured to compare the collected information of the private search databases and against predetermined characteristics of own devices stored in the classification database and to compute a classification metric for the multiple devices of the private LAN and . For example the classification server may evaluate the collected information by comparing the collected information against fingerprints of known devices stored in the classification database comparing the media access control MAC address of the collected information to ranges of MAC addresses for known devices stored in the classification database or the like. Then using either the fingerprint comparison or the MAC address lookup or both classification server determines a classification for the discovered devices of the private LANs and . The classification server can evaluate the collected information and determine a classification for the discovered devices and notify the administrator of the private LAN of the device classification or modify the collected information in the private search database to include the device classification. By using the classification server and classification database it is possible to collect information from many different networks and thus a large set of different devices. It is also possible to classify an unknown discovered device on the private LAN especially when the LAN crawler deployed on the private LAN is unable to report certain classification information e.g. vendor model or the like to the hosted on demand search server . In one embodiment the classification server and classification database are the classification server and classification database developed by Network Chemistry of Palo Alto Calif. The classification server and classification database developed by Network Chemistry may be implemented according to the various embodiments described in U.S. patent application Ser. No. 11 803 004 filed May 10 2007 entitled Collaborative Device Classification. Alternatively the classification server and classification database are other types of classification servers and classification databases. The distribution module is configured to distribute copies of the LAN crawler to be installed on devices. For example through the user interface a user visiting a website hosted by the company or organization that manages the hosted on demand search system may click on a link to download the LAN crawler to the user s computer to be installed and executed.

In one embodiment the collection module of the LAN crawler includes a discovery module and a probing module . The discovery module automatically discovers the devices of the private LAN being crawled by the LAN crawler . The probing module attempts to collect data on each of the information sources stored in the discovered devices of the private LAN . The probing module may be configured to collect data from information sources according to a set of probing requirements. The set of probing requirements may include a set of one or more organized questions. The collection module asks the set of one or more questions of the information sources of the devices and receives values in response to the set of organized questions from the information sources . The values include descriptive information regarding the items of interest. In another embodiment the set of probing requirements may include other types of requests to collect information from the devices . As described above when the collection module asks organized questions the LAN crawler may not need an organization module to organize the collected information according to the items of interest since the collected information is implicitly organized by the use of organized questions. Alternatively the LAN crawler may include an organization module that organizes the collected information according to the items of interest before being reported over the Internet by the reporting module .

In one embodiment the LAN crawler is coupled to a data store e.g. a memory a database or the like in which the LAN crawler stores configuration information for the particular LAN crawler . In one embodiment the configuration information may include the set of probing requirements for the LAN crawler such as a set of one or more organized questions. Alternatively the configuration information stored in the data store includes additional LAN crawler configuration information. In another embodiment the LAN crawler configuration for each of the LAN crawlers is stored in the configuration database .

In general the LAN crawler discovers devices on the private LAN and collects information from the discovered devices . The LAN crawler collects from across multiple disparate information sources stored in the devices only those parts of the disparate information sources that include descriptive information of the first set of items of interest. In one embodiment for at least one item of interest the parts are collected from multiple disparate information sources. In one embodiment the LAN crawler is deployed on the client device . For example the LAN crawler can be software operating on a processor of the client device .

In one embodiment the descriptive information of the first set of items of interest include in general technical information regarding the private LANs and user of the private LANs and and the multiple devices of each of the private LANs and . Each of the LAN crawlers and is configured to collect values of the technical information from the multiple information sources stored on the devices through a set of one or more organized questions to the devices of the private LAN being crawled.

Information Technology IT or Information and Communications Technology ICT as defined by the Information Technology Association of America ITAA is the study design development implementation and support or management of computer based information system particularly software applications and computer hardware. IT deals with the use of electronic computers and computer software to convert store protect process transmit and retrieve information securely. IT professionals such as network administrators perform a variety of duties that range from installing applications to designing complex computer networks and information databases such as data management networking engineering computer hardware database and software design as well and the management and administration of entire systems or networks. In one embodiment the technical information is IT information that is used by an IT professional in performing a variety of duties such as those described above for the study design development implementation and support or management of computer based information systems particularly software applications and computer hardware. Some examples of descriptive IT information include but are not limited to information in configuration files in routers switches firewalls asset lists information in Lightweight Directory Access Protocol LDAP servers described below personal computer configuration information in a registry a Windows Management Instrumentation WMI database described below and or a directory physical and logical network topology information flow information raw packet contents log information from all devices networks and systems. Alternatively the descriptive information of the first set of items of interest may include other types of information other than technical information such as financial information enterprise information or the like.

Network and host security solutions and network management applications are specialized repositories of information that operate independently and without information sharing. More advanced technology leads to more specialization which makes it even more difficult to share information between systems or devices. Attempts to integrate this information such as security information managers SIM or configuration management databases CMDB lead to even more specialization as they limit the resolution of information that they will receive and process e.g. only receiving alerts from support intrusion detection systems IDSs which detects unwanted manipulations to systems or only parsing configuration from supported routers. The embodiments described herein may allow a user to more easily find technical information such as network management information and relationships within and between disparate systems or devices which may help the user to solve network management and security problems. The embodiments described herein may also allow a user to find related items of interest even when the items of interest originate from disparate information sources such as devices employing different data models. A data model is an abstract model that describes how data is represented and used.

More specifically in other embodiments the technical information may include information regarding existence of the devices within each of the private LANs and . The devices may include one or more routers one or more switches one or more servers one or more directory servers one or more workstations or the like. The technical information may also include information regarding existence of multiple hardware modules within each of the devices states of the hardware modules properties of the hardware modules configuration of the hardware modules history of the hardware modules. The technical information may also include information regarding existence of any peripherals coupled with the devices states of the peripherals properties of the peripherals configuration of the peripherals history of the peripherals. The technical information may also include information regarding existence of at least one operating system operating within each of the devices state of the operating systems properties of the operating systems configuration of the operating systems history of the operating systems. The technical information may also include information regarding existence of software within each of the devices state of the software properties of the software configuration of the software history of the software. The technical information may also include information regarding presence of users using each of the devices an inventory of users that are authorized to use each of the devices policies assigned to the users for each of the devices and history of each user s actions regarding each of the devices .

For example in one embodiment of the invention the data stored in the private search database includes information regarding substantially all devices within a private LAN a list of software installed on those devices and a list of users authorized to use those devices. Additionally the data stored may include information regarding the operating system version installed on substantially all devices within the private LAN the software which is running on substantially all devices within the private LAN and a configuration file from at least one router switch or firewall within the private LAN. The devices may include substantially all workstations within a private LAN substantially all routers within the private LAN substantially all switches within the private LAN substantially all servers within the private LAN substantially all firewalls within the private LAN and substantially all directory servers within the private LAN.

The disparate information sources may include for example a routing table of a router a router configuration file of a router an ARP table of a switch a bridging table of a switch a switch configuration table of a switch a software configuration file of a server a resource utilization counter of a server a log file of a server custom application file of a server user information of a directory server group information of a directory server a software configuration file of a workstation a registry of a workstation an operating system interface database of a workstation a directory of a workstation a resource utilization counter of a workstation a log file of a workstation a configuration file of a network printer or the like. Alternatively other technical information may be collected from other types of information sources than those listed above.

In another embodiment the technical information is collected from the registry of a device running the WINDOWS operating system available from Microsoft . In another embodiment the technical information is collected from a WMI database of a device running Microsoft WINDOWS. In another embodiment the technical information is collected from the proc directory of a device running a UNIX like operating system e.g. Linux . In another embodiment the technical information is collected from a directory service e.g. residing on a directory server using LDAP. LDAP is an application protocol for querying and modifying directory services running over Transmission Control Protocol and Internet Protocol TCP IP . LDAP tends to use DNS names for structuring the objects of the directory service. In another embodiment the technical information is collected from a networking device for example a router or a switch using the Simple Network Management Protocol SNMP Telnet Secure Shell SSH protocols or the like. In another embodiment the technical information is collected from a network printer using SNMP or the like. Alternatively the technical information may be collected from other devices that are part of the private LAN.

In one embodiment the technical information is collected by the LAN crawler asking a set of one or more organized questions of the disparate information sources described above which are stored in the devices of the private LAN being crawled. In response to the set of organized questions the LAN crawler receives values of the technical information from the disparate information sources stored on the devices .

There are several techniques that may be employed to discover the devices on the private LAN. These techniques fall generally into two main categories passive traffic collection and active scanning.

Passive traffic collection entails operating in a promiscuous mode in order to observe all broadcast and non broadcast network traffic such as Ethernet traffic. In this technique device MAC addresses are gathered and the source IP address is recorded if the packet in question is an IP or address resolution protocol ARP packet. For active scanning the following techniques can be used 1 ARP Scanning 2 Ping Scanning and 3 CAM Table Scanning.

In ARP Scanning the local network segment is probed by issuing ARP requests to each possible IP address within the system s broadcast domain. The upper and lower bounds for the addresses to query are determined by examining the network and broadcast addresses of the network adapter used by the LAN crawler to perform the scanning activity. If an ARP reply is received then a device at the queried IP address exists.

Ping Scanning involves sending an Internet Control Message Protocol ICMP echo request a Ping packet to a single IP address or a range of addresses. If a device is utilizing one of the IP addresses to which a Ping was sent the device responds with an ICMP echo reply packet. Thus it can be determined if a device exists at an arbitrary IP address.

Cam Table Scanning involves interrogating the network s switching infrastructure for the MAC addresses of the devices connected to it. This may be done via SNMP. This enables the LAN crawler to quickly gather MAC addresses for all devices on the private LAN without the need for the LAN crawler to be on the same network segment. As described above the classification server is configured to classify the devices . For example the organizationally unique identifiers OUIs which form the first 24 bits of the MAC address can be compared against those that belong to a particular manufacture. For example the OUI of the MAC address can be compared with those that belong to a manufacture of wireless or wired access points APs .

Some other techniques that can be used to collect information about the devices of the private LAN are for example 

Additionally the device s manufacturer may be determined by the OUT of its MAC address. This information is gathered during normal network communication with the device .

In one embodiment the LAN crawler is configured to collect the same information as described in the U.S. patent application Ser. No. 11 803 004 filed May 11 2006 entitled Collaborative Device Classification. In another embodiment the LAN crawler is configured to collect the same similar and or dissimilar information than the information described in the U.S. patent application Ser. No. 11 803 004. For example in addition to or in place of the information collected by the scan agent the LAN crawler is configured to attempt to collect information from other types of information sources such as a WMI database.

A WMI database is a type of operating system interface database. WMI specifically is a set of extension to the WINDOWS Driver Model that provides an operating system interface through which instrumented components provide information and notification. WMI allows scripting languages like VBScript or WINDOWS POWERSHELL available from Microsoft to manage personal computers and servers that are running WINDOWS both locally and remotely. The contents of the WMI database may include make and model information for the hardware of the device hardware configuration of the device technical support ID information list of installed programs information about logged in users information about running programs and or resource utilization information e.g. CPU memory and disk utilization .

In addition to collecting information from a WMI database the LAN crawler is configured to collect information from other operating system interface databases such as Web Based Enterprise Management WBEM and Common Information Model CIM standards available from the Distributed Management Task Force DMTF .

In one embodiment the LAN crawler collects descriptive information from the router using SNMP. Alternatively the LAN crawler may collect the descriptive information from the router using other protocols such as Telnet SSH protocols or the like.

In this embodiment the switch includes an Address Resolution Protocol ARP table a bridging table and switch configuration . A switch also referred to as a network switch is a computer networking device that connects network segments. Network switches are capable of inspecting data packets as they are received determining the source and destination device of that packet and appropriately forwarding the packet to the intended connected device. Switches of private LANs are known to those of ordinary skill in the art and accordingly a detailed description regarding switches has not been included so as to not obscure the embodiments of the present invention. The ARP table is a table used for finding a host s hardware address when only the host s network layer address is known. ARP is a standard method for resolving many different network layer protocol addresses to hardware addresses and may be used to translate IP addresses to MAC addresses. The ARP table may also include information regarding Token Rings Fiber Distribution Date Interface FDDI IEEE 802.11 IP over ATM or the like. The switch configuration may store other configuration information related to the switch .

In one embodiment the LAN crawler collects descriptive information from the switch using SNMP. Alternatively the LAN crawler may collect the descriptive information from the switch using other protocols such as Telnet Secure Shell SSH protocols or the like.

In this embodiment the server includes various disparate information sources such as software configuration files resource utilization counters log files and custom application files . The software configuration files may include information regarding the software that is installed and or running on server for example the type and version of the operating system and or the types and versions of other types of software. It should be noted that the software configuration information may be stored in other information sources than software configuration files.

The resource utilization counters may include the actual resource utilization values of the server . The resource utilization may include for example central processing unit CPU performance of one or more processors input output I O performance memory performance or the like. The resource utilization counters may be hardware performance counters also referred to as hardware counters which are a set of special purpose registers of a processor to store the counts of hardware related activities within the computer system. Alternatively the resource utilization counters may be software performance counters that read the values from set of special purpose registers of the processor. Alternatively the resource utilization values may be stored in log files WMI database or in other types of files stored on the sever .

The log files may include time based log information of the server . The time based log information may be sequentially or chronologically recorded in the log files . The log files may include recorded events to provide an audit trail that can be used to diagnose problems. For example some operating systems provide a syslog service which allows the filtering and recording of log message to be performed by a separate dedicated subsystem rather than each application recording log message. Syslog is a standard for forwarding log message in an IP network. The syslog service can be used to integrate log data from many different types of systems into a central repository.

The custom application files may include information regarding applications that are currently installed and or running on the server . In one embodiment custom applications can be developed for exclusive use by the server . The custom application file may include information that is specific to custom applications. For example a Manufacturing Resource Planning MRP application may provide the number of transactions per section it is processing through an application interface API . The LAN crawler could collect specific information such as transactions per second from the MRP application through an API.

In one embodiment the LAN crawler collects descriptive information from the server using Hypertext transfer protocol HTTP . Alternatively the LAN crawler may collect the descriptive information from the server using other protocols such as Representational State Transfer REST Remote Procedure Call RPC Simple Object Access Protocol SOAP SNMP SSH WMI COBRA Distributed Component Object Model DCOM or the like.

In this embodiment the directory server is an information source that includes user information and or group information . The directory server may be a device that executes one or more software applications that store and organize information about users groups of users and or network resources. The directory server may be used by a network administrator to manage users access to the resources. The directory server may also store a directory database that holds information about names to objects that are managed in the directory service. The directory server may store such information as for example names of users names of groups of users permission sets associated with the users permission sets associated with the groups of users or the like. The directory service may be a shared information infrastructure for locating managing administrating and organizing common items and network resources which can include volumes folders files printers users groups devices telephone numbers and other objects. For example the directory service may be used to obtain a list of available computers and the information for accessing them. The directory server may also define the namespace for the network. A namespace a namespace in this context is the term that is used to hold one or more objects as named entries. The directory service has a set of rules that determine how network resources are named and identified. The rules specify that the names be unique and unambiguous. The name is called the distinguished name DN and is used to refer to a collection of attributes such as relative distinguished names which make up the name of a directory entry.

In one embodiment the LAN crawler collects descriptive information from the directory service on the directory server using LDAP. Alternatively the LAN crawler collects descriptive information from the directory server using other protocols such as protocols used in Active Directory Remote Authentication Dial In User Service RADIUS or the like. Active Directory is an implementation of directory services for use with devices running WINDOWS operating system. Active Directory may provide central authentication and authorization services for WINDOW based computers and may allow administrators to assign policies deploy software and apply updates to an organization. Active Directory stores information and settings in a central database. The RADIUS protocol is an authentication authorization and accounting protocol for applications such as network access or IP mobility.

In this embodiment the first workstation includes various information sources such as software configuration files resource utilization counters log files directories e.g. proc directory of the first workstation . The first workstation is a device that is running a UNIX or UNIX like operating system such as Linux. A UNIX like operating system is one that behaves in a manner similar to a UNIX system while not necessarily conforming to or being certified to any version of the Single UNIX specification. The software configuration files may include information regarding the software that is installed and or running on first workstation for example the type and version of the operating system e.g. Linux and or the types and versions of other types of software as described above with respect to the software configuration files . The resource utilization counters may include the actual resource utilization values of the first workstation as described above with respect to the resource utilization counters . The log files may include time based log information of the first workstation as described above with respect to the log files .

 The directories may include for example the proc directory. The proc directory is a file or a directory of files containing information about all the CPUs and memories in the system such as the numbers used to identify each logical CPU the vender identifications used to identify the CPU manufacturer the numbers given to identify the CPU family or manufacturing process information about the current state of the system s computer memory including virtual memory and the cache or the like. On workstations that are running Linux the proc directory may substitute or compliment information contained in the resource utilization counters .

In one embodiment the LAN crawler collects descriptive information from the first workstation using SSH. Alternatively the LAN crawler may collect the descriptive information from the first workstation using other protocols such as telnet SNMP syslog HTTP or the like.

In this embodiment the network printer includes various information sources such as a configuration file software configuration files resource utilization counters log files or the like. The software configuration files resource utilization counters log files are similar to those described above with respect to the server and first workstation . The configuration file includes information about the network printer such as the name of the network printer the IP address of the network printer configuration settings of the network printer or the like.

In one embodiment the LAN crawler collects descriptive information from the network printer using SNMP. Alternatively the LAN crawler may collect the descriptive information from the network printer using other protocols such as HTTP Telnet or the like.

In this embodiment the second workstation includes various information sources including registry WMI database software configuration files resource utilization counters and log files . Registry is a directory which stores setting and options for the operating system. The registry may contain information and settings for all the hardware operating system software most non operating system software users preferences of the device e.g. personal computer PC or the like. For example registry is the Microsoft Registry for the WINDOWS operating system. Whenever a user makes changes to settings file associations system policies or installed software the changes are reflected and stored in the registry . The registry also provides a window into the operation of the kernel exposing runtime information such as performance counters and currently active hardware. In another embodiment the information that is obtained from the registry may also be obtained from other non Windows mechanisms such as Sysfs and procfs which expose runtime information through the file system.

As described above the WMI database is a type of operating system interface database. The contents of the WMI database may include make and model information for the hardware of the device hardware configuration of the device technical support ID information list of installed programs information about logged in users information about running programs and or resource utilization information e.g. CPU memory and disk utilization .

In another embodiment the WMI database may be other operating system interface databases such as Web Based Enterprise Management WBEM and Common Information Model CIM standards from the Distributed Management Task Force DMTF or the like.

The software configuration files may include information regarding the software that is installed and or running on second workstation for example the type and version of the operating system e.g. WINDOWS and or the types and versions of other types of software as described above with respect to the software configuration files . The resource utilization counters may include the actual resource utilization values of the second workstation as described above with respect to the resource utilization counters . The log files may include time based log information of the second workstation as described above with respect to the log files .

In one embodiment the LAN crawler collects descriptive information from the second workstation using WMI. Alternatively the LAN crawler may collect the descriptive information from the second workstation using other protocols such as server message block SMB DCOM SNMP or the like.

The reorganization module includes a report scanning module an integration module and a renaming module . The report scanning module is configured to attempt to collect from across the disparate reports received from the private LAN being crawled descriptive information of other items of interest also referred to as second set of one or more items of interest . The integration module is configured to integrate the collected descriptive information that is organized according to the second set of items of interest into the corresponding private search database . The integration module can extract descriptive information of the second set of items of interest from the reports that include the descriptive information of the first set of items of interest and integrate the extracted information into the private search database to be organized according to the second set of items of interest in addition to or in place of the descriptive information that is organized according to the first set of items of interest when received from the crawler interface . For example TABLE 3 includes exemplary second set of items of interest that can be created from the first set of items of interest received in the reports from the LAN crawlers.

In other embodiments other types of second set of items of interest can be created from the first set of items of interest received in the reports from the LAN crawlers.

In another embodiment the report scanning module and the integration module are used to reorganize the collected information according to a different organization such as organized according to the created items of interest that are derived from the first set of items of interest.

The renaming module is configured to rename similar items having different terminology to have a common terminology for searching purposes. The report scanning module attempts to identify from among the first set of items of interest received in the reports similar items having different terminology. The renaming module renames the similar items to have the common terminology. The integration module integrates the collected information of the reports and the renamed similar items into the corresponding search database . For example a workstation running WINDOWS may include a network adapter to communicate with other devices while a workstation running Linux may include a network interface to communicate with other devices. When searching the private search database a user may provide a search query for all network interfaces of the private LAN to be displayed to show the available network interfaces or network adapters that communicate with other devices. Without reorganizing the collected information using the renaming module the search results may not include the network adapters even though the user intended the search query to include the network adapters. The renaming module can rename the collected network adapter information to be named as network interfaces or vice versa. Also in other embodiments the renaming module does not replace the name of the collected information but adds additional information to the collected information. So for the example above the network interface and network interface objects can be modified to include both values as network interface and network interface. Alternatively the renaming module may rename the collected information to include a class identifier that identifies for example both network interface and network interface. Alternatively the report scanning module integration module and renaming module may be used to otherwise reorganize the collected information to be separately stored in the private search database or in place of the collected information in the private search database .

In another embodiment the report scanning module the integration module and renaming module are used to reorganize the collected information as described above such as according to the first set of items of interests and or according to the second set of items of interest however the reorganized information of this embodiment may include common terminology for similar items of the disparate information sources having different terminologies.

In one embodiment in order to create network topology information information is collected from bridging tables from switches of the private LAN . For example the LAN crawler is configured to access the bridging table of the switch illustrated in . The LAN crawler can access the bridging table using SNMP SSH protocol or the like. In addition the LAN crawler can access information from the routing tables of the routers of the private LAN for example from the routing table of router illustrated in . Using the information from the bridging tables and or routing tables information about the network topology can be created and integrated into the collected information stored in the private search database . The network topology information may be separately stored in the private search database for later retrieval by the user when the user wishes to analyze the network topology of the private LAN. In addition to obtaining the information from the bridging and routing tables in another embodiment device names may be retrieved form the DNS server using reverse DNS lookups using the IP addresses. As such the IP addresses can be linked to the device names. The device names may also be stored in addition to or in place of the previously collected information stored in the private search database . In another embodiment information regarding the device types can be obtained for example by receiving responses to probes to open ports. Alternatively other types of information may be collected to create the network topology information.

The operations of this and other flow diagrams will be described with reference to the exemplary embodiments of the other diagrams. However it should be understood that the operations of the flow diagrams can be performed by embodiments of the invention other than those discussed with reference to these other diagrams and the embodiments of the invention discussed with reference these other diagrams can perform operations different than those discussed with reference to the flow diagrams.

The techniques shown in the figures can be implemented using code and data stored and executed on one or more computers. Such computers store and communicate internally and with other computers over a network code and data using machine readable media such as machine storage media e.g. magnetic disks optical disks random access memory read only memory flash memory devices and machine communication media e.g. electrical optical acoustical or other form of propagated signals such as carrier waves infrared signals digital signals etc. . In addition such computers typically include a set of one or more processors coupled to one or more other components such as a storage device a number of user input output devices e.g. a keyboard and a display and a network connection. The coupling of the set of processors and other components is typically through one or more busses and bridges also termed as bus controllers . The storage device and network traffic respectively represent one or more machine storage media and machine communication media. Thus the storage device of a given computer system typically stores code and data for execution on the set of one or more processors of that computer. Of course one or more parts of an embodiment of the invention may be implemented using different combinations of software firmware and or hardware.

In the embodiment above two organized questions and were asked of one or more LAN devices . In other embodiments more or less organized questions may be asked of one or more LAN devices . The reports may include one or more organized questions and corresponding value s . In one embodiment the reports are sent periodically over the Internet to the hosted on demand search system . In another embodiment the reports are sent once they are integrated with a set of one or more organized questions and corresponding values. Alternatively the reports may be sent on a scheduled basis. The collected information may be stored temporarily and independently of or as part of the report in memory before sending the report to the hosted on demand search system such as in the data store .

Once the user has been authenticated the user interface can receive a search query from the user operation . illustrates a search GUI of a user interface page on the user interface that includes a first interface widget to receive a search query from the user operation . Once the user has typed in the search query the user may then select or otherwise activate a second interface widget to send the search query to the hosted on demand search system operation . The server user interface module receives the search query and processes the search query operation . The operation may include sending the search query to the database interface to perform a private search in the corresponding search database that corresponds to the private LAN from which the user originated the search request. The database interface returns the search results to the server user interface module . The server user interface module may generate the user interface page including include the search results for the search GUI . The server user interface module sends the generated user interface page including the search results to the client device to be displayed operation . The client device then displays the user interface page including the search results as part of the search GUI operation . In one embodiment the search results are displayed to look like search results from typical web search engines such as with a small snippet of information including the context for the matching fields. Alternatively the search results may be displayed in other ways.

In one embodiment the search query is used to retrieve aggregate values such as the number of devices which are in a wireless access point class e.g. wifi ap . In another embodiment the search query is used to retrieve exact matches based on structure for example finding all devices on which a particular software application has been installed. This may be useful in knowing how many licenses of the particular software applications are being used on the private LAN such as for software licensing audits or the like. In another embodiment the search query is used to retrieve matches of similar items that use different terminology. In another embodiment the search query can be modified to refine a search such as by clicking on aspects of a search result to refine the search or to focus on the detailed information about the resource found.

In one embodiment the search query can be designated as shareable with other users even users outside of the private LAN in which the user is conducting the private search. As illustrated in the search GUI includes a third interface widget that allows a user to designate the search query as shareable. Once the user has designated the search query as shareable when the user selects or otherwise activates the second interface widget the designation information is sent with the search query to the server user interface module . The server user interface module stores the saved search query in the configuration database for later retrieval by the user or by other uses in or outside the private LAN. It should be noted that the server user interface module is configured to store the search query when designated as shareable but not the search results . By designating the search query as shareable the server user interface module is able to allow display and selection of the stored search query by another user for example users of a different private LAN. In another embodiment additional interface widgets may be used such as for example one to designate a search query as shareable with the user s colleagues another to designate a search query as shareable with a community and another to designate a search query as shareable with the public. Once the interface widgets have been selected another interface widget can be selected to save the search query or queries.

Although the embodiment above describes sending the search query that is received from the user in operation alternatively the search query that is sent in operation may also be a saved search query that is stored on the client device . Alternatively instead of sending the search query in operation the client device may send a request to perform a private search based on a saved search query that is stored on the hosted on demand search system .

In one embodiment as illustrated in the user interface may display a user interface page that includes a dashboard GUI . As described above a dashboard is a GUI widget that can be part of the user interface page and can be configured and saved by the user to display search results in various forms for saved search queries. For example the user interface page includes three dashboard panels and . The first panel includes the saved search query and displays the updated search results in the form of a list when the dashboard GUI is refreshed e.g. when the user first accesses the dashboard and or periodically thereafter . The second panel includes the saved search query and displays the updated search results in the form of a chart when the dashboard GUI is refreshed. The third panel includes the saved search query and displays the updated search results in the form of a table when the dashboard GUI is refreshed. Each of the dashboard panels and may include updated search results for separate saved search queries or alternatively for the same search queries.

As described above the collection of dashboard panels and may include saved configurations of the dashboard e.g. search queries such as the placement on the dashboard panels on the dashboard GUI the number of search results to display the form to display the search results or the like . These configurations may be stored for each user on the multiple private LANs. In one embodiment the dashboard configuration of the dashboard GUI can be designated as shareable to be shared with users of the same or different private LANs. For example the dashboard GUI may include an interface widget which when selected or otherwise activated designates the dashboard to be shareable. The dashboard configuration may be saved locally on the client device e.g. in data store and or sent to the hosted on demand search system to be stored in the configuration database for later retrieval by the user and or users of the same or different private LANs. In one embodiment the user may save the dashboard configuration with a saved search query so that when the user logs in the dashboard GUI is displayed with updated search results for the saved search query without having to manually enter the search query again.

Although the embodiment above includes a single interface widget to designate the dashboard configuration of the dashboard GUI in other embodiments the configurations of the dashboard panels and can be individually or collectively saved for later retrieval by the user and or other users of the same private LAN or different private LANs.

On the client side the user then installs the LAN crawler on the client device of the private LAN operation . As described above the LAN crawler automatically and repeatedly collects private data stored on the devices of the private LAN using the LAN crawler operation automatically organizes the collected information operation and automatically reports the organized information to the hosted on demand search system operation . As described above the LAN crawler may collect from multiple disparate information sources only those parts of the disparate information sources that include descriptive information of the first set of items of interest. These items of interests may be collected from the multiple disparate information sources . Also the LAN crawler may be configured to organize the collected information by using organized questions. The LAN crawler may also organize the collected information using the organization module . After the user has installed the LAN crawler and the LAN crawler has started to report the collected information to the hosted on demand search system the user requests the user interface from the hosted on demand search system operation . This may be done by the user accessing a website and logging into an account using a username and password. Alternatively the user may request the user interface in other ways such as launching an application that requests and displays the user interface .

On the server side the hosted on demand search system receives the reports from the client device operation . Based on the received reports the hosted on demand search system creates and synchronizes a private search database operation . The hosted on demand search system upon request e.g. operation provides the user interface such as the search GUI to the client device operation . The user interface allows the user to perform one or more private searches of the private search database .

In one embodiment once the LAN crawler has been installed the operations on the client side and operation and on the server side may be performed automatically and repeatedly. For example the LAN crawler may be configured to automatically and repeatedly collect the private data from devices of the private LAN . This may be configured to be periodic at scheduled intervals to be continuous to be only in response to discovery of new devices on the private LAN or the like. In another embodiment once the LAN crawler has been installed the operations may be performed manually in response to a user request.

On the client side using the provided user interface the client device receives a search query from a user operation . For example the user may type in a search query in the first interface widget . Alternatively the user may select a saved search query such as from a drop down list of saved searches. The drop down list may include search queries that are already included in the hosted on demand search system search queries that the user has previously saved search queries that user s colleagues has previously saved search queries that have been previously saved by the community or the like. The user may designate the search query as shareable to be shared with other users including users of other private LANs operation . The user may designate the search query by selecting the third interface widget which may be a check box a radio button or the like. Alternatively the user may chose to not designate the search query as shareable keeping the search query private to the private LAN . The user then selects or otherwise activates the second interface widget which sends the search query to the hosted on demand search system operation .

On the server side the hosted on demand search system receives the search query from the client device to search the private search database operation . The hosted on demand search system performs a private search in the corresponding private search database using the search query operation . The hosted on demand search system returns the search results of the private search to the client device in a user interface page operation . For example the hosted on demand search system generates the user interface page that includes the search results and sends the generated page to the client device to be displayed. The hosted on demand search system also stores the search query for example in the configuration database operation .

On the client side the client device receives the generated user interface page with the search results and displays the user interface page to the user operation . The user may then review the search results modify the search query to perform an additional search search for additional items within the search results type in another search query save the search query or the like. The user may also designate the search query as shareable after the user has received the search results. For example the user may select the third interface widget to designate the search query as shareable. The user interface may send a request to the hosted on demand search system to modify the saved search query which was previously stored in the configuration database to be designated as shareable instead of private.

Although the operations of have been described and illustrated as performing a private search in response to a search query received from a user in other embodiments private searches may be performed in response to saved search queries such as saved search queries of a dashboard GUI. For example upon launching the dashboard GUI the client device sends the saved search queries and to the hosed on demand search system performs the corresponding private searches using the search queries and returning the updated search results and to be displayed in the dashboard panels and respectively. Also the dashboard panels and or the dashboard GUI may be designated as shareable e.g. selecting the interface widget . The user interface may send a request to the hosted on demand search system to save and designated as shareable the dashboard configurations in the configuration database for later retrieval by the user and other uses including users of other private LANs. The configuration of the dashboard panels and or the dashboard GUI may be modified before or after the private searches have been performed. If performed after the private searches have been performed an additional request may be sent to designate the previously saved dashboard configuration as shareable.

In addition network and directory are each root nodes of a sub tree. A sub tree is a subset of the tree. A sub tree includes information starting at the sub tree root node and traversing through each child node of the sub tree root node and ending with at least one value. Any node on the tree that itself has nodes below it e.g. a parent node can be referred to as a sub tree root node. Thus each sub tree may include other sub trees i.e. the sub trees may be nested within a sub tree . There are many sub trees in . For example as previously described a sub tree where network is the sub tree root node includes all the information including values from the nodes device device which includes the node manufacturer and device . As an example of a nested sub tree device is a sub tree root node for the sub tree that includes all the information including values from the nodes manufacturer interface and interface . The interface node includes the MAC Address Name Status and the interface node includes MAC Address name and Status . As another example of a nested sub tree device is a sub tree root node for the sub tree that includes all the information including values from the nodes interface interface manufacturer names and status . As another example of a nested sub tree the directory includes the nodes users and users which include the nodes name and names respectively.

Values are associated with leaf nodes. For example the node manufacturer is a leaf node because it is associated with the value Dell Corporation . While in one embodiment of the invention values are only associated with leaf nodes in alternative embodiments of the invention any node in the hierarchy can have values associated with that node.

In one embodiment the LAN crawler collects information about the private LAN being crawled e.g. network assets and sends it to the hosted on demand search system to be stored in the private search database which stores the data in a tree structured format. As illustrated in the collected information is visually represented in an inverted tree structure with the root at the top and each data element as a node on the tree. The hierarchical database is useful because it provides the flexibility to scale and the ability to group related information and display the relationships.

The hierarchical database provides the ability to provide quantitative answers to questions such as questions regarding IT information of a private LAN. The LAN crawler collects information in an organized manner that lends itself to be stored in a tree structure. The hierarchical database may maintain the organization or structure of the information collected by the LAN crawler . For example if you search the private search database for Tetris a full text search algorithm finds every instance of Tetris including a computer named Tetris and a software program named Tetris. Because the LAN crawler knows how it collected the information for each including how to identify the computer which has the name and the network to which that computer belongs and the identity of the computer which has the software installed this organization can be maintained in the private search database using a hierarchical database. Using the hierarchical database the hosted on demand search system can know the difference between the computer named Tetris and a software program named Tetris because of the relationships between the computer and the software in the hierarchical database.

As many database users are familiar with SQL according to one embodiment of the invention the hierarchical database is searched with a query syntax that is familiar to SQL uses. For example illustrates exemplary search syntaxes for searching a hierarchical database according to one embodiment of the invention. For example a simple hierarchical database search query syntax may take the form of SELECT FROM Network. Similarly to SQL the SELECT clause in the query is used to specify the data returned subject to the FROM clause. In the above simple example the asterisk indicates that everything in the hierarchical database is to be returned subject to the FROM clause e.g. the network node . In the case of a tree everything in the tree will be returned subject to the FROM clause. Also similar to SQL the FROM clause describes from where in the database information should be returned. In the case of a tree the FROM clause represents which sub tree the data will be searched from. Also similar to SQL a WHERE clause may be used to specify the selection. In other words the WHERE clause restricts or filters the data returned. An example of a search query with a WHERE clause is SELECT FROM Network Device WHERE Interface Name eth0 . It should be understood that the above search syntaxes are exemplary and that many other syntaxes as known in the art to search a hierarchical database may be used.

According to another embodiment of the invention the private search database illustrated as a hierarchical database in also may be used to generate data in an unstructured database e.g. an inverted index a forward index a trie a vector space model etc. . For example virtual documents may be created from the hierarchical database. A virtual document is used to refer to representation of data as textual data that may be indexed into an unstructured database. Referring to the virtual documents that are created are represented by the dashed lines. Once virtual documents are created the unstructured database and the hierarchical database may be searched with a single search query to allow keyword based searching of the unstructured database while retaining the searching of the hierarchical database. For example the single search query may take the form of SELECT FROM Dell where the unstructured search string Dell is used to search the unstructured database e.g. the virtual documents within the unstructured database for the string dell . As there are two virtual documents that include the term Dell both of the sub trees representing those virtual documents are returned as a result.

For example in one embodiment of the invention the data stored in a hierarchical database includes information regarding substantially all devices within a private LAN a list of software installed on those devices and a list of users authorized to use those devices. Additionally the data stored may include information regarding the operating system version installed on substantially all devices within the private LAN the software which is running on substantially all devices within the private LAN and a configuration file from at least one router switch or firewall within the private LAN. The devices may include substantially all workstations within a private LAN substantially all routers within the private LAN substantially all switches within the private LAN substantially all servers within the private LAN substantially all firewalls within the private LAN and substantially all directory servers within the private LAN.

The add on applications of the application providers may be local add on applications that reside on the hosted on demand search system or alternatively remote add on applications that reside on a remote server or on a device of the private LAN. For example if the add on application is created by a third party then the application logic may be run on a remote server. The add on applications of the application providers can include application logic to query information in the private search databases . The add on applications of the application providers can also include application logic to add information to the private search databases such as inserting additional data to be stored within or in place of the collected information stored in the private search databases . In another embodiment the add on applications reside on a client device of the private LAN. In this embodiment the add on applications access the collected information on the hosted on demand search system using an API like the API described herein. For example the user may generate an add on application and or a specific plug in for the LAN crawler and run the add on application on the client device to access the collected information that has been collected and privately stored in the private search database . This is different than a private search engine that collect information from only the client device because the specific plug in for the LAN crawler can collect information not only from the client device but from other devices of the private LAN. Also the private search engine stores the collected information on the client device where the add on application would access collected information that is hosted by the hosted on demand search system .

In one embodiment the user interface provides user interface pages with an application view such as in an application panel. The user interface can request the application view from the on demand search system which interacts with the applications via the API to generate the content to display in the application view to the user. The add on applications using the API access the collected information to generate the content for the application view. The application view can be a dashboard GUI that is part of a user interface page a user interface page or the like. The add on applications may be used to provide visualization of the collected information. It should be noted that the add on application can perform specific queries to access the collected information stored in the private search database as well as perform searches of the collected information using search queries and can render an application component that is representative of the search results or alternatively an application component that is not related to the search results. For example an add on application can render the current temperature of a zip code specified by a user or the add on application can render a network topology map which is based of the accessed information. In one embodiment the add on application reads data from the private search database using specific queries or search queries processes the returned data and renders a result to the user that includes the processed data. In one embodiment the result is a graphical representation of the processed data. Alternatively the result is not a graphical representation but merely the data in a list a table or the like.

Also as described below the hosted on demand search system includes support to allow the add on applications of the application providers to affect how the LAN crawler collects information from the private LAN being crawled. In one embodiment the LAN crawler is an extensible crawler as described below. The hosted on demand search system may allow the LAN crawler to be extended to include specific plug ins that attempt to collect additional descriptive information that may be used by the add on applications. The add on applications may provide the additionally collected information to the user and or provide visualization of the additionally collected information to the user. As such the specific plug in is can be used to collect specific information that is used by the add on applications. For example an add on application that processes Netflow data may add a specific plug in to the LAN crawler to collect NetFlow information from routers. NetFlow is an open but proprietary network protocol developed by Cisco Systems to run on Cisco Internetwork Operating System IOS enabled equipment for collecting IP traffic information.

According to one embodiment of the invention a private search database that is a hierarchical database is extended for an add on application. Once traditional relational databases based on tables have been set up the relational databases often tend to be rigid and hard to extend. Hierarchical databases that store the collected information in a tree structure however are more flexible than the relational databases and can be easily extended.

As previously described the LAN crawler may be extended by specific probing plug ins that collect the descriptive information according to one or more probing requirements that are specific to add on applications of application providers. These add on applications may provide additionally collected information to the user and or provide visualization of the additionally collected information to the user. In the case of a hierarchical database the hierarchy of the tree is extended by adding a sub tree corresponding to the application provider and the add on application. For example in one embodiment of the invention a new sub tree from the root of the tree is added for each application provider in the private search database. In one embodiment the application providers can extend the tree under an enterprise node using their reversed domain name to uniquely identify the new sub tree. For example the Acme Corp extends the tree under enterprise com acme. The information that is collected from the specific probing plug in that corresponds to the application provider s add on application is stored under this new sub tree. If an application provider has more than one add on application each add on application may have its own sub tree branching from the sub tree that corresponds to the application provider. For example for an add on application that processes Netflow data the hierarchy of the tree is extended by adding a sub tree corresponding to the application provider that created this add on application.

As described above the add on applications can be local add on applications such as local add on applications that are run on the centralized search server or remote add on applications such as remote add on applications that run on the remote server s . As noted above the remote add on applications may also be run on a client device of the private LAN but hereinafter the remote add on applications are described as running on the remote server s . Both the local add on applications and the remote add on applications access the collected information stored in the private search database through an API . In one embodiment the add on applications or are third party add on applications. The third party add on application is executed by the remote server and the third party add on application communicates with the server user interface module through the API . In one embodiment a third party add on application is configured to submit additional data to the API to be stored in the private search database . In another embodiment a third party add on application is configured to access information from the private search database through the API . The third party add on application may also perform searches in the private search database through the API . As such the API facilitates access to the collected information stored in the private search database for the add on applications and .

The API is also used as an interface between the database interface the configuration database the server user interface and the local and remote add on applications and . As described above the database interface creates and synchronizes the private search database for the private LAN based on the reports received at the crawler interface from the LAN crawler . The private search database stores the collected information from across the multiple disparate information sources stored on the devices of the private LAN . It should be noted that the collected information is not organized according to the documents located on the devices but is organized according to the first set and or second set of items of interest. The server user interface module provides a user interface over the network e.g. Internet to the private LAN and provides an application rendered component such as application panel of a dashboard GUI as part of the user interface .

In one embodiment the server user interface module includes an application rendering module and a user interface rendering module . The application rendering module is configured to render an application rendered component generated by the add on application to be displayed in the user interface . In one embodiment the application rendered component represents the search results of a private search by the add on application or . The user interface rendering module is configured to generate a user interface page including the application rendered component to be displayed in the user interface . The user interface rendering module may include logic to generate the user interface page such as view logic controller logic and model logic. Alternatively other types of logic may be used to generate the user interface page. The various types of logic used in generating user interface pages are known to those of ordinary skill in the art and the detailed description regarding their operations has not been included so as to not obscure the present embodiments.

In one embodiment the configuration database is configured to store authentication information for access via the remote add on application e.g. third party add on application. In another embodiment the configuration database is configured to store a configuration of the application rendered component including the corresponding search query for later retrieval by the user or other users of other private LANs. Alternatively the configuration database may also store search queries application configurations for particular users user authentication information or the like.

In another embodiment a hosted on demand search system includes a classification server e.g. a classification server is coupled to the centralized search server and a classification database not illustrated in . As described above or the classification server is configured to compare the collected information of the private search database against predetermined characteristics of known devices and to compute a classification metric for each of the devices of the private LAN .

The specific probing plug ins are each coupled to the collection module and attempt to collect descriptive information from the disparate information sources stored on the device is including the new devices of the private LAN . Each of the specific probing plug ins attempts to collect the descriptive information according to a second set of probing requirements that are specific to each of the specific probing plug ins . In one embodiment one of the specific probing plug ins attempts to collect descriptive information according to one or more probing requirements that are specific to the local or remote add on applications and .

The specific probing plug ins may be one of three types of plug ins namely periodic plug ins device plug ins or hybrid plug ins . The periodic plug ins attempt to collect the descriptive information from at least one of the devices of the private LAN periodically. For example the plug in is configured to collect specific information from the directory server such as using LDAP periodically. In this example the plug in only periodically collects information from the single information source but in other embodiments the periodic plug ins are configured to collect information from one or more information sources periodically. The device plug ins attempt to collect the descriptive information from at least one of the devices of the private LAN . In one embodiment the device plug ins are configured to collect information from newly discovered devices such as the new device . For example when a new device is discovered by the discovery module each of the device plug ins are configured to attempt to collect information from the new device according to each of their specific probing requirements. For example a plug in attempts to collect information from the WMI database on the new device . If the new device does not include the WMI database the plug in does not collect information from the new device . However if the new device includes the WMI database then the plug in collects information from the WMI database of the new device . In another embodiment the device plug in attempts to collect information from the registry of the new device when the new device has been discovered by the discovery module . Similarly the device plug in attempts to collect information from the directory of the new device when the new device has been discovered by the discovery module . If the new device does not include registry or the directory the plug ins and do not collect information from the new device however if the new device includes one or the other or both the registry and the directory the plug ins and collect information from the registry and or the directory of the new device .

In another embodiment the device plug ins attempt to repeatedly collect information from already existing devices of the private LAN . In another embodiment the device plug ins attempt to collect information from devices that have been identified as a specific type of device according to a set of one or more probing requirements that are specific to the identified device. In another embodiment the device plug ins attempt to collect information from at least one of the devices according to specific probing requirements of a specified type of information source such as a directory server a WMI database a registry a directory a router or the like.

The hybrid plug ins may be configured to collect the descriptive information from the devices both as a periodic plug in and as a device plug in as described above. For example the plug in may be configured to collect information from the router as a device plug in when the router has been discovered by the discovery module . The plug in may also collect information periodically from the router . In one embodiment the plug in is configured to collect firewall configuration settings from the router . This may be done initially as a device plug in and subsequently as a periodic plug in. Alternatively the device plug ins and may also be configured to be hybrid plug ins or periodic plug ins and the periodic plug in may also be configured to be a hybrid plug ins or a device plug in .

Once the information has been collected by each of the specific probing plug ins the collected information is sent to the reporting module to be sent in reports out of the firewall of the private LAN and over the Internet to the centralized search server . In one embodiment the collected information is organized by the organizing module . In another embodiment the information is collected in an organized manner such as using organized questions and does not need to be organized by the organizing module as described above.

In one embodiment the specific probing plug ins include specific probing requirements that are specific to an add on application e.g. local or remote add on applications and . The specific probing plug ins collect additional information that can be used by the add on application. This may improve the hosted application services .

In one embodiment the add on application is configured to send the search request to the API to perform a private search of the private search database to extract LAN centric network topology information for the private LAN . Using the LAN centric network topology information the add on application creates a network topology map to be displayed on the user interface such as the network topology map of in the application panel . The network topology map is a visual representation of the collected LAN centric network topology information. The add on application sends the network topology map to the server user interface module to render the network topology map as part of the application rendered component in the user interface . The server user interface module generates the user interface page such as the user interface page which includes the dashboard GUI . The user interface page includes the three dashboard panels and as described above and the application panel . The user interface page may also include the interface widget to designate the dashboard as shareable as well as another interface widget to save the dashboard. As described above when the interface widget or are selected or otherwise activated the user interface sends the dashboard to the hosted on demand search system to be saved in the configuration database and or to be designated as shareable or not.

In one embodiment of displaying the network topology map the hosted on demand search system receives a first request from the private LAN to display the network topology map to be displayed on the user interface . The hosted on demand search system sends a second request to the add on application e.g. local add on application or remote add on application to generate the application rendered component that includes the network topology map . The hosted on demand search system receives one or more requests from the add on application to perform one or more queries to the private search database for LAN centric network topology information. The hosted on demand search system authorizes the one or more queries using application authorization information stored in the configuration database . The hosted on demand search system sends the query results to the add on application and the add on application generates the network topology map based on the collected LAN centric network topology information. The network topology map is then sent to the hosted on demand search system and the hosted on demand search system generates the page with the network topology map as part of the user interface provided to the private LAN .

In another embodiment the network topology map is generated based on other collected information than LAN centric network topology information such as non LAN centric information.

Although the embodiments above described generating the network topology map as the application rendered component alternatively the application rendered component can be any type of rendered component by the add on application such as text charts tables graphs diagrams or the like. The rendered component can be related to or unrelated to the collected information that is stored in the private search database .

Having described embodiment s of the invention alternative embodiment s will now be described. Like the previous embodiment s these alternative embodiment s allow for hosted searching of information with support for add on applications and or extensible crawling. However unlike the previous embodiment s these embodiment s allow for hosted searching information for information that is not limited to private LAN information as described above but may include other types of information such as financial information enterprise information traffic statistics from web sites transaction statistics from a database system trading volumes from a stock trading application resource usage and resource availability in a MRP system or a Enterprise Resource Planning ERP system sales forecast information from a customer relationship management CRM system or the like.

While embodiments of the invention has been described in relation to collecting private LAN information stored on devices of a private LAN such as technical information from devices of the private LAN other embodiments may include collecting other types of information as described above from other types of information sources on devices of public networks private and public networks or the like. Therefore embodiments of the invention are not limited to collecting private LAN information. In addition while embodiments of the invention have been described in relation to technical information stored in devices of the private LAN alternative embodiments could be implemented such that other types of information may be collected from information sources of devices of public networks private and public networks or the like. Such an embodiment could be implemented by having the LAN crawler ask one or more questions of the devices to collect the other types of information. This may be done using one or more specific probing plug ins as described herein.

For example while the flow diagrams in the figures show a particular order of operations performed by certain embodiments of the invention it should be understood that such order is exemplary e.g. alternative embodiments may perform the operations in a different order combine certain operations overlap certain operations etc. 

While the invention has been described in terms of several embodiments those skilled in the art will recognize that the invention is not limited to the embodiments described can be practiced with modification and alteration within the spirit and scope of the appended claims. The description is thus to be regarded as illustrative instead of limiting.

