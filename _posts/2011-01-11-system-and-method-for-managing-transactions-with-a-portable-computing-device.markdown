---

title: System and method for managing transactions with a portable computing device
abstract: A method and system include verifying credentials for gaining access to a transactional controller with the portable computing device. The transactional controller may receive a merchant identifier corresponding to a merchant and then it may compare the merchant identifier against loyalty account data stored in a database. The transactional controller may also receive product scan data and compare the product scan data against one of offer data and coupon data in a database. After these comparisons, any matches of product scan data to offer data or coupon data may be sent to the PCD and the POS controller. Similarly, any matches of the merchant identifier to loyalty account data may be transmitted to the POS controller. During or after the purchase transaction, a message may be generated by the transaction controller which lists one or more preferred payment options that may be selected using the PCD to complete a purchase.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08660948&OS=08660948&RS=08660948
owner: QUALCOMM Incorporated
number: 08660948
owner_city: San Diego
owner_country: US
publication_date: 20110111
---
Portable computing devices PCDs are becoming necessities for people on personal and professional levels. These devices may include cellular telephones portable digital assistants PDAs portable game consoles palmtop computers and other portable electronic devices.

PCDs are often utilized to conduct financial transactions. For example PCDs may be used to check bank account balances transfer funds between bank accounts and for paying bills. While PCDs are useful for these types of transactions there is a growing need in the art for utilizing PCDs in other types of transactions.

For example an ordinary consumer may be assigned a loyalty card which corresponds to a first merchant. The consumer may also own a gift card that also corresponds to this first merchant. The consumer may also be assigned a credit or debit card affiliated with the first merchant which provides the consumer with additional benefits should the credit card be used to make purchases with a first merchant. Further the first merchant may also accept coupons for products that are sold by the merchant and that may be collected by the consumer.

When the consumer decides to purchase products from the first merchant the consumer will usually want all the benefits and discounts that are available to the consumer for any given transaction. The problem of the consumer bearing all the responsibility to track these benefits and discounts may grow exponentially when the consumer has similar loyalty cards credit cards and coupons for a plurality of other second merchants.

The scenario reaches its apex of complexity when the consumer is standing in a checkout line and in front of a point of sale terminal owned by the first merchant and ready to make a purchase of one or more products. The consumer will need to provide the first merchant with any relevant loyalty cards and any relevant coupons or rewards in which the consumer is entitled. When the consumer is ready to pay for the products he or she may need to present any relevant gift cards as well as any relevant credit or debit cards should the gift cards not cover the total amount due for the purchase of the products.

Accordingly what is needed is a system and method that may overcome the problems associated with tracking a plurality of benefits and payment methods which are available to a consumer for purchasing goods or services or both .

A method and system for managing transactions with a portable computing device PCD are described. The method may include verifying credentials for gaining access to a transactional controller with the portable computing device. The method further includes the transactional controller receiving a merchant identifier corresponding to a merchant from a computer communications network and then comparing the merchant identifier against loyalty account data stored in a database. The method may further include the transaction identifier receiving product scan data and comparing the product scan data against one of offer data and coupon data in a database. After these comparisons any matches of product scan data to offer data or coupon data may be sent over the computer communications network to the PCD and the POS controller. Similarly any matches of the merchant identifier to loyalty account data may be transmitted over the computer communications network to a POS controller. In parallel with the matching described above line item product scan data may be transmitted over the computer communications network from the POS controller to the PCD. At some point during or after the purchase transaction a message may be generated by the transaction controller which lists one or more preferred payment options that may be used and selected by the user from the PCD to complete a purchase.

The word exemplary is used herein to mean serving as an example instance or illustration. Any aspect described herein as exemplary is not necessarily to be construed as preferred or advantageous over other aspects.

In this description the term application may also include files having executable content such as object code scripts byte code markup language files and patches. In addition an application referred to herein may also include files that are not executable in nature such as documents that may need to be opened or other data files that need to be accessed.

The term content may also include files having executable content such as object code scripts byte code markup language files and patches. In addition content referred to herein may also include files that are not executable in nature such as documents that may need to be opened or other data files that need to be accessed.

As used in this description the terms component database module system and the like are intended to refer to a computer related entity either hardware firmware a combination of hardware and software software or software in execution. For example a component may be but is not limited to being a process running on a processor a processor an object an executable a thread of execution a program and or a computer. By way of illustration both an application running on a computing device and the computing device may be a component. One or more components may reside within a process and or thread of execution and a component may be localized on one computer and or distributed between two or more computers. In addition these components may execute from various computer readable media having various data structures stored thereon. The components may communicate by way of local and or remote processes such as in accordance with a signal having one or more data packets e.g. data from one component interacting with another component in a local system distributed system and or across a network such as the Internet with other systems by way of the signal .

In this description the terms communication device wireless device wireless telephone wireless communication device and wireless handset are used interchangeably. With the advent of third generation 3G wireless technology greater bandwidth availability has enabled more portable computing devices with a greater variety of wireless capabilities. Therefore a portable computing device may include a cellular telephone a pager a PDA a smartphone a navigation device or a hand held computer with a wireless connection or link.

Referring initially to this figure is a diagram of a wireless portable computing device PCD coupled to a wireless communications network A via a communication link A which are integral parts of a system for managing transactions with the portable computing device . Many of the system elements illustrated in are coupled via communications links to the communications network A. The links illustrated in may comprise wired or wireless links. Wireless links include but are not limited to radio frequency RF links infrared links acoustic links and other wireless mediums. The communications network A may comprise a wide area network WAN a local area network LAN the Internet a Public Switched Telephony Network PSTN a paging network or a combination thereof. The communications network A may be established by broadcast RF transceiver towers . However one of ordinary skill in the art recognizes that other types of communication devices besides broadcast RF transceiver towers are included within the scope of the invention for establishing the communications network A. The PCD is shown to have an antenna see so that a respective PCD may establish wireless communication links A with the communications network A via RF transceiver towers .

The portable computing device PCD may support a client transaction manager module that may reside in memory A See of the PCD . The client transaction manager module may allow the PCD communicate with the transaction controller over the computer communications network A. The client transaction manager module may also allow the PCD to collect information from a machine readable tag A that is coupled to an electronic cash register A. The machine readable tag A may comprise a unique merchant identifier and a unique terminal identifier that help the PCD to manage point of sale POS transactions. Further details about the machine readable tag A will be described below in connection with .

The electronic cash register ECR A may comprise a mechanical or electronic device or combination thereof for calculating and recording sales transactions. The ECR A may also comprise a drawer for storing cash currency. The ECR A may also print a receipt for a customer with a printing device not illustrated .

The ECR A may be coupled to a product scanner A which may be used to scan other machine readable labels attached to one or more products A. The product scanner A may comprise a bar code reader or any type of similar device used to collect information from machine readable labels attached to a product A.

The ECR A may also be coupled to a point of sale POS terminal A. The POS terminal A may comprise a device for reading any one of a number of tokens such as credit cards debit cards loyalty cards stored value cards such as gift cards and the like. The POS terminal A may comprise a device that reads magnetic stripes on cards integrated circuit cards and near field communication NFC cards as understood by one of ordinary skill in the art. The POS terminal may also comprise a keypad so that a consumer may enter appropriate information relative to any token that may be scanned or read by the POS terminal A.

The ECR A is also coupled a point of sale POS controller . The POS controller may support one or more electronic cash registers ECRs A B for a particular location of a merchant. The POS controller as understood by one of ordinary skill in the art may comprise a computer server for tracking and matching scanned product codes with a product inventory database not illustrated separately which is maintained by the POS controller .

The POS controller may receive product data that is produced by the product scanner A and which is relayed by the ECR A. The POS controller may be responsible for securing authorization for payment from a consumer after a token is read by the POS terminal B. The POS controller may support one or more product specific languages as understood by one of ordinary skill the art such as but not limited to unified POS and JAVA POS.

To secure authorization for payment such as for a credit or debit card the POS controller communicates with a router . A router may comprise a device that interconnects two or more computer networks and selectively interchanges packets of data between them as is understood by one of ordinary skill in the art. The router of couples the POS controller to another computer communications network C for traditional payment processing. This third computer communications network C may be part of or the same as the first computer communications network A as described above. The dashed line indicates that the first computer communications network A and the second computer communications network B and the third computer communications network C may all be part of the same network or they may be separate distinct computer networks as understood by one of ordinary skill in the art.

The third computer communications network C may be responsible for traditional payment processing. Traditional payment processing may include but is not limited to processing payments from accounts associated with traditional credit cards and debit cards. The third computer communications network C may comprise exemplary networks such as the VISA credit card network the MASTERCARD card network the DISCOVER credit card network the AMERICAN EXPRESS credit card network and other similar charge or debit card proprietary networks.

Meanwhile the second computer communications network B may be responsible for handling and managing non traditional or alternative payment processing. For example alternative payment processing may include but is not limited to processing payments from accounts associated with certain online financial institutions or other service providers like PAYPAL BILL ME LATER Wii APPLE GREEN DOT and mobile phone carriers like SPRINT and VERIZON .

The POS controller may also be coupled to a third party offer generator that produces targeted coupons based upon specific products purchased by a consumer. The third party offer generator may comprise a device currently sold by Catalina Marketing Inc. for producing targeted coupons for a consumer. Other types of third party offer generators are within the scope of the invention. In the alternative the offer generator may comprise an internal system component managed and supported by the operator of the transactional controller .

The POS controller is also coupled to a terminal router T R emulator which links the POS controller with the transaction controller . The T R emulator functions as a router when an alternative payment option B is selected by the consumer on the PCD since most brick and mortar type merchants and corresponding POS controllers as of this writing do not directly support payments from on line financial institutions like PAYPAY and BILL ME LATER . In other words when the PCD receives an alternative payment processing selection from a consumer the PCD communicates with the transaction controller which in turn communicates with the T R emulator . The emulator sends a message to the POS controller to indicate that the emulator is operating as a payment router and that the POS controller should be ready to receive a payment authorization from an alternative payment vendor B.

The T R emulator functions as an electronic cash register ECR when the emulator relays product scan data to the transaction controller which then also relays this product scan data to the PCD displayed to a user. The emulator may send a message to the POS controller that the emulator is functioning as an ECR and the emulator may request product scan data that is being generated and received by actual ECRs .

The T R emulator also functions as a POS terminal when the transaction controller relays payment account information such as credit card data that is routed through the POS controller a router and on to a traditional payment network or computer communications network C. In other words the T R emulator functions as a POS terminal when a form of payment managed and stored in a secure vault A is selected by a consumer with the PCD . Upon selection of a form of payment stored in the secure vault A the transaction controller may relay appropriate payment information such as information like that collected by a terminal which reads a magnetic stripe over a secure communication channel B to the T R emulator which then relays this payment information to the POS controller similar to how a traditional POS terminal would forward such data to the POS controller . The POS controller would then forward this payment information over the router and on to the third computer communication network C for requesting an authorization of payment.

The T R emulator may comprise off the shelf software or hardware or both . According to one exemplary embodiment the T R emulator may comprise an Exadigm SV100 a WiFi CDMA and IP enabled unattended payment device. The T R emulator may be designed to support secure channels with the transaction controller . Further details of an exemplary software architecture supported by the T R emulator is described below in connection with .

The transaction controller may be part of a system responsible for managing and maintaining mobile wallets that are stored in memory by the PCD . A mobile wallet is a system that may provide information for one or more stored value accounts as well as other types of accounts such as but not limited to credit card accounts and bank accounts as understood by one of ordinary skill in the art.

The transaction controller supports and may store financial transaction s data in storage devices A B C. The storage devices A B and C may comprise computer databases. The transaction controller manages data between the PCD and the terminal router emulator located within a store front that includes the POS controller . The transaction controller is also responsible for communicating with a gateway for establishing a connection with the second computer communications network B associated with alternative payments. The transaction controller may relay product scan data sent from the terminal router emulator over the computer communications network A to the PCD so that the PCD may display products individually on the display of the PCD as they are scanned in by the product scanner A. The transaction controller may also relay payment authorizations received from the second computer communications network B to the terminal router emulator .

The first storage device A coupled to the transaction controller may track one or more payment accounts associated with a client of a PCD . For example the first storage device A may comprise a secure vault that houses credit card data stored value account data and other sensitive payment information data. The first storage device A may be managed and co located with the transaction controller . However it is possible that the first storage device A may comprise a third party solution that is located off site relative to the transaction controller . Further detail about the first storage device A will be described below in connection with .

The second storage device B may comprise one or more client profiles associated with a respective PCD . The client profiles may comprise preferences selected by a user of the PCD . Such preferences may include but are not limited to an account user name as well as preferred forms of payment corresponding to the payment accounts maintained in the secure vault or first storage device A. The second storage device B may also track benefits associated with particular merchants such as loyalty account information coupons and other similar offer information for a user of the PCD . Further details about the second storage device B are described below in connection with .

The third storage device C may comprise merchant data associated with various merchants who subscribe to the system and who have one or more terminal router emulators positioned in their stores for communicating with the transaction controller . The merchant data stored in the third storage device C may comprise preference data selected by a respective merchant. Further details of the third storage device C are described below in connection with .

The gateway coupled to the transaction controller may comprise a payment server as understood by one of ordinary skill in the art. Communications between the transaction controller and the payment gateway may comprise a secured socket layer SSL encrypted connection. Usually the transaction controller relays alternative payment account information stored in a secure vault or first storage device A to the payment gateway over a secure channel C or link C.

The payment gateway may forward the transaction information to a payment processor not illustrated coupled to the second computer communications network B used by a merchant s acquiring bank. The payment processor forwards the transaction information to one of the alternative payment providers.

The alternative payment provider may route the transaction to the correct issuing bank associated with a client s account. The issuing bank receives the authorization request and sends a response back to the payment processor via the same process as the request for authorization with a response code. In addition to determining the fate of the payment i.e. approved or declined the response code is used to define the reason why the transaction failed such as insufficient funds or bank link not available . The processor forwards the response to the payment gateway .

The payment gateway receives the response and forwards it on to the transaction controller . The transaction controller may interpret the response as a relevant response and then relay it back to the PCD and the POS controller via terminal router emulator .

An operator of the PCD may desire to purchase one or more products A that may be scanned with a product scanner A. Prior to or in parallel to the operation of scanning products with the product scanner A the operator of the PCD may retrieve the unique terminal identifier and the merchant identifier associated with the tag A which is affixed to the first electronic cash register A. This unique terminal identifier and merchant identifier retrieved by the PCD may be relayed back to the transaction controller . In response to receiving the terminal identifier and merchant identifier the transaction controller may send messages to the terminal router emulator so that the terminal router emulator may function as a terminal. The terminal router emulator may request the POS controller for the product scan data being generated by the product scanner A.

In response to this request from the terminal router emulator the POS controller may forward on product scan data to the terminal router emulator which relays this information through the transaction controller to the PCD so that the product scan data may be displayed on the display device of the PCD . The PCD may provide an option that may be selected by a user to turn off this product scan data from being displayed on the display device of the PCD while the products A are being scanned.

While the products A are being scanned by the product scanner A the transaction controller may also retrieve loyalty account information from a profile associated with a user of the PCD which is stored in the second storage device B. The transaction controller may relay this loyalty account information to the POS controller via the terminal router emulator .

When the product scanner A is finished scanning the products A for purchase the electronic cash register A may generate a final total of money due for payment in connection with the purchase of the products A. This final total data is relayed through the POS controller and terminal router emulator to the transaction controller which in turn relays this information to the PCD . In addition to relaying this final total data to the PCD the transaction controller may also retrieve payment accounts available to the user and that may have been selected by a user in a predetermined order for display on the PCD . At this time or any time during the transaction cycle an operator of the PCD may select from one of a plurality of payment methods supported by the transaction controller . Alternatively an operator of the PCD may select a plurality of payment methods in order to pay the final total due in connection with the purchased products A. Once a payment method or a combination of methods are selected by an operator of the PCD the PCD relays this selection to the transaction controller .

Depending upon the form of payment selected the transaction controller selects data from the first storage device or secure vault A for rendering payment associated with the final total data. If an alternative form of payment is selected by the operator of the PCD then the transaction controller will relay the alternative payment account information through the gateway to the second computer communications network B for alternative payment processing as described above.

If a traditional form of payment is selected by the operator of the PCD such as the selection of a credit card account then the transaction controller may relay this credit card payment information over a secure channel B to the terminal router emulator which then communicates this information to the POS controller . The POS controller then relays this credit card payment information to its router which then sends the credit card information to the third computer communications network C. As noted previously the third computer communications network C may comprise exemplary networks such as the VISA credit card network the MASTERCARD card network the DISCOVER credit card network the AMERICAN EXPRESS credit card network and other similar charge card proprietary networks. One of ordinary skill in the art recognizes that transactions for merchant gift cards may also follow the same flow with the router directing the transaction to the merchant s stored value processor that may be part of the third computer communications network C.

If payment was made using the third computer communications network C and if the transaction was approved then the router relays this approval message to the POS controller which then relays the approval message to the electronic cash register A and to the terminal router emulator . The terminal router emulator forwards the approval message to the transactional controller which then relays the approval message to the PCD for display on the display device of the PCD .

Similarly if payment was made using the second computer communications network B and if the transaction was approved then the gateway relays this approval message to the transaction controller which then relays the payment approval message to the PCD for display on the display device of the PCD . The transaction controller also relays the payment approval message to the terminal router emulator which then forwards the payment approval message to the POS controller which in turn relays the information to the electronic cash register A. The transaction controller may generate an electronic receipt that can be forwarded and displayed on a display device of the PCD . Meanwhile the electronic cash register A may also generate a hard copy receipt .

If the user name and unique identifier assigned to the PCD do not match then the transaction controller may deny entry to the system and prompt the user for correct credentials for a predetermined number of times. If the user name and unique identifier assigned to the PCD do match then the transaction controller may prompt the operator of the PCD for the password associated with the user name on the account such as illustrated in .

Instead of a two dimensional bar code a one dimensional bar code may be employed to provide the unique electronic cash register identifier and the unique identifier associated with the merchant. Exemplary one dimensional bar codes may include but are not limited to U.P.C. Codabar Code 25 Non interleaved 2 of 5 Code 25 Interleaved 2 of 5 Code 39 Code 93 Code 128 Code 128A Code 128B Code 128C Code 11 CPC Binary DUN 14 EAN 2 EAN 5 EAN 8 EAN 13 Facing Identification Mark GS1 128 formerly known as UCC EAN 128 GS1 DataBar formerly Reduced Space Symbology RSS HIBC HIBCC Bar Code Standard ITF 14 Latent image bar code Pharmacode Plessey PLANET POSTNET Intelligent Mail Bar code MSI PostBar RM4SCC KIX JAN and Telepen. Other machine readable codes for retrieving the unique identifiers associated with the electronic cash register and merchant are well within the scope of the invention such as contact less or wireless communication methods such as near field communications NFCs used with smart cards and RF ID cards as understood by one of ordinary skill in the art. Further in another exemplary embodiment the operator of the PCD may key in a human readable code associated with the unique identifier of the electronic cash register and the merchant.

As discussed above once the transaction controller has the unique identifier associated with the electronic cash register and the identifier associated with the merchant from the scanned image then the transaction controller may communicate with the POS controller for receiving product scan data generated by the product scan A.

While the product scanner A is scanning the machine readable product codes from the products A the transaction controller may match these machine readable product codes with coupon data that may be stored in the second storage device B that contains one or more client profiles associated with the PCD . If the transaction controller determines a match between a coupon stored in the storage device B and a product A being scanned the transaction controller may prompt the operator of the PCD to take some action such as illustrated in as described below.

The operator of the PCD may also select one or more different payment methods to pay the total final amount due for a particular purchase. So for example a user may select a credit card to pay a portion of the final bill along with payment from a stored value card and payment from a debit card. According to one exemplary aspect of the invention the current balances of stored value accounts as well as remaining credit on credit card accounts may be displayed in conjunction with the payment options A that are available for selection by the user with the PCD as illustrated in .

According to another exemplary feature of the system credit card issuers as well as debit card issuers and stored value account issuers do not need to send any physical tokens to an operator of the PCD when new account numbers may be assigned to a particular user of the PCD . Instead of mailing physical tokens bearing the new account numbers the issuers of the new account numbers may update the data in the first storage device A or secure vault. A corresponding message may be transmitted from the transaction controller to the operator of the PCD when new account numbers have been stored in the secure vault or first storage device A in place of old account numbers.

The system of may generally support businesses such as restaurants or other establishments which may provide products as well as services and which usually do not employ product scanners that are coupled to electronic cash registers . In this exemplary operating environment other differences include electronic cash registers not being present. However one of ordinary skill the art recognizes that in some restaurant environments depending upon the owner s preferences may include electronic cash registers without departing from the scope of the invention. According to the exemplary operating environment illustrated in terminals A B are provided and are coupled to the POS controller . The terminals A B may comprise token readers such as magnetic stripe readers attached to or integral with the housing of the terminals as understood by one of ordinary skill in the art.

In the exemplary embodiment illustrated in a machine readable tag B may be placed on a table surface so that it may be scanned in with a PCD running the client transaction manager module . The machine readable tag B may be part of a menu or a display component that is very accessible to an operator of the PCD .

In response to scanning the machine readable code of the transaction controller may generate a message and send the message to the display of the PCD as illustrated in .

Once an option is selected by an operator of the PCD the PCD may relay this information back to the payment controller which in turn relays this information to the terminal router emulator . The terminals router emulator then sends this appetizer selection message to one or more terminals . A waiter or service professional monitoring the terminal may be provided with a display of the appetizer selected by the operator of the PCD . Along these lines in other exemplary embodiments the operator of the PCD may also select all of their food items from a menu by scanning in machine readable codes from the menu or by keying in codes or names of food items listed in the menu.

Referring to and an exemplary portable computing device PCD is shown and is generally designated . As shown the PCD may include a housing . The housing may include an upper housing portion and a lower housing portion . shows that the upper housing portion may include a display . In a particular aspect the display may be a touch screen display. The upper housing portion may also include a trackball input device . Further as shown in the upper housing portion may include a power on button and a power off button . As shown in the upper housing portion of the PCD may include a plurality of indicator lights and a speaker . Each indicator light may be a light emitting diode LED .

In a particular aspect as depicted in the upper housing portion is movable relative to the lower housing portion . Specifically the upper housing portion may be slidable relative to the lower housing portion . As shown in the lower housing portion may include a multi button keyboard . In a particular aspect the multi button keyboard may be a standard QWERTY keyboard. The multi button keyboard may be revealed when the upper housing portion is moved relative to the lower housing portion . further illustrates that the PCD may include a reset button on the lower housing portion .

Referring to an exemplary non limiting aspect of a portable computing device PCD is shown and is generally designated . As shown the PCD includes an on chip system that includes a multicore CPU . The multicore CPU may include a zeroth core a first core and an Nth core .

As illustrated in a display controller and a touch screen controller are coupled to the multicore CPU . In turn a touch screen display external to the on chip system is coupled to the display controller and the touch screen controller .

Further as shown in a digital camera may be coupled to the multicore CPU . In an exemplary aspect the digital camera is a charge coupled device CCD camera or a complementary metal oxide semiconductor CMOS camera.

As further illustrated in a stereo audio coder decoder CODEC may be coupled to the multicore CPU . Moreover an audio amplifier may coupled to the stereo audio CODEC . In an exemplary aspect a first stereo speaker and a second stereo speaker are coupled to the audio amplifier . shows that a microphone amplifier may be also coupled to the stereo audio CODEC . Additionally a microphone may be coupled to the microphone amplifier . In a particular aspect a frequency modulation FM radio tuner may be coupled to the stereo audio CODEC . Also an FM antenna is coupled to the FM radio tuner . Further stereo headphones may be coupled to the stereo audio CODEC .

As depicted in the touch screen display the video port the USB port the camera the first stereo speaker the second stereo speaker the microphone the FM antenna the stereo headphones the RF switch the RF antenna the keypad the mono headset the vibrator and the power supply are external to the on chip system .

In a particular aspect one or more of the method steps described herein may be stored in the memory A as well as in the transaction controller T R emulator POS controller and the storage devices A C as computer program instructions. These instructions may be executed by the multicore CPU transaction controller T R emulator and POS controller in order to perform the methods described herein. Further the multicore CPU T R emulator POS controller storage devices A C and memory A of the PCD or a combination thereof may serve as a means for executing one or more of the method steps described herein.

The client transaction manager of the PCD may comprise an authentication module a checkout module a scanner module and a screen display module . The authentication module may be responsible for prompting a user for credentials to log into the system . The authentication module may relay and communicate with the transaction controller in order to authenticate a user or operator of the PCD .

The scanner module may be responsible for monitoring input from the camera for the contents of the tag . If the PCD also comprises hardware for supporting NFC and RFID scans the scanner module may also monitor these elements for any scans of the machine readable code . The scanner module may comprise one or more algorithms for recognizing the machine readable code present on the tag .

The checkout module may monitor and format messages received from the transaction controller that may comprise information about product scan data relayed by the transaction controller . The checkout module may be responsible for formatting any information that it receives from the transaction controller . The checkout module may also be responsible for prompting a user to select certain options on offers that may be found by the transaction controller when the transaction controller determine matches between product scan data and offers available to the operator of the PCD .

The screen display module may monitor the display touchscreen for input from the operator of the PCD . The screen display module may also format any data that it receives from the checkout module for presentation on the display touchscreen .

As illustrated in and in the PCD which executes the client transaction manager is coupled to the transaction controller via the computer communications network A. The transaction controller may comprise a matching engine module a client manager module a router terminal emulator application programming interface API a gateway application programming interface API and a security communication module A.

The matching engine module may be responsible for matching product scan data with stored offer data present in the second storage device B. The matching engine module also manages and reviews the data stored in the remaining first and third stored devices A and C. This means that the matching engine module has access to the payment account information provided within the first storage device A also referred to as a secure vault. The matching engine module also has access to the third storage device C which may contain various rules that are specific to a particular merchant.

The matching engine module may comprise one or more rules and or algorithms to assist the module in determining if one or more offers should be presented to the operator of the PCD when the PCD is used for payment at a particular merchant such as in a retail environment and or in a restaurant environment. The matching engine module may also be responsible for determining if there is a match between an operator s loyalty account and the merchant identifier received from the tag . The matching engine module may also determine if there is a match between certain payment methods like credit cards and the merchant identifier received from the tag . Other matching functions not specifically described for the matching engine are well within the scope of the invention.

The client manager module may be responsible for the communications exchanged between the transaction controller and the PCD . The client manager module may establish and monitor the communication link A between the transaction controller and the PCD . Usually the communication link A between the transaction controller and the PCD does not need to be secure since sensitive financial transaction data such as but not limited to complete credit card information is usually not transmitted over the communication link A. However if sensitive financial transaction data is transmitted over the communications link A the client manager module may utilize a security communication module A which may be responsible for establishing a secure communication link using one or more encryption methods as understood by one of ordinary skill the art.

The router terminal emulator API module may be responsible for managing communications between the transaction controller and the terminal router T R emulator . On occasion when the transaction controller has been requested to send sensitive financial transaction data such as credit card magnetic stripe data from the secure vault or first storage device A the router terminal emulator API module may send this request using the security communication module A.

The security communication module A may be responsible for establishing a secure communications link or secure channel B between the transaction controller in the terminal router emulator . To establish this secure communication channel B security communication module A may comprise a secure element algorithm that works in combination with one or more encryption methods as understood by one of ordinary skill the art.

The router terminal emulator API module may be responsible for transmitting secure financial transaction data such as the magnetic stripe credit card data described above in addition to transmitting payment authorizations received from the alternative payment processing elements from the second computer communications network B. The router terminal emulator API module may also transmit matched offer data such as coupons and merchant loyalty data to the terminal router emulator . The router terminal emulator API module may also receive and process product scan data as well as request for alternative payment processing which is part of the second computer communications network B.

The gateway API module may be responsible for managing communications between the gateway device and the transaction controller . This means that the gateway API module may transmit payment requests to the gateway as well as receiving payment authorizations from the gateway as understood by one of ordinary skill the art.

The transaction controller executing the modules as described above is also coupled to the terminal router emulator as illustrated in and . The terminal router emulator may comprise a main controller module a security communication module B a POS controller application programming interface API and a security application programming interface .

The main controller module may be responsible for managing most of the communications which are sent to and received from the transaction controller . The main controller module may route product scan data requests as well as loyalty account matches to the POS controller . The main controller may also handle alternative payment authorizations and traditional payment data such as magnetic stripe data for a credit card received from the transaction controller . The main controller module may also route product scan data received from the POS controller destined for the transaction controller . The main controller module may also route third party offers created by the third party offer generator .

To communicate with the POS controller the main controller module may route its communication is through the POS controller API . The POS controller API may be responsible for translating messages to the POS controller and translating messages from the POS controller . As noted previously the POS controller may utilize unified POS or JAVA POS as its primary language as understood by one of ordinary skill in the art.

The security communication module B of the terminal router emulator may be complementary relative to the security communication module A of the transaction controller . That is the security communication module B may be utilized to establish a secure communication channel B between the terminal router emulator and the transaction controller .

The security communication module B may comprise a secure element algorithm that works in combination with one or more encryption methods as understood by one of ordinary skill the art. A security communication module B may work in combination with a security API module if the security communication module B of the terminal router emulator is different relative to the security communication module A of the transaction controller .

The first storage device A may comprise a database such as a sequential query language SQL database as understood by one of ordinary skill the art. In such a scenario the matching engine module of the transaction controller may also comprise an internal database application programming interface API as appropriate and as understood by one of ordinary skill the art for communicating with the first storage device A.

As noted previously credit card issuers as well as debit card issuers and stored value account issuers do not need to send any physical tokens to an operator of the PCD when new account numbers may be assigned to a particular user of the PCD . Instead of mailing physical tokens bearing the new account numbers the issuers of the new account numbers may update the data in the first storage device A or secure vault. A corresponding message may be transmitted from the transaction controller to the operator of the PCD when new account numbers have been stored in the secure vault in place of old account numbers. In this way the operator or user of PCD does not need to receive a physical token corresponding to a new account number that may have been issued by a credit card vendor a debit card vendor a loyalty card vendor and the like.

The third storage device C may comprise a database such as a sequential query language SQL database as understood by one of ordinary skill the art. In such a scenario the matching engine module of the transaction controller may also comprise an internal database application programming interface API as appropriate and as understood by one of ordinary skill the art for communicating with the third storage device C.

The user preference data may comprise a preferred account username and a sequence order of preferred payment method options that may be preselected or predetermined by a user or operator of the PCD . In other words as part of a client profile a user or operator of a PCD may specify certain payment methods to be displayed when payment is required after a final bill for a purchase has been calculated by the system . The user or operator of PCD may also specify one or more rules that are executed by the transaction controller and specifically the matching engine in order to display preferred payment methods to the user of PCD .

For example in the first client profile comprising the user preference data of the user has selected to display a first credit card vendor a second credit card vendor and a stored value account vendor in this sequence when payment is required for purchase. The user of PCD corresponding to this first client profile has also specified that if a credit card corresponding to a merchant identifier taken from the tag exists then this credit card should be displayed as a payment option for the user of the PCD . Other customized rules and user defined preferences not specifically enumerated and which may be provided by the user of the PCD are within the scope of the invention.

Another interesting feature of the client profiles which can be stored in the second storage device B is the coupon data . A user or operator of PCD may find coupons prior to making a purchase from a merchant. For example the user of PCD may select coupons from an online database which are then transferred to the coupon data maintained by the second storage device B. The coupon data may also comprise coupons which are generated at the end of a transaction by a third party offer generator such as devices provided by Catalina marketing as of this writing. In this way a user operator of PCD does not need to keep or carry physical coupons on their person compared to conventional shopping methods.

Another beneficial feature of the client profiles maintained by the second storage device B is the loyalty account data . The loyalty account data may track various loyalty accounts that correspond with different merchants. The loyalty account data may also track loyalty points earned by a user of PCD when certain purchases are made at particular merchants corresponding to the loyalty account. When a user of the PCD has elected to use the system for processing payments of purchases the transaction controller may retrieve loyalty account data after the information from the tag is collected from the PCD . This retrieval of the loyalty account data may occur prior to or during the generation of product scan data by the product scanner so that appropriate discounts corresponding to the loyalty account data may be applied by the POS controller .

The second storage device B may comprise a database such as a sequential query language SQL database as understood by one of ordinary skill the art. In such a scenario the matching engine module of the transaction controller may also comprise an internal database application programming interface API as appropriate and as understood by one of ordinary skill the art for communicating with the second storage device B.

Next in decision block the transaction controller determines if the client is authenticated based on the credentials that it received in block . In this decision block the transaction controller may verify that the user name of screen A matches the unique client identifier assigned to the PCD which is maintained in the second storage device B comprising the client database or client profiles. If the transaction controller verifies that the user name matches the client unique identifier assigned to the PCD then the transaction controller checks to see if the password of screen B matches the username of screen A based on a review of the client profile stored in the second storage device B.

If the inquiry to decision block is negative then the No branch is followed back to step for receiving the client s credentials for a predetermined number of times. If the inquiry to decision block is positive then the Yes branch is followed to block in which the electronic cash register or terminal identifier and merchant identifier are received from the PCD . In this block the PCD may conduct a scan of the tag that comprises the bar code which contains the electronic cash register or terminal identifier as well as the merchant identifier.

Next in block the ECR or terminal identifier and the merchant identifier are transmitted by the PCD over the first computer communications network A to the transaction controller . Subsequently in block the transaction controller and specifically the matching engine may compare the merchant identifier received against the loyalty data stored in the second storage device B as illustrated in and .

If the transaction controller determines that there is one or more matches between any loyalty account data and the merchant identifier then in block the transaction controller sends the loyalty account data over the first computer communications network A to the terminal router emulator .

In block the terminal router emulator sends the loyalty account data to the POS controller . Next in block when the POS controller receives the loyalty account data the POS controller may apply appropriate discounts and or benefits. The application of the discounts and or benefits may be based on the products purchased by the user of the PCD or they may be based on other factors or a combination of factors such as the number of re occurrences of purchasing products from the merchant.

Next in block the transaction controller via the terminal router emulator may alert the POS controller of the received electronic cash register or terminal identifier and request product scan information to be sent to the terminal router emulator so that the transaction controller may relay this information to the PCD as described below.

Next in block product scan information may be received by the POS controller via the electronic cash register and the product scanner . The process then continue continues to block of .

In block the transaction controller may relay the product scan data to the portable computing device via the first computer communication network A and the communication link A. In this block the PCD may display the product scan data on the display device of the PCD . However according to one exemplary embodiment the operator or user of PCD may select an option for turning off the display of product scan data according to his or her discretion preferences which are stored in the second database B.

Next in block the transaction controller may compare the received product scan data with the offer data as well as with the coupon data of the second storage device B as illustrated in . In block the transaction controller may alert the PCD of any matches with the offer data and coupon data . Specifically the transaction controller may generate a message that is formatted and received by the PCD and displayed as a selectable option as illustrated in screen F as illustrated in .

However according to one exemplary embodiment and similar to the selectable option for displaying product scan data described above a user or operator of PCD may select an option for turning off the display of offer data and coupon data matches. According to another exemplary embodiment or the same exemplary embodiment in which the display of offer data and coupon data matches is turned off the user or operator of PCD may elect for the transaction controller automatically apply matches between coupon data and products purchased as well as for matches between the offer data and products purchased. These options or preferences for handling and displaying data may part of a client profile which may be stored in the second storage device B. The redeemed coupons may also be sent back through the POS controller to the appropriate electronic redemption used by the merchant. Alternatively the redeemed coupons may be sent over the first computer communications network A to the appropriate electronic redemption used by the merchant as understood by one of ordinary skill in the art.

In block the transaction controller may receive one or more selection s of match es from the PCD in response to the operator of PCD selecting one or more options displayed in screen F of . In block the transaction controller sends any user selected match es over the first computer communication is network A and the communication link B to the terminal router emulator .

In block the POS controller receives the selected match es from the terminal router emulator and applies the matches against the products listed in the current bill of sale. The process then proceeds to step of .

Next in block the transaction controller may receive third party offer data produced by the third party offer generator via the POS controller or through a direct connection between the third party offer generator as illustrated in . illustrates to exemplary embodiments in which the third party offer generator may be coupled directly to the POS controller or the generator may be coupled directly to the transaction controller . As described previously the third party offer generator may comprise off the shelf units such as but not limited to units sold as of this writing by Catalina Marketing Inc. The offers produced by the generator may comprise coupons targeted for a particular operator of PCD based upon the products that are purchased and recorded by the product scanner and the electronic cash register .

In block the transaction controller may take the received third party offer data and store it in the offer data corresponding to a particular profile of the operator of the PCD as illustrated by the data structure in . Next in block the transaction controller and specifically the matching engine may match the total purchase data with the client preferences for payment stored in the user preference data as illustrated in the data structure of . The transaction controller may then relayed this client preference for payment methods to the PCD .

In block the total purchase data user payment method references and relevant balances from the payment method preferences may be displayed on the screen G as illustrated in and generally designated by reference numeral A. Next in block the transaction controller may receive one or more selection s for the payment methods over the first computer communications network A from the PCD based on selections made by the operator of PCD .

Next in block the transaction controller may process the selected payment methods by sending messages to one or more payment systems. In this block the transaction controller may send messages to the gateway if one or more alternative payment options such as but not limited to PAYPAL brand of online financial payment solutions and SPRINT brand of mobile telephone networks have been selected by the user of the PCD paying the final amount due for a purchase. The transaction controller may also send information related to traditional payment methods such as but not limited to conventional credit card accounts stored value accounts debit account and checking accounts from the secure vault or first storage device A over a secure communication link B via the first computer communication is network A to the terminal router emulator . In this scenario the terminal router emulator functions as a terminal for relaying traditional payment information to the POS controller which in turn takes this traditional payment data and forwards it to its router for processing by conventional payment networks forming the third computer communications network C.

Next in block the transaction controller may receive payment authorizations from any of the alternative payment solutions found in the second computer communication network B. Also in this block the POS controller may receive these authorizations via the router and the third computer communications network C. The process then continues to block of .

Next in block the electronic cash register A may generate a hard copy receipt . Similarly in block the transaction controller may generate an electronic receipt and send it over the computer communications network A to the PCD for display on the display device of the PCD as illustrated in screens H of and screen K of . The process then ends.

In this exemplary embodiment the traditional or conventional payment network that comprises the third computer communications network C is provided adjacent to the transaction controller so that the transaction controller may process conventional payments based on the data which is stored in the secure vault or first database A. In other words compared to the third computer communications network C of has been moved from being coupled to the POS controller to now being coupled to the transaction controller via an optional acquirer system as understood by one of ordinary skill the art. Therefore according to the exemplary embodiment of the system illustrated in the transactional controller may process any of the traditional payment methods which may include but are not limited to credit card accounts stored in the secure vault or first storage device A. Meanwhile as discussed above in connection with the transactional controller typically relays credit card information through the terminal router emulator to the POS controller which forwarded this information on to the router and the traditional payment network C. According to the exemplary embodiment illustrated in a merchant may not be required to pay traditional service fees or be a subscriber of traditional payment networks. Instead a merchant may interact exclusively with the transactional controller according to this exemplary embodiment for processing all forms of payments available to the operator of the PCD .

Certain steps in the processes or process flows described in this specification naturally precede others for the invention to function as described. However the invention is not limited to the order of the steps described if such order or sequence does not alter the functionality of the invention. That is it is recognized that some steps may performed before after or parallel substantially simultaneously with other steps without departing from the scope and spirit of the invention. In some instances certain steps may be omitted or not performed without departing from the invention. Further words such as thereafter then next etc. are not intended to limit the order of the steps. These words are simply used to guide the reader through the description of the exemplary method.

Additionally one of ordinary skill in programming is able to write computer code or identify appropriate hardware and or circuits to implement the disclosed invention without difficulty based on the flow charts and associated description in this specification for example.

Therefore disclosure of a particular set of program code instructions or detailed hardware devices is not considered necessary for an adequate understanding of how to make and use the invention. The inventive functionality of the claimed computer implemented processes is explained in more detail in the above description and in conjunction with the Figures which may illustrate various process flows.

In one or more exemplary aspects the functions described may be implemented in hardware software firmware or any combination thereof. If implemented in software the functions may be stored on or transmitted as one or more instructions or code on a computer readable medium. Computer readable media include both computer storage media and communication media including any medium that facilitates transfer of a computer program from one place to another. A storage media may be any available media that may be accessed by a computer. By way of example and not limitation such computer readable media may comprise RAM ROM EEPROM CD ROM or other optical disk storage magnetic disk storage or other magnetic storage devices or any other medium that may be used to carry or store desired program code in the form of instructions or data structures and that may be accessed by a computer.

Also any connection is properly termed a computer readable medium. For example if the software is transmitted from a website server or other remote source using a coaxial cable fiber optic cable twisted pair digital subscriber line DSL or wireless technologies such as infrared radio and microwave then the coaxial cable fiber optic cable twisted pair DSL or wireless technologies such as infrared radio and microwave are included in the definition of medium.

Disk and disc as used herein includes compact disc CD laser disc optical disc digital versatile disc DVD floppy disk and blu ray disc where disks usually reproduce data magnetically while discs reproduce data optically with lasers. Combinations of the above should also be included within the scope of computer readable media.

Alternative embodiments for the method and system for managing transactions with the PCD will become apparent to one of ordinary skill in the art to which the invention pertains without departing from its spirit and scope. For example the PCD may be used for making purchases in an on line transaction environment. In such environments the on line merchant may provide the merchant identifier and or terminal identifier on the merchant s website webpages which may be scanned in by the PCD or keyed in by the operator of the PCD . The contents of the merchant s on line shopping cart may then be displayed on the PCD similar to the brick and mortar POS transactions described above. The operator of the PCD may also select preferred payment methods also like the brick and mortar POS transactions described above.

Therefore although selected aspects have been illustrated and described in detail it will be understood that various substitutions and alterations may be made therein without departing from the spirit and scope of the present invention as defined by the following claims.

