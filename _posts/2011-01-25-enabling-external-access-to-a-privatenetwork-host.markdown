---

title: Enabling external access to a private-network host
abstract: Network address translation allows hosts within a private network (“internal hosts”) to access the Internet through a single or a limited number of public IP addresses. When an internal host accesses the Internet, NAT translates the internal host's private IP address into a temporary public IP address for a given session. A method and media are provided for enabling a host external to the private network (“external host”) to initiate communication with an internal host. The internal host requests that a global address be mapped to its private address. The internal host receives the global address and sends it to a server where it is available to an external host. The mapping between the private address and the global address is maintained in a NAT system so that an inbound connection request from an external host can be forwarded to the internal host.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08683019&OS=08683019&RS=08683019
owner: Sprint Communications Company L.P.
number: 08683019
owner_city: Overland Park
owner_country: US
publication_date: 20110125
---
A high level overview of various aspects of the invention is provided here for that reason to provide an overview of the disclosure and to introduce a selection of concepts that are further described below in the detailed description section. This summary is not intended to identify key features or essential features of the claimed subject matter nor is it intended to be used as an aid in isolation to determine the scope of the claimed subject matter.

In a first aspect a set of computer useable instructions provide a method of enabling a host external to a private network external host to initiate communication with a host internal to the private network internal host . The internal host has a private address within the private network. A request is received from the internal host for a public Internet Protocol IP address. A public IP address is assigned to the internal host and is mapped to the private IP address of the internal host. The public IP address is communicated to the internal host. The internal host sends the public IP address to a network element that makes the public IP address available to the external host. The external host receives the public IP address and initiates a connection with the internal host via the public IP address.

In a second aspect an internal host is provided with a public IP address that is accessible to an external host. An application programming interface API enables the internal host to request the public IP address. A request for the public IP address is received from the internal host. The public IP address is mapped to the private IP address of the internal host and is communicated to the internal host. The internal host makes the public IP address available to the external host. The public IP address is provided to a Network Address Translation NAT system which forwards a communication received at the public IP address to the private IP address of the internal host.

In a third aspect a set of computer useable instructions provide a method of providing a global address that is available to an external host for an internal host that has a private address the private address is not accessible to the external host . The internal host sends a request for the global address to be mapped to the private address. The internal host receives the global address that is mapped to the private address. The internal host sends the global address to a server. The global address is available to the external host by way of the server.

The subject matter of some embodiments of the present invention is described with specificity herein to meet statutory requirements. But the description itself is not intended to necessarily limit the scope of the claims. Rather the claimed subject matter might be embodied in other ways to include different steps or combinations of steps similar to the ones described in this document in conjunction with other present or future technologies. Terms should not be interpreted as implying any particular order among or between various steps herein disclosed unless and except when the order of individual steps is explicitly described.

Throughout this disclosure several acronyms and shorthand notations are used to aid the understanding of certain concepts pertaining to the associated system and services. These acronyms and shorthand notations are intended to help provide an easy methodology of communicating the ideas expressed herein and are not meant to limit the scope of the present invention. The following is a list of these acronyms 

Further various technical terms are used throughout this description. An illustrative resource that fleshes out various aspects of these terms can be found in Newton s Telecom Dictionary 25th Edition 2009 .

Embodiments of the present invention can take the form of a method system or computer readable media embodied with a specific set of computer executable instructions. Computer readable media includes both volatile and nonvolatile media removable and nonremovable media and contemplates media readable by a database a switch and various other network and computing devices. Computer readable media includes media implemented in any method or technology that stores information. Examples of stored information include computer useable instructions data structures program modules and other data representations. Examples of computer readable media include RAM ROM EEPROM flash memory or other memory technology CD ROM digital versatile discs DVD holographic media or other optical disc storage magnetic cassettes magnetic tape magnetic disk storage and other magnetic storage devices. The computer readable media can store data momentarily temporarily or permanently.

Most broadband connections use IPv4 to connect to the Internet. There is an inherent limitation in IPv4 in that addressing is limited to approximately four billion addresses and most of those are in use. Network Address Translation NAT provides a way to reduce the number of Internet Protocol IP addresses needed to provide Internet connectivity to all of the computers or devices that require it especially where such computers are part of a private network.

NAT allows hosts within a private network internal hosts each having its own private IP address within that network to access the Internet through a single public IP address or a limited number of public IP addresses. When an internal host accesses the Internet NAT translates the internal host s private IP address into a temporary public IP address for a given session.

NAT is performed by a device that is connected to the Internet and hides the internal hosts from hosts that are external to the private network external hosts thus making the entire private network appear as one device or computer or a small number of devices in the case where NAT maintains a pool of public IP addresses to the rest of the world. All communications between internal hosts and external hosts are handled by the NAT device which provides the appropriate address translations.

All requests generated by the internal hosts that are within the private network are sent to the Internet via the NAT device. A packet received by the NAT device from an internal host is associated with both a source address and a source port. As each packet from an internal host is received by the NAT device the NAT device performs address and port translation on the packet. The NAT device strips the private source address and port from the network layer e.g. 192.168.0.10 101 where 192.168.0.10 is the address and 101 is the port and replaces them with a public IP address and port e.g. 203.31.220.134 301 before sending the packet to the Internet. Thus the packet then seems to have originated from the public IP address and port.

The public IP address may be the public IP address of the NAT device itself. In an embodiment a packet received by the NAT device from a different internal host may be assigned the same public IP address but a different port. Thus the port assignment made by the NAT device distinguishes between packets that originate from different internal hosts.

In the event that the NAT device maintains a pool of public IP addresses NAT is performed in the same manner. In that case packets from different internal hosts are not necessarily translated to the same public IP address.

NAT is used in many kinds of networks for example local area networks typically use NAT. A number of wireless service providers use private address spaces for hosts within their networks and employ NAT.

An internal host may initiate a connection with another internal host within the same private network by sending communications to the other internal host s private IP address. The other internal host responds by sending communications to the first internal host s private IP address.

However when an internal host wants to initiate a connection with an external host it has historically done so by way of the NAT device as described above. An outgoing connection request from the internal host to an external host passes through the NAT device which performs address and port translation as described above temporarily mapping a public IP address to the private IP address of the internal host. The NAT device then sends the connection request to the destination external host. When the external host receives the connection request it responds to what it believes is the origination address of the request but in reality it responds to the public IP address and port provided by the NAT device. The external host s response is received by the NAT device which translates the destination address of the response to the private IP address associated with the internal host based on the destination port of the packet.

The NAT device maintains a translation table containing the mapping between the internal host s private address and the public address. The mapping however is temporary and persists only for a given session. At a later time should the external host try to initiate a connection with the internal host by using the public IP address it will fail because that particular mapping will no longer exist.

An exception to the temporary nature of the mapping occurs with static NAT. In static NAT the mapping between an internal host s private IP address and public IP address is permanent. Because static NAT requires exclusive use of that IP address by the internal host the advantage of sharing a single IP address among multiple hosts is lost. Static NAT may be used for example when an internal host is a web server and it is desirable for external hosts to initiate connections with the internal host at any time.

Environment includes the Internet and a private network . Private network may be a LAN a service provider s network such as a wireless service provider network or any type of network that utilizes private IP addresses for its internal hosts.

Private network interfaces with Internet via a NAT device . NAT device is not limited to one particular type of device. For example it could be a router a server or other network element or network enabled device as long as the device is able to perform NAT functions.

Within Internet is a host . Host may be a personal computer a PDA a mobile phone a game device a server or other device that is capable of communicating over an IP network such as Internet . Although not illustrated in in an embodiment host resides in another private network instead of Internet . From the perspective of NAT device it makes no difference whether external host is connected to Internet or another private network. The NAT function performed by NAT device is the same either way. If external host is connected to another private network it would be internal to that network but would still be external to private network .

Also within Internet is a network element . Network element may be a server a host or other type of device that is accessible by external host and other hosts that are external to private network . In an embodiment network element is a domain name system DNS server.

Within private network are internal hosts and . Internal hosts and have private IP addresses and respectively as depicted in . Internal hosts and may be personal computers PDAs mobile phones game devices and other devices that are capable of communicating over an IP network such as private network .

Turning now to a block diagram depicts an illustrative internal host in accordance with an embodiment of the present invention and is referred to generally as internal host . Internal host is but one example of a suitable internal host. Although some components are shown in the singular they may be plural. For example internal host might include multiple processors or I O ports etc. As illustratively shown internal host includes a bus that directly or indirectly couples various components together including memory a processor a presentation component radio input output ports input output components and a power supply .

Memory might take the form of one or more of the aforementioned media. Thus we will not elaborate more here only to say that memory component can include any type of medium that is capable of storing information in a manner readable by a computing device.

An application is stored in memory in one embodiment and may actually be multiple applications. Application enables internal host to perform a number of functions. Illustrative functions include enabling internal host to access a service over a network receive user input via I O components and provide information to a user via a presentation component . Examples of application include a game and a web server. Application utilizes an application programming interface API to interact with an address mapping function in one embodiment.

Processor might actually be multiple processors that receive instructions and process them accordingly. Presentation component may include the likes of a display a speaker as well as other components that can present information such as a lamp LED or even lighted keyboards .

One embodiment of internal host includes a radio . Radio represents a radio that facilitates communication with a wireless telecommunications network. Illustrative wireless telecommunications technologies include CDMA GPRS TDMA GSM and the like. In some embodiments radio facilitates other types of wireless communications including Wi Fi communications and GIS communications. Examples of internal host that include radio are mobile phones wireless enabled laptop computers PDAs and other devices that utilize wireless network access.

Input output port might take on a variety of forms. Illustrative input output ports include a USB jack stereo jack infrared port proprietary communications ports and the like. Input output components include items such as keyboards microphones touch screens and any other item usable to directly or indirectly input data into internal host . Power supply includes items such as batteries fuel cells or any other component that can act as a power source to power internal host .

Referring now to a block diagram depicts an illustrative operating environment for use in accordance with an embodiment of the present invention and is generally referred to as operating environment . Operating environment is but one example of a suitable operating environment.

Operating environment includes a network element a network element and an internal host of . Network element performs an address mapping function by mapping a public IP address to an internal host s private IP address in response to a request from internal host for a public IP address as described below private IP address corresponds to private IP address depicted in .

Internal host includes application and API . In an embodiment application developers are provided with API which facilitates communication with address mapping function . In an embodiment API provides function calls for requesting a public IP address from mapping function receiving the public IP address and publishing the public IP address. For example a user may download a game onto a host at a private IP address and then host the game. The user may want another user at an external host to connect to the game. The game developer uses function calls from API enabling the game application to request a public IP address and publish it for example by registering the public IP address with a DNS server such that the public IP address becomes available to the external host.

Network element performs an address translation function and maintains the mapping between the public and private IP addresses for a given duration based on a timer . In one embodiment address translation function is a Network Address Translation NAT function which is a process of modifying network address information in IP packet headers as they pass through a network element to remap one IP address space into another. In an embodiment address translation function is implemented in a Linux environment using iptables which is a Linux tool for controlling packet traffic.

In some embodiments address mapping function and address translation function are performed by a combination of network elements. In other embodiments address mapping function and address translation function are performed by the same network element. Illustrative devices that may embody any or all of those functionalities include servers gateways and routers.

Referring now to a flow diagram depicts an illustrative method in accordance with an embodiment of the present invention and is generally referred to as method . Method is but one example of a suitable method.

At a step internal host sends a request for a public IP address to router . In an embodiment request for the public IP address is generated by application residing on host . With the advent of application stores and proliferation of application development it is desirable to provide hosts and application developers a way to receive inbound connections at an internal host from Internet hosts or other external hosts . In an embodiment application uses one or more API function calls to request and receive the public IP address.

At a step address mapping function assigns or maps public IP address to the private address of internal host . Although in one embodiment the functionality of address mapping function resides within router in other embodiments as described above address mapping function resides in a separate device or devices for example a server or other network element. In some embodiments router is a server or other network element.

At a step address mapping function communicates the resultant mapping to address translation function in router . Address translation function maintains mapping in an address translation table for a duration of time that is monitored by a timer associated with mapping . The duration is not necessarily tied to the duration of a particular session. The duration may be anywhere from a few seconds or even less to an indefinite amount of time depending on the particular application or need. In one embodiment the user pays for a subscription that permits an ongoing mapping which would be appropriate for hosting a web server. If the application is a game then an hour might be adequate. In some embodiments either address mapping function or address translation function decides the duration of mapping . Generally mapping persists for the duration of time such that one or more external hosts may initiate a connection with the internal host by way of public IP address . In an embodiment address mapping function communicates the duration of mapping to internal host . Thus when mapping times out internal host may opt to request another public IP address which may or may not be the same as public IP address .

At a step address mapping function sends public IP address to internal host . At a step internal host publishes public IP address by communicating public IP address to network element . In an embodiment internal host uses one or more API function calls to publish public IP address . Network element stores public IP address such that it is available to external host .

In one embodiment network element is a DNS server and step includes internal host registering public IP address with the DNS server. In another embodiment network element is a rendezvous server connected to the Internet. A rendezvous server provides a stable IP address for internal host and associates that stable IP address with an IP address of host which in this case would be public IP address . So the rendezvous server would forward packets received at the stable IP address to public IP address . In the event that the mapping between private IP address and public address times out as described above host can request another public IP address and then update network element with the new public IP address.

When external host desires to initiate a connection with internal host external host accesses network element at a step to retrieve public IP address . In one embodiment if network element is a DNS server then external host sends a request for the IP address associated with internal host s domain name. Network element whether a DNS server or other device need not be directly accessed by external host . In an embodiment external host accesses a different DNS server which in turn communicates with DNS server to obtain the IP address associated with the domain name. In that case DNS server is indirectly accessed by external host .

At a step external host receives public IP address from network element either directly or indirectly . External host is thus enabled to establish a connection with internal host at a step by sending a connection request to public IP address which is received by router . At a step address translation function translates public IP address to private IP address and at a step router sends connection request to internal host at private address . Thus external host is enabled to initiate a connection with internal host by way of public IP address that is published by internal host .

Many different arrangements of the various components depicted as well as components not shown are possible without departing from the scope of the claims below. Embodiments of our technology have been described with the intent to be illustrative rather than restrictive. Alternative embodiments will become apparent to readers of this disclosure after and because of reading it. Alternative means of implementing the aforementioned can be completed without departing from the scope of the claims below. Certain features and subcombinations are of utility and may be employed without reference to other features and subcombinations and are contemplated within the scope of the claims.

